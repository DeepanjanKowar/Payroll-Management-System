var $r={};$r.__data={api_v0_premium_stripe_webhooks:["api",["v0","premium_stripe_webhooks"]],api_v0_stripe_webhooks:["api",["v0","stripe_webhooks"]],api_v0:["api",["v0","analytics","targeted",":action"]],api_v0_scribd_events:["api",["v0","scribd_events"]],record_invalid_extension_api_v0_attachments:["api",["v0","attachments","record_invalid_extension"]],parsed_attributes_api_v0_attachment:["api",["v0","attachments",":id","parsed_attributes"]],publishing_survey_api_v0_attachment:["api",["v0","attachments",":id","publishing_survey"]],api_v0_attachments:["api",["v0","attachments"]],api_v0_attachment:["api",["v0","attachments",":id"]],api_v0_work_authorship:["api",["v0","works",":work_id","authorship"]],api_v0_work_attachments:["api",["v0","works",":work_id","attachments"]],new_api_v0_work_attachment:["api",["v0","works",":work_id","attachments","new"]],edit_api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id","edit"]],api_v0_work_attachment:["api",["v0","works",":work_id","attachments",":id"]],api_v0_work_urls:["api",["v0","works",":work_id","urls"]],api_v0_work_url:["api",["v0","works",":work_id","urls",":id"]],api_v0_works_views:["api",["v0","works","views"]],api_v0_works_percentiles:["api",["v0","works","percentiles"]],api_v0_works_certification_counts:["api",["v0","works","certification_counts"]],api_v0_works_bookmark_counts:["api",["v0","works","bookmark_counts"]],read_events_api_v0_bookmarkers:["api",["v0","works","bookmarkers","read_events"]],set_order_api_v0_works:["api",["v0","works","set_order"]],api_v0_work_requests:["api",["v0","works",":work_id","requests"]],set_order_api_v0_work_co_author_tags:["api",["v0","works",":work_id","co_author_tags","set_order"]],api_v0_work_co_author_tags:["api",["v0","works",":work_id","co_author_tags"]],api_v0_work_co_author_tag:["api",["v0","works",":work_id","co_author_tags",":id"]],api_v0_work_research_interest_reject_suggestion:["api",["v0","works",":work_id","research_interests",":research_interest_id","reject_suggestion"]],api_v0_work_classification:["api",["v0","works",":work_id","classification"]],other_works_by_author_api_v0_work_related_works:["api",["v0","works",":work_id","related_works","other_works_by_author"]],related_works_api_v0_work_related_works:["api",["v0","works",":work_id","related_works","related_works"]],api_v0_work_related_works:["api",["v0","works",":work_id","related_works"]],validate_url_api_v0_works:["api",["v0","works","validate_url"]],should_display_captcha_api_v0_works:["api",["v0","works","should_display_captcha"]],verify_captcha_response_api_v0_works:["api",["v0","works","verify_captcha_response"]],html_api_v0_work:["api",["v0","works",":id","html"]],academia_select_answer_api_v0_work:["api",["v0","works",":id","academia_select_answer"]],academia_select_charge_api_v0_work:["api",["v0","works",":id","academia_select_charge"]],api_v0_works:["api",["v0","works"]],new_api_v0_work:["api",["v0","works","new"]],edit_api_v0_work:["api",["v0","works",":id","edit"]],api_v0_work:["api",["v0","works",":id"]],validate_api_v0_sections:["api",["v0","sections","validate"]],set_order_api_v0_sections:["api",["v0","sections","set_order"]],api_v0_section:["api",["v0","sections",":id"]],count_api_v0_interest_followers:["api",["v0","interests",":interest_id","followers","count"]],api_v0_interest_followers:["api",["v0","interests",":interest_id","followers"]],count_api_v0_interest_works:["api",["v0","interests",":interest_id","works","count"]],api_v0_interest_works:["api",["v0","interests",":interest_id","works"]],api_v0_user_details:["api",["v0","users",":user_id","details"]],api_v0_user_followers:["api",["v0","users",":user_id","followers"]],api_v0_user_following_index:["api",["v0","users",":user_id","following"]],set_api_v0_user_preferences:["api",["v0","users",":user_id","preferences","set"]],api_v0_user_preferences:["api",["v0","users",":user_id","preferences"]],record_show_api_v0_user_nags:["api",["v0","users",":user_id","nags","record_show"]],api_v0_user_nag:["api",["v0","users",":user_id","nags",":id"]],api_v0_user_coauthors:["api",["v0","users",":user_id","coauthors"]],api_v0_user_blocks:["api",["v0","users",":user_id","blocks"]],api_v0_user_requests:["api",["v0","users",":user_id","requests"]],api_v0_user_social_profiles:["api",["v0","users",":user_id","social_profiles"]],new_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles","new"]],edit_api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id","edit"]],api_v0_user_social_profile:["api",["v0","users",":user_id","social_profiles",":id"]],hits_api_v0_user_stats:["api",["v0","users",":user_id","stats","hits"]],downloads_api_v0_user_stats:["api",["v0","users",":user_id","stats","downloads"]],read_events_api_v0_user_stats:["api",["v0","users",":user_id","stats","read_events"]],unread_read_event_count_api_v0_user_stats:["api",["v0","users",":user_id","stats","unread_read_event_count"]],works_api_v0_user_stats:["api",["v0","users",":user_id","stats","works"]],thirty_day_percentiles_api_v0_user_stats:["api",["v0","users",":user_id","stats","thirty_day_percentiles"]],all_time_hits_by_country_api_v0_user_stats:["api",["v0","users",":user_id","stats","all_time_hits_by_country"]],twelve_month_impact_api_v0_user_stats:["api",["v0","users",":user_id","stats","twelve_month_impact"]],all_time_referer_hit_counts_api_v0_user_stats:["api",["v0","users",":user_id","stats","all_time_referer_hit_counts"]],reader_research_interests_api_v0_user_stats:["api",["v0","users",":user_id","stats","reader_research_interests"]],university_hit_counts_api_v0_user_stats:["api",["v0","users",":user_id","stats","university_hit_counts"]],yearly_impact_report_freebie_api_v0_user_stats:["api",["v0","users",":user_id","stats","yearly_impact_report_freebie"]],percentile_data_api_v0_user_stats:["api",["v0","users",":user_id","stats","percentile_data"]],api_v0_user_stats:["api",["v0","users",":user_id","stats"]],count_api_v0_user_works:["api",["v0","users",":user_id","works","count"]],api_v0_user_works:["api",["v0","users",":user_id","works"]],sample_name_mention_api_v0_mentions:["api",["v0","mentions","sample_name_mention"]],mark_all_as_read_api_v0_mentions:["api",["v0","mentions","mark_all_as_read"]],api_v0_mentions:["api",["v0","mentions"]],fetch_freebie_for_type_api_v0_read_event_freebies:["api",["v0","read_event_freebies","fetch_freebie_for_type"]],api_v0_user:["api",["v0","user"]],api_v0_discussion_invitees_with_brain_trust:["api",["v0","discussion_invitees_with_brain_trust"]],api_v0_is_discussion_promotion_qualified:["api",["v0","is_discussion_promotion_qualified"]],api_v0_facebook_contacts_fresh:["api",["v0","facebook_contacts_fresh"]],api_v0_twitter_contacts_fresh:["api",["v0","twitter_contacts_fresh"]],api_v0_imported_google_contacts:["api",["v0","imported_google_contacts"]],api_v0_post_download_data:["api",["v0","post_download_data"]],invite_users_api_v0_discussion:["api",["v0","discussions",":id","invite_users"]],nag_for_first_comment_api_v0_discussion:["api",["v0","discussions",":id","nag_for_first_comment"]],pending_participants_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","pending_participants"]],leave_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","leave"]],approve_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","approve"]],reject_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","reject"]],block_api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations","block"]],api_v0_discussion_audience_invitations:["api",["v0","discussions",":discussion_id","audience_invitations"]],like_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","like"]],unlike_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","unlike"]],delete_for_user_api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id","delete_for_user"]],has_newer_comments_api_v0_discussion_discussion_comments:["api",["v0","discussions",":discussion_id","discussion_comments","has_newer_comments"]],api_v0_discussion_discussion_comments:["api",["v0","discussions",":discussion_id","discussion_comments"]],api_v0_discussion_discussion_comment:["api",["v0","discussions",":discussion_id","discussion_comments",":id"]],api_v0_discussions:["api",["v0","discussions"]],api_v0_discussion:["api",["v0","discussions",":id"]],api_v0_certifications_certifications:["api",["v0","certifications","certifications"]],api_v0_certifications_certification:["api",["v0","certifications","certifications",":id"]],api_v0_certifications_work_certifications:["api",["v0","certifications","work_certifications"]],api_v0_certifications_certifier_nominations:["api",["v0","certifications","certifier_nominations"]],api_v0_certifications_ranks_author_rank:["api",["v0","certifications","ranks","author_ranks",":id"]],api_v0_certifications_ranks_paper_ranks:["api",["v0","certifications","ranks","paper_ranks"]],api_v0_certifications_ranks_paper_rank:["api",["v0","certifications","ranks","paper_ranks",":id"]],api_v0_premium_premium_status_index:["api",["v0","premium","premium_status"]],api_v0_premium_premium_status:["api",["v0","premium","premium_status",":id"]],make_premium_api_v0_premium_admin_actions:["api",["v0","premium","admin_actions","make_premium"]],unsub_premium_api_v0_premium_admin_actions:["api",["v0","premium","admin_actions","unsub_premium"]],allow_premium_api_v0_premium_admin_actions:["api",["v0","premium","admin_actions","allow_premium"]],disallow_premium_api_v0_premium_admin_actions:["api",["v0","premium","admin_actions","disallow_premium"]],api_v0_premium_subscriptions:["api",["v0","premium","subscriptions"]],unread_count_api_v0_notifications:["api",["v0","notifications","unread_count"]],mark_read_api_v0_notifications:["api",["v0","notifications","mark_read"]],mark_analytics_read_api_v0_notifications:["api",["v0","notifications","mark_analytics_read"]],api_v0_notifications:["api",["v0","notifications"]],api_v0_profiles_works:["api",["v0","profiles","works"]],api_v0_profiles_user_relation_index:["api",["v0","profiles","user_relation"]],api_v0_profiles_user_relation_stats:["api",["v0","profiles","user_relation_stats"]],api_v0_profiles_get_name:["api",["v0","profiles","get_name"]],api_v0_profiles_update_name:["api",["v0","profiles","update_name"]],api_v0_profiles_get_affiliations:["api",["v0","profiles","get_affiliations"]],api_v0_profiles_get_sections:["api",["v0","profiles","get_sections"]],api_v0_profiles_get_biography:["api",["v0","profiles","get_biography"]],api_v0_profiles_update_about:["api",["v0","profiles","update_about"]],api_v0_profiles_update_supervisors:["api",["v0","profiles","update_supervisors"]],api_v0_profiles_upload_bibtex:["api",["v0","profiles","upload_bibtex"]],add_api_v0_taggings:["api",["v0","taggings","add"]],remove_api_v0_taggings:["api",["v0","taggings","remove"]],set_order_api_v0_taggings:["api",["v0","taggings","set_order"]],api_v0_taggings:["api",["v0","taggings"]],api_v0_suggestions_following_index:["api",["v0","suggestions","following"]],api_v0_suggestions_following:["api",["v0","suggestions","following",":id"]],api_v0_suggestions_interests:["api",["v0","suggestions","interests"]],api_v0_suggestions_interest:["api",["v0","suggestions","interests",":id"]],api_v0_suggestions_certifications:["api",["v0","suggestions","certifications"]],api_v0_suggestions_certification:["api",["v0","suggestions","certifications",":id"]],api_v0_suggestions_histories:["api",["v0","suggestions","histories"]],by_works_api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors","by_works"]],batch_create_api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors","batch_create"]],api_v0_suggestions_coauthors:["api",["v0","suggestions","coauthors"]],api_v0_suggestions_coauthor:["api",["v0","suggestions","coauthors",":id"]],api_v0_suggestions_discussions:["api",["v0","suggestions","discussions"]],clusters_api_v0_suggestions_works:["api",["v0","suggestions","works","clusters"]],by_coauthor_api_v0_suggestions_works:["api",["v0","suggestions","works","by_coauthor"]],trending_api_v0_suggestions_works:["api",["v0","suggestions","works","trending"]],api_v0_suggestions_works:["api",["v0","suggestions","works"]],randomized_last_api_v0_suggestions_jobs:["api",["v0","suggestions","jobs","randomized_last"]],api_v0_suggestions_jobs:["api",["v0","suggestions","jobs"]],api_v0_suggestions_affiliation:["api",["v0","suggestions","affiliation"]],api_v0_paper_claims:["api",["v0","paper_claims"]],api_v0_registration_followees:["api",["v0","registration","followees"]],api_v0_registration_interests:["api",["v0","registration","interests"]],api_v0_registration_colleagues:["api",["v0","registration","colleagues"]],api_v0_search_advanced:["api",["v0","search","advanced"]],recipient_api_v0_messages:["api",["v0","messages","recipient"]],api_v0_messages:["api",["v0","messages"]],api_v0_active_support_notifications:["api",["v0","server_notifications"]],api_v0_feature_flags:["api",["v0","feature_flags"]],find_api_v0_bookmarks:["api",["v0","bookmarks","find"]],api_v0_bookmarks:["api",["v0","bookmarks"]],api_v0_bookmark:["api",["v0","bookmarks",":id"]],api_v0_news_index:["api",["v0","news"]],api_v0_social_distance:["api",["v0","social_distance"]],record_view_api_v0_sales:["api",["v0","sales","record_view"]],record_click_api_v0_sales:["api",["v0","sales","record_click"]],api_v0_sales:["api",["v0","sales"]],api_v0_set_password:["api",["v0","set_password"]],api_v0_reader_message_like_message:["api",["v0","reader_messages",":reader_message_id","like_message"]],api_v0_reader_messages:["api",["v0","reader_messages"]],api_v0_canned_reader_messages:["api",["v0","canned_reader_messages"]],api_v0_user_occupations:["api",["v0","user_occupations"]],api_v0_mark_read_events_as_read:["api",["v0","mark_read_events_as_read"]],v0_update_affiliation:["www",["profiles","v0","update_affiliation"]],v0_delete_affiliation:["www",["profiles","v0","delete_affiliation"]],record_split:["www",["record_split"]],finish_split:["www",["finish_split"]],notifications:["www",["Notifications"]],Papers_Upload:["www",["Papers","Upload"]],unflag_user_reports:["www",["reports","unflag_user"]],auto_classify_user_reports:["www",["reports","auto_classify_user"]],extra_data_reports:["www",["reports","extra_data"]],reports:["www",["reports"]],partial_create_registrations:["www",["registrations","partial_create"]],registrations:["www",["registrations"]],registration_path_coauthor_single_page:["www",["AcceptCoauthorTag"]],registration_path_oauth_authorize:["www",["Email"]],registration_path_oauth_callback:["www",["OAuthCallback"]],friend_finder_google:["www",["FriendFinder","Google"]],friend_finder_google_contacts:["www",["FriendFinder","GoogleContacts"]],friend_finder_google_connect:["www",["FriendFinder","GoogleConnect"]],friend_finder_google_select_whom_to_follow:["www",["FriendFinder","Google","Follow"]],friend_finder_google_select_whom_to_follow_post:["www",["FriendFinder","Google","Follow"]],friend_finder_facebook:["www",["FriendFinder","Facebook"]],friend_finder_facebook_contacts:["www",["FriendFinder","FacebookContacts"]],friend_finder_twitter:["www",["FriendFinder","Twitter"]],friend_finder_twitter_contacts:["www",["FriendFinder","TwitterContacts"]],friend_finder_twitter_connect_successful:["www",["FriendFinder","TwitterConnectSuccess"]],friend_finder_connect:["www",["FriendFinder","Connect"]],friend_finder_yahoo:["www",["FriendFinder","Yahoo"]],friend_finder_Yahoo:["www",["FriendFinder","Yahoo"]],friend_finder_oauth_callback:["www",["FriendFinder","OAuthCallback"]],friend_finder_yahoo_select_whom_to_follow:["www",["FriendFinder","Yahoo","Follow"]],friend_finder_Yahoo_Follow:["www",["FriendFinder","Yahoo","Follow"]],friend_finder_index:["www",["FriendFinder"]],upgrade:["www",["upgrade"]],jobs:["www",["Jobs"]],new_job:["www",["Jobs","new"]],mark_as_spam_thread:["www",["Messages",":id","spam"]],mark_as_read_thread:["www",["Messages",":id","mark_as_read"]],threads:["www",["Messages"]],thread:["www",["Messages",":id"]],new_session:["www",["sessions","new"]],login:["www",["login"]],readers:["www",["readers"]],attachment_csv_preview:["www",["attachments",":attachment_id","csv_preview"]],show_work:["www",[":id"]],edit_certifications_permissions:["www",["recommendations","eligibility"]],certifications_permissions:["www",["recommendations","permissions"]],certifications_manual_curation:["www",["recommendations","manual_curation"]],certifications_suggestions:["www",["recommendations","suggestions"]],certifications:["www",["recommendations","suggestions",":id"]],certifications_nominations:["www",["recommendations","nominations"]],analytics_csv:["www",[":page_name","Analytics","csv"]],generate_new_csv:["www",[":page_name","Analytics","csv"]],download_csv:["www",[":page_name","Analytics","csv","download",":analytics_csv_export_id"]],last_n_day_analytics:["www",[":page_name","Analytics","LastDays"]],analytics_dashboard:["www",[":page_name","Analytics"]],sidebar_new_profile_activity:["www",[":page_name","Activity","sidebar"]],new_profile_activity:["www",[":page_name","Activity"]],email_new_profile_contact_details:["www",[":page_name","contact_details","email"]],new_profile_curriculum_vitae:["www",[":page_name","CurriculumVitae"]],new_profile_profile_picture:["www",[":page_name","ProfilePicture"]],new_profile_supervisors:["www",[":page_name","supervisors"]],bio_new_profile_about_box:["www",[":page_name","about_box","bio"]],supervisors_new_profile_about_box:["www",[":page_name","about_box","supervisors"]],new_profile_post_edit:["www",[":page_name","Posts",":post_id","edit"]],show_new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_posts:["www",[":page_name","Posts"]],new_new_profile_post:["www",[":page_name","Posts","new"]],new_profile_post:["www",[":page_name","Posts",":id"]],new_profile_followers:["www",[":page_name","Followers"]],new_profile_following:["www",[":page_name","Following"]],new_profile_coauthors:["www",[":page_name","Coauthors"]],update_affiliation_new_profile:["www",[":page_name","update_affiliation"]],delete_affiliation_new_profile:["www",[":page_name","delete_affiliation"]],np_blog_post_post_redirect_new_profile:["www",[":page_name","Blog",":id",":slug"]],np_blog_post_no_slug_post_redirect_new_profile:["www",[":page_name","Blog",":id"]],status_updates_slug_post_redirect_new_profile:["www",[":page_name","StatusUpdates",":id",":slug"]],books_works_redirect_new_profile:["www",[":page_name","Books",":id"]],papers_works_redirect_new_profile:["www",[":page_name","Papers",":id"]],talks_works_redirect_new_profile:["www",[":page_name","Talks",":id"]],teachings_works_redirect_new_profile:["www",[":page_name","Teaching",":id"]],new_profile_works:["www",[":page_name",":section_name"]],new_profile:["www",[":page_name"]]},$r.__absolute=function(e,t){var n,t=t||{},i=this.__data[e][0],r=t.subdomain||i;return delete t.subdomain,n=this.__relative(e,t),t.host?"//"+t.host+n:"//"+r+"."+$app_host+n},$r.__relative=function(e,t){var n,i=this.__data[e][1],t=t||{},r=[],o=[],a="/";return $.each(i,function(n,i){var o;if(0==i.indexOf(":")){if(o=i.slice(1),!t[o])throw new Error("Failed to provide component "+i+" for "+e+"!");r.push(t[o]),delete t[o]}else r.push(i)}),r.length>0&&(a+=r.join("/")),t.format&&(a=a+"."+t.format,delete t.format),t.anchor&&(n=t.anchor,delete t.anchor),$.each(t,function(e,t){o.push(e+"="+t)}),o.length>0&&(a=a+"?"+o.join("&")),n&&(a=a+"#"+n),a},$.each($r.__data,function(e){$r[e+"_url"]=function(t){return $r.__absolute(e,t)},$r[e+"_path"]=function(t){return $r.__relative(e,t)}}),function(){var e,t,n,i;window.$h||(window.$h={}),window.$h.commaizeInt=function(e){var t;return null==e?e:(t=e.toString().split("."),t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join("."))},window.$h.numberAndNoun=function(e,t){return $h.commaizeInt(e)+" "+$h.pluralize(e,t)},window.$h.aOrNumberAndNoun=function(e,t){var n;return n=$h.pluralize(e,t),1===e?$h.aOrAn(t)+" "+n:$h.commaizeInt(e)+" "+n},t=[[/(s)yllabi$/i,"$1yllabi"],[/(s)yllabus$/i,"$1yllabi"],[/(z)ombies$/i,"$1ombies"],[/(z)ombie$/i,"$1ombies"],[/(m)oves$/i,"$1oves"],[/(m)ove$/i,"$1oves"],[/(s)exes$/i,"$1exes"],[/(s)ex$/i,"$1exes"],[/(c)hildren$/i,"$1hildren"],[/(c)hild$/i,"$1hildren"],[/(m)en$/i,"$1en"],[/(m)an$/i,"$1en"],[/(p)eople$/i,"$1eople"],[/(p)erson$/i,"$1eople"],[/(quiz)$/i,"$1zes"],[/^(oxen)$/i,"$1"],[/^(ox)$/i,"$1en"],[/^(m|l)ice$/i,"$1ice"],[/^(m|l)ouse$/i,"$1ice"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1\\2ves"],[/sis$/i,"ses"],[/([ti])a$/i,"$1a"],[/([ti])um$/i,"$1a"],[/(buffal|tomat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status)$/i,"$1es"],[/(octop|vir)i$/i,"$1i"],[/(octop|vir)us$/i,"$1i"],[/^(ax|test)is$/i,"$1es"],[/s$/i,"s"],[/$/,"s"]],window.$h.pluralize=function(e,n){var i,r;return i=function(e){var n,i,r,o,a,s;for(n=i=0,r=t.length;r>=0?r>=i:i>=r;n=r>=0?++i:--i)if(o=t[n],a=o[0],s=o[1],e.match(a))return e.replace(a,s);return e},r=_.isString(n)?{singular:n,plural:i(n)}:n,1===e?r.singular:r.plural},window.$h.aOrAn=function(e){return e&&"aeiouAEIOU".indexOf(e[0])>=0?"an":"a"},window.$h.format_text=function(e){return e=e.replace(/\r\n?/,"\n"),e=$.trim(e),0===e.length?e:e.replace(/\n\n+/g,"</p><p>").replace(/\n/,"<br />")},window.$h.humanFileSize=function(e,t){var n,i,r;for(null==t&&(t=0),n=1024,r=["B","KB","MB","GB"],i=0;e>=n;)e/=n,i++;return e.toFixed(t)+" "+r[i]},window.$h.isBlank=function(e){return!e||0===$.trim(e).length},n=/^[a-z0-9$!#%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9$!#%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,i=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i,window.$h.validEmail=function(e,t){var r;return null==t&&(t={}),r=t.strict?i:n,!(!e||!r.test(e))},window.$h.toStrongListOfItems=function(e){var t;return t=_.map(e,function(e){return"<strong>"+String(e)+"</strong>"}),t.length>=2&&(t[t.length-1]="and "+t[t.length-1]),t.join(t.length>=3?", ":" ")},window.$h.linkify=function(e,t){var n;return null==t&&(t={}),"_blank"===t.target?(n=function(e,t){return t?'<a href="'+t+'" title="'+t+'" target="_blank">'+e+"</a>":e},window.linkify(e,{callback:n})):window.linkify(e)},window.$h.timeAgoInWords=function(e,t){return null==t&&(t={}),window.$h.distanceOfTimeInWords(new Date,e,t)},window.$h.distanceOfTimeInWords=function(e,t,n){var i,r,o,a,s,l,u,c,d,p,h,f,m,g;return null==n&&(n={}),u=60,l=24*u,c=30*l,d=365*l,h=n.shortened,a=e.getTime(),f=t.getTime(),o=Math.round(Math.abs(a-f)/1e3),r=Math.round(o/60),30>o?h?"< 1 min":"less than a minute":60>o?h?"1 min":"1 minute":45>r?(m=h?"min":"minute",$h.numberAndNoun(r,m)):l>r?(s=Math.round(r/u),m=h?"hr":"hour",$h.numberAndNoun(s,m)):c>r?(i=Math.round(r/l),$h.numberAndNoun(i,"day")):d>r?(p=Math.round(r/c),m=h?"mo":"month",$h.numberAndNoun(p,m)):(g=Math.round(r/d),m=h?"yr":"year",$h.numberAndNoun(g,m))},window.$h.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},window.$h.titleize=function(e){return _(e.split(/\s+/)).map(function(e){return window.$h.capitalize(e)}).join(" ")},e=["none","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen","twenty"],window.$h.numberWord=function(t){return e[t]||t.toString()}}.call(this),function(){Aedu.AttachmentUploader=function(){function e(e){null==e&&(e={}),this.options=_.extend({},this.defaultOptions(),e)}return e.prototype.upload=function(e){var t,n;return t=$.Deferred(),n=this.validateFile(e),n?_.defer(function(){return t.reject({error:n})}):this.uploadFile(e,t),t.promise()},e.prototype.uploadFile=function(e,t){var n,i;return n=new FormData,n.append("files[]",e),i=$.ajax({url:this.attachmentUrl(),data:n,processData:!1,contentType:!1,type:"POST",xhr:function(){var e;return e=new window.XMLHttpRequest,e.upload.addEventListener("progress",function(e){return e.lengthComputable?t.notify(e.loaded/e.total):void 0},!1),e}}),i.done(t.resolve),i.fail(t.reject)},e.prototype.defaultOptions=function(){return{maxSize:104857600,maxFileNameLength:125,fileTypes:["pdf","txt","ps","rtf","epub","odt","odp","ods","odg","odf","sxw","sxc","sxi","sxd","doc","ppt","pps","xls","docx","pptx","ppsx","xlsx","tif","tiff","csv","tsv"],source:"multi"}},e.prototype.attachmentUrl=function(){return $r.api_v0_attachments_path({source:this.options.source,subdomain_param:"api"})},e.prototype.validateFile=function(e){return this.validateSize(e)||this.validateType(e)||this.validateName(e)},e.prototype.validateSize=function(e){return e.size>this.options.maxSize?"size-too-large":void 0},e.prototype.validateType=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.options.fileTypes,t)?void 0:"invalid-type"},e.prototype.validateName=function(e){return e.name.length>this.options.maxFileNameLength?"file-name-too-long":void 0},e.documentTitleFromFilename=function(e){return e=e.replace(/(\.[a-z]+)*$/g,""),e=this._splitUpFilenameWords(e),e=e.replace(/\s+/g," "),e=e.replace(/^[0-9 ]+/,""),e=e.replace(/[0-9 ]+$/,""),e=e.charAt(0).toUpperCase()+e.slice(1)},e._splitUpFilenameWords=function(e){return e=e.replace(/_/g," "),e.match(/-.*-/)&&(e=e.replace(/-/g," ")),e.indexOf(" ")<0&&(e=e.replace(/([a-z])([A-Z])/g,"$1 $2")),e},e}()}.call(this),function(){var e=[].slice;this.$a||(this.$a={}),_(this.$a).extend({is_logged_in:function(){return"undefined"!=typeof $current_user&&null!==$current_user&&!$current_user.unconfirmed},is_owner:function(){return"undefined"!=typeof $viewed_user&&null!==$viewed_user?$viewed_user.is_current_user():void 0},is_admin:function(){return"undefined"!=typeof $current_user&&null!==$current_user?$current_user.admin:void 0},admin_log:function(){return this.is_admin()&&"undefined"!=typeof console&&null!==console&&null!=console.log&&null!=console.log.apply?console.log.apply(console,Array.prototype.slice.call(arguments)):void 0},log:function(){return this.admin_log.apply(this,arguments)},admin_error:function(){return this.is_admin()&&"undefined"!=typeof console&&null!==console&&null!=console.error&&null!=console.error.apply?console.error.apply(console,Array.prototype.slice.call(arguments)):void 0},error:function(){return this.admin_error.apply(this,arguments)},annotate_out_links:function(e,t){return $(e+" a.outlink").each(function(){return $(this).attr("data-properties",t)})},query_param:function(e){var t,n,i,r;return i=$a.decompose_url(window.location.href),r=i[0],n=i[1],t=_.filter(n,function(t){return t[0]===e}),0===t.length?null:1===t.length?t[0][1]:_.map(t,function(e){return e[1]})},decompose_url:function(t){var n,i,r,o,a,s,l,u;return l=t.split("#"),t=l[0],r=2<=l.length?e.call(l,1):[],i=r.join("#"),n=_.chain(i.split("&")).compact().map(function(e){return e.split("=")}).value(),u=t.split("?"),t=u[0],s=2<=u.length?e.call(u,1):[],a=s.join("?"),o=_.chain(a.split("&")).compact().map(function(e){return e.split("=")}).value(),[t,o,n]},build_url:function(e,t,n){var i,r,o;return o=this.decompose_url(e),e=o[0],r=o[1],i=o[2],t&&(r=r.concat(t)),n&&(i=i.concat(n)),r.length>0&&(e=e+"?"+_(r).map(function(e){return e.join("=")}).join("&")),i.length>0&&(e=e+"#"+_(i).map(function(e){return e.join("=")}).join("&")),e},errors_array:function(e){var t,n,i,r;return _.flatten(function(){var o;o=[];for(n in e)r=e[n],o.push(function(){var e,o,a;for(a=[],e=0,o=r.length;o>e;e++)i=r[e],"base"===n?a.push(i):(t=n[0].toUpperCase()+n.slice(1),a.push(t+" "+i));return a}());return o}())},is_mobile:function(){var e;return e=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},is_element_in_viewport:function(e){var t;return t=e.getBoundingClientRect(),t&&t.bottom>=0&&t.right>=0&&t.top<=$(window).height()&&t.left<=$(window).width()},trackClickSource:function(e,t){return $(document).on("click",e,function(e){return function(){return e.track_single_request_with_source(t)}}(this))},track_single_request:function(e){var t;return t={path:"/",domain:"."+$domain,expires:this.seconds_from_now(30)},e._from_url=window.location.href,$.cookie("single_request_tracker",JSON.stringify(e),t)},track_single_request_with_source:function(e,t){return null==t&&(t={}),t.source_id=e,this.track_single_request({internal_trackable_click:t})},days_from_now:function(e){return this.seconds_from_now(86400*e)},seconds_from_now:function(e){var t;return t=new Date,t.setTime(t.getTime()+1e3*e),t},check_mutation_support:function(){var e;return null==this._supports_mutations&&(null!=window.MutationObserver||null!=window.WebKitMutationObserver?this._supports_mutations=!0:(this._supports_mutations=!1,e=$("<div></div>"),$(e).observe("added",function(e){return function(){return e._supports_mutations=!0}}(this)),e.append($("<div></div>")))),this._supports_mutations},each_current_and_future:function(e,t){var n,i;return n="academia.debounce."+GlobalIncrementor.next(),i=function(){var e;return e=$(this),e.data(n)?void 0:(e.data(n,!0),t(e))},$(document).ready(function(t){return function(){var n;return $(e).each(i),t.check_mutation_support()?$("body").observe("added",e,i):(n=_.debounce(function(){return $(e).each(i)},50),$(document).ajaxComplete(n),setInterval(n,1e3))}}(this))},valIgnoringPlaceholder:function(e){var t,n;return n=e.val(),t=e.attr("placeholder"),n===t?"":$.trim(n)},isLeftMouseButtonDown:function(e){return e||(e=window.event),1===e.buttons},fileUploadErrorString:function(e){var t,n,i;return t=_.pick(e,"errorThrown","total","loaded","bitrate"),t.status=null!=(n=e.jqXHR)?n.status:void 0,(null!=(i=e.files)?i.length:void 0)&&(t.filename=e.files[0].name),JSON.stringify(t)}}),this.$a.check_mutation_support()}.call(this),function(){var e;e=0,this.GlobalIncrementor={next:function(){return++e}}}.call(this),window.$a=window.$a||{},$a.parseUrl=function(e){return this.parser=document.createElement("a"),this.parser.href=e,this.path=function(){return this.parser.pathname},this.subdomain=function(){var e=this.parser.host.split(".");return 3===e.length?e[0]:null},{path:this.path(),subdomain:this.subdomain()}},window.$h=window.$h||{},_.extend(window.$h,{singularize:function(e){return e.match(/(x|z|ch|sh|ss)es$/)?e.substring(0,e.length-2):e.match(/s$/)?e.substring(0,e.length-1):e},abbreviateNumber:function(e){var t=e;if(e>=1e3){for(var n=["","K","M","B","T"],i=Math.floor((""+e).length/3),r="",o=2;o>=1;o--){r=parseFloat((0!=i?e/Math.pow(1e3,i):e).toPrecision(o));var a=(r+"").replace(/[^a-zA-Z 0-9]+/g,"");if(a.length<=2)break}r%1!=0&&(r=r.toFixed(1)),t=r+n[i]
}return t},decodeHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].nodeValue},encodeHTML:function(e){return $("<div/>").text(e).html()},truncate:function(e,t){return e.length>t?e.slice(0,t-3)+"\u2026":e},to_sentence:function(e){switch(e.length){case 0:return"";case 1:return""+e[0];case 2:return""+e[0]+" and "+e[1];default:return""+e.slice(0,-1).join(", ")+" and "+e.slice(-1)}}}),function(){Aedu.Broccoli=function(){function e(e){var t;return null==e&&(e={}),this.defaultCollection=e.defaultCollection,this.defaultCollection?(t=_.clone(e.defaultFeatures)||{},_.defaults(t,this.DEFAULT_FEATURES),$a.log("[Broccoli Instantiated]:",this),void this.enable(t)):void $a.error("[Broccoli Error]: must set defaultCollection on instantiation")}return e.prototype.DEFAULT_FEATURES={listenForClicks:!0,listenForHashChange:!1},e.prototype.disable=function(){return $(document).off("click.broccoli","[data-broccoli-component]"),$a.log("[Broccoli Features] listenForClicks disabled:",this)},e.prototype.enable=function(e){return null==e&&(e={}),this._enabledFeatures||(this._enabledFeatures={}),e.listenForHashChange&&!this._enabledFeatures.listenForHashChange&&(this.notifyPageViewed(),this._listenForHashChange()),e.listenForClicks&&!this._enabledFeatures.listenForClicks&&this._listenForClicks(),_.extend(this._enabledFeatures,e)},e.prototype.notifyPageViewed=function(e,t){return null==e&&(e={}),null==t&&(t=this.defaultCollection),this.notify("page-viewed",_.extend(e,{url:window.location.toString()}),t)},e.prototype.notifyComponentClicked=function(e,t,n){var i,r,o,a;if(null==t&&(t={}),null==n&&(n=this.defaultCollection),i=$(e),0===i.length)return void $a.error("[Broccoli Error]: invalid domElement in notifyComponentClicked");if(r=i.attr("data-broccoli-component"),!r)return void $a.error("[Broccoli Error]: invalid component in notifyComponentClicked");n=i.attr("data-broccoli-collection")||n;try{return o=JSON.parse(i.attr("data-broccoli-data")||"{}")}catch(s){return a=s,o={},$a.error("[Broccoli Error] Unable to parse data for "+r)}finally{this.notify(r+"__clicked",_.extend(t,o),n)}},e.prototype.notify=function(e,t,n){return null==t&&(t={}),null==n&&(n=this.defaultCollection),t=_.extend(t,{event:e,user_id:"undefined"!=typeof $current_user&&null!==$current_user?$current_user.id:void 0,auvid:$auvid}),this._getNotifier(n).notify(t),$a.log("[Broccoli Notify]:",t,this)},e.prototype._getNotifier=function(e){return this._notifiers||(this._notifiers={}),this._notifiers[e]||(this._notifiers[e]=new c.Server.Notification(e)),this._notifiers[e]},e.prototype._listenForClicks=function(){return $(document).on("click.broccoli","[data-broccoli-component]",function(e){return function(t){return e.notifyComponentClicked(t.currentTarget)}}(this)),$a.log("[Broccoli Features] listenForClicks enabled:",this)},e.prototype._listenForHashChange=function(){return $(window).on("hashchange.broccoli",function(e){return function(){return e.notifyPageViewed()}}(this)),$a.log("[Broccoli Features] listenForHashChange enabled:",this)},e}()}.call(this),function(){Academia.track_click=function(e,t,n){$.ajax({type:"POST",url:"/out_link",data:{url:e,properties:t},async:!!n})},$(document).on("click","a.outlink",function(){var e=$(this);return Academia.track_click(e.attr("href"),e.data("properties"),!1),!0})}(),function(){Academia.set_gmtoffset=function(e){var t={minutes:(new Date).getTimezoneOffset()};"undefined"!=typeof $current_user?$.post(e,t):$.get(e,t)}}();var Kale=function(){function e(e){e.listenForClicks===!0&&a(),e.listenForHashChange===!0&&r()}function t(e){if(e=e||{},!e.eventData)return void h.error("[Kale] Must pass in data to notify");var t=_.extend({},l(),e.eventData);u({collectionName:e.collectionName,eventData:t})}function n(e){return e?e.collectionName?e.notifier?(d=d||{},void(d[e.collectionName]=e.notifier)):void h.error("[Kale] Must pass in notifier in options hash for setNotifierForCollection"):void h.error("[Kale] Must pass in collectionName in options hash for setNotifierForCollection"):void h.error("[Kale] Cannot call setNotifierForCollection with no arguments")}function i(e){return e&&e.log&&e.error?void(h=e):void console.error("[Kale] Must pass in a valid context for setLogger")}function r(){p=p||{},p.listenForHashChange||(p.listenForHashChange=!0,$(window).on("hashchange",o),h.log("[Kale] listenForHashChange enabled"))}function o(e){e=e||{};var t=_.extend(l(),{event:"page-viewed",url:window.location.toString()});u({collectionName:"kale_page_views",eventData:t})}function a(){p=p||{},p.listenForClicks||(p.listenForClicks=!0,$(document).on("click","[data-kale-component]",function(e){s({domElement:e.currentTarget})}),h.log("[Kale] listenForClicks enabled"))}function s(e){e=e||{};var t=$(e.domElement);if(0===t.length)return void h.error("[Kale] domElement does not exist",e.domElement);var n=t.attr("data-kale-component");if(!n)return void h.error("[Kale] Must set a non-empty component name for data-kale-component");var i=t.attr("data-kale-collection");if(!i)return void h.error("[Kale] Must set a collection for data-kale-collection");var r=t.attr("data-kale-data")||"{}";try{r=JSON.parse(r)}catch(o){h.error("[Kale] Unable to parse JSON from data-kale-data")}r=_.extend({component:n,componentAction:"clicked"},l(),r),u({collectionName:i,eventData:r})}function l(){var e={user_id:null,auvid:null};return Aedu.User.current&&(e.user_id=Aedu.User.current.id),"undefined"!=typeof $auvid&&null!==$auvid&&(e.auvid=$auvid),e}function u(e){e=e||{},c(e.collectionName).notify(e.eventData),h.log("[Kale Event]:",e.collectionName,e.eventData)}function c(e){return d=d||{},d[e]||(d[e]=new Aedu.Server.Notification(e)),d[e]}var d,p,h=$a;return a(),{enableFeatures:e,notify:t,setNotifierForCollection:n,getNotifierForCollection:c,setLogger:i}}();Aedu.record_browser_timings=function(){window.performance&&window.performance.timing&&$(window).on("load",function(){var e=_.extend({url:""+window.location},window.performance.timing.toJSON());new Aedu.Server.Notification("dev_timings").notify(e)})};var $auvid;!function(){var e={record_hit_if_not_recorded:function(){Aedu.hit_data||this.record_hit({url:""+window.location,referrer:document.referrer,request_id:$request_id})},record_hit:function(e){$.ajax({type:"POST",url:"/record_hit",data:e}).done(function(e){Aedu.hit_data=e,e.auvid!=$auvid&&$a.log("Unexpected auvid mismatch: client="+$auvid+" & server="+e.auvid)})},set_auvid:function(){var e="auvid",t=$.cookie(e);if(null==t){var n=Math.random(),i=btoa(""+$start_time+":"+n);$.cookie(e,i,{path:"/",expires:30,domain:"."+$domain}),$auvid=i}else $auvid=t},page_loaded:function(){this.set_auvid(),this.record_hit_if_not_recorded(),$.cookie("from_cache","")}};$(document).ready(function(){e.page_loaded()})}(),function(){var e;(e=this.c).Server||(e.Server={}),c.Server.Notification=function(){function e(e,t){this.name=e,this.options=null!=t?t:{}}return e.prototype.notify=function(e){return null==e&&(e={}),jQuery.ajax({url:$r.api_v0_active_support_notifications_path({subdomain_param:"api"}),contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:jQuery.extend(e,{name:this.name}),type:"POST",statusCode:{401:function(t){return function(){return t.options._second_try?void 0:new c.Server.Notification(t.name,jQuery.extend(t.options,{_second_try:!0})).notify(e)}}(this)}})},e}()}.call(this),function(){var e=[].slice;Academia.Split={startAndRecord:function(){var t,n,i,r;return t=arguments[0],n=2<=arguments.length?e.call(arguments,1):[],r=this.clientCookieName(t),i=$.cookie(r),null!=i?i:(i=this.parseSplitTestDescription(n),$.cookie(r,i,{domain:$domain,path:"/",expires:365}),this.recordSplit(t,!1,n),i)},isSplitGroupMember:function(e,t){var n,i;return i=$a.query_param(e),null!=i?i===t:(n=this.clientCookieName(e),$.cookie(n)===t)},parseSplitTestDescription:function(e){var t,n,i,r,o,a,s,l,u,c,d,p;if(!$.isArray(e[0]))return s=e.length,u=Math.floor(Math.random()*s),d=e[u];for(s=0,p=[],n=0,d="",i=0,o=e.length;o>i;i++)t=e[i],s+=t[1],p.push([t[0],t[1]+n]),n+=t[1];for(l=Math.floor(Math.random()*s),r=0,a=p.length;a>r;r++)if(c=p[r],l<c[1])return c[0]},recordSplit:function(e,t,n){var i;return(i=$.cookie(this.clientCookieName(e)))?$.post("/record_split",{ab_test_name:e,test:i,options:n,finish:t}):void 0},endSplit:function(e){return $.cookie(this.clientCookieName(e),null,{domain:$domain,path:"/"})},clientCookieName:function(e){return"split_"+e}}}.call(this),function(){this.Aedu.FollowResearchInterestApi=function(){function e(){}return e.prototype.follow_ri=function(e){return this._post_follow_ri(e,$r.add_api_v0_taggings_path).done(function(e){var t;return null!=(t=Aedu.User.current)?t.record_interest_of(e.research_interest):void 0})},e.prototype.unfollow_ri=function(e){return this._post_follow_ri(e,$r.remove_api_v0_taggings_path).done(function(){var t;return null!=(t=Aedu.User.current)?t.record_uninterest_of(e):void 0})},e.prototype._post_follow_ri=function(e,t){return $.ajax({type:"POST",url:t({subdomain_param:"api",tag_type:"ResearchInterest",target_type:"User",target_id:$current_user.id}),data:{tag:{id:e}}})},e}(),window.FollowRI=new Aedu.FollowResearchInterestApi}.call(this),function(){this.c.FollowUserApi=function(){function e(){}return e.prototype.followUser=function(e,t,n){return this._postFollow(e,"POST",t,n).done(function(){var t;return null!=(t=Aedu.User.current)?t.record_follow_of(e):void 0})},e.prototype.unfollowUser=function(e){return this._postFollow(e,"DELETE").done(function(){var t;return null!=(t=Aedu.User.current)?t.record_unfollow_of(e):void 0})},e.prototype._postFollow=function(e,t,n,i){var r;return r={_method:t},null!=n&&(r.source=n),null!=i&&(r.source_details=i),$.ajax({url:$r.api_v0_user_following_index_path({user_id:e,subdomain_param:"api"}),type:"POST",data:r})},e.prototype.blockUser=function(e){return this._postBlock(e,"POST")},e.prototype.unblockUser=function(e){return this._postBlock(e,"DELETE")},e.prototype._postBlock=function(e,t){return $.ajax({url:$r.api_v0_user_blocks_path({user_id:e,subdomain_param:"api"}),type:"POST",data:{_method:t}})},e.prototype.showSignupToFollow=function(e,t){var n,i,r;return n=1/24/60*30,$.cookie("follow",e,{path:"/",domain:"."+$domain,expires:n}),i="//"+$app_host+"/signup_wall",r=[["user_source","follow"],["boxy","iframe"]],$w.boxover({iframe:$a.build_url(i,r),title:"Please sign up to follow "+t,height:"280px",classes:"SignupWall--iframe-container",onclose:function(){return $.removeCookie("follow",{path:"/",domain:"."+$domain})}})},e}(),window.Follow=new c.FollowUserApi}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.ResearchInterest=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.loadFollowersCount=function(){return this._loadAsyncAttr("followers_count",$r.api_v0_interest_followers_url({interest_id:this.id}),function(e){return e.count})},n.prototype.loadWorksCount=function(){return this._loadAsyncAttr("works_count",$r.api_v0_interest_works_url({interest_id:this.id}),function(e){return e.count})},n.prototype._loadAsyncAttr=function(e,t,n){var i,r;return this._async_attr_promises||(this._async_attr_promises={}),(i=this._async_attr_promises)[e]||(i[e]=$.ajax({url:t,dataType:"jsonp"})),r=new $.Deferred,this._async_attr_promises[e].done(function(e){return r.resolve(n(e))}),r},n}(Backbone.Model)}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};this.c||(this.c={}),this.Aedu.User=function(){function t(e){this.set_attrs(e)}return t.users={},t.set_current=function(e){return this.current=this.from_json(e)},t.set_viewed=function(e){return this.viewed=this.from_json(e)},t.from_json=function(e){var n;if("string"==typeof e&&(e=JSON.parse(e)),n=e.id,null==n)throw"id is required";return n in this.users?this.users[n].set_attrs(e):this.users[n]=new t(e)},t.prototype.set_attrs=function(e){if(_.extend(this,e),null==this.first_name||null==this.last_name)throw"first and last name are required";if(this.display_name=this.first_name+" "+this.last_name,null==this.domain_name||null==this.page_name)throw"subdomain and page are required";return this.url=$r.new_profile_url({subdomain:this.domain_name,page_name:this.page_name}),null!=this.followee_ids&&$.isArray(this.followee_ids)&&(this.followee_ids=_(this.followee_ids).reduce(function(e,t){return e[t]=!0,e},{})),this},t.prototype.is_affiliated=function(){return"independent"!==this.domain_name},t.prototype.update_url=function(e){var t;return this.url=e,t=e.replace(/https?:\/\//,"").split("."+$app_host+"/"),this.domain_name=t[0],this.page_name=t[1],t},t.prototype.affiliationString=function(e){return null==e&&(e={}),this.affiliation().toString(e)},t.prototype.affiliation=function(){return{category:this.is_affiliated()?"university":"independent",department:this.department,position:{id:this.position_id,name:4!==this.position_id?this.position:void 0},custom_position:{name:4===this.position_id?this.position:void 0},is_primary:!0,positionPlaceholder:function(e){return function(t){var n;return n=t.useIndependentResearcherFallback,null==n&&(n=!0),e.interests.length>0?$h.to_sentence(_(e.interests.slice(0,3)).pluck("name")):n?"Independent Researcher":""}}(this),toString:function(e){return null==e&&(e={}),this.department?[this.department.university.name,this.position.name||this.custom_position.name,this.department.name].join(", "):this.positionPlaceholder(e)}}},t.prototype.has_teaching_position=function(){var e;return 1===(e=this.position_id)||2===e||3===e||6===e||9===e},t.prototype.has_research_interests=function(){return null!=this.interests?this.interests.length>0:void 0},t.prototype.has_interest=function(e){return null!=this.interests?_(this.interests).some(function(t){return t.id===e}):void 0},t.prototype.record_interest_of=function(e){return Aedu.User.current.interests.push(e)},t.prototype.record_uninterest_of=function(e){return Aedu.User.current.interests=_.reject(Aedu.User.current.interests,function(t){return t.id===e})},t.prototype.has_rollout_feature=function(t){return this.active_rollout_features?e.call(this.active_rollout_features,t)>=0:!1},t.prototype.is_analytics_visible=function(){return this.is_analytics_public||this.is_current_user()},t.prototype.message_me_path=function(){return"/Messages?recipient="+this.id},t.prototype.follows=function(e){return null!=this.followee_ids?e in this.followee_ids:void 0},t.prototype.record_follow_of=function(e){return null!=this.followee_ids?this.followee_ids[e]=!0:void 0},t.prototype.record_unfollow_of=function(e){return null!=this.followee_ids?delete this.followee_ids[e]:void 0},t.prototype.is_current_user=function(){var e;return(null!=(e=this.constructor.current)?e.id:void 0)===this.id},t.prototype.is_viewed_user=function(){var e;return(null!=(e=this.constructor.viewed)?e.id:void 0)===this.id},t.prototype.load_followers_count=function(){return this._load_async_attr("followers_count",$r.api_v0_user_followers_url({user_id:this.id,limit:0}),function(e){return e.meta.count})},t.prototype.load_works_count=function(){return this._load_async_attr("works_count",$r.count_api_v0_user_works_url({user_id:this.id}),function(e){return e.count})},t.prototype.load_views_counts=function(){return this._load_async_attr("views_counts",$r.api_v0_user_stats_url({user_id:this.id}),function(e){return e})},t.prototype._load_async_attr=function(e,t,n){var i,r;return this._async_attr_promises||(this._async_attr_promises={}),(i=this._async_attr_promises)[e]||(i[e]=$.ajax({url:t,dataType:"jsonp"})),r=new $.Deferred,this._async_attr_promises[e].done(function(e){return r.resolve(n(e))}),r},t}(),"undefined"!=typeof $current_user&&null!==$current_user&&this.Aedu.User.set_current($current_user)}.call(this),function(){var e;this.Aedu||(this.Aedu={}),(e=this.Aedu).Behaviors||(e.Behaviors={})}.call(this),function(){var e;e=function(e){var t,n,i,r;return t=document.createElement("a"),t.href=e,n=t.hostname,r="."+$domain,i=n.lastIndexOf(r),i>0&&i===n.length-r.length},$.ajaxPrefilter(function(t,n,i){return!t.crossDomain||e(t.url)?$.rails.CSRFProtection(i):void 0})}.call(this),function(){var e={page_loaded:function(e){$("meta[name=csrf-token]").attr("content")===e&&$.post("/csrf_meta",function(e){$("meta[name=csrf-token]").attr("content",e),$("input[name=authenticity_token]").val(e)})}};$(document).ready(function(){"undefined"!=typeof $authenticity_token_placeholder&&e.page_loaded($authenticity_token_placeholder)})}(),function(){var t;t=function(e){var t;return t=e.parents("*[data-hover-menu]").find(".hover_menu_row"),t.removeClass("hovered"),e.addClass("hovered")},$(document).on("mouseenter","*[data-hover-menu]",function(){var t;return t=$(e.currentTarget),t.data("hover-menu-on",!0),t.find(".hover_menu").fadeIn(100)}),$(document).on("mouseleave","*[data-hover-menu]",function(){var t;return t=$(e.currentTarget),t.data("hover-menu-on",!1),_.delay(function(){return t.data("hover-menu-on")?void 0:t.find(".hover_menu").fadeOut(100)},200)}),$(document).on("mouseenter","*[data-hover-menu=first]",function(e){var n;return n=$(e.target),n.is(".hover_menu")||n.parents().is(".hover_menu")?void 0:t($($(e.currentTarget).find(".hover_menu_row").get(0)))}),$(document).on("mouseenter","*[data-hover-menu] .hover_menu_row",function(e){return t($(e.currentTarget))})}.call(this),function(){$a.each_current_and_future(".load_async",function(e){var t;return t=e.data("url"),t?$.ajax({url:t}).done(function(t){return e.html(t).show()}):void 0})}.call(this),function(){var e,t;e=function(e,t,n,i){return t.length>1&&(t=JSON.parse(t)),e.trigger("ajax:success",[t,n,i]),null!=(null!=t?t.redirect:void 0)?document.location=t.redirect:void 0},t=function(t,n){return null==n&&(n={}),$.ajax({url:t.attr("href"),type:"POST",data:n,success:function(n,i,r){return e(t,n,i,r)}})},$(document).on("confirm","a[data-method='delete']",function(e){var n,i;return n=$(e.currentTarget),i=n.data("confirm")||"Are you sure?",$w.confirm(i,{nextTo:n},function(){return t(n,{_method:"DELETE"})}),!1}),$(document).on("confirm","a[data-method='post']",function(e){var n,i;return n=$(e.currentTarget),i=n.data("confirm"),i?$w.confirm(i,{nextTo:n},function(){return t(n)}):t(n),!1})}.call(this),function(){var e;e=function(e){var t,n,i;return t=e.closest(e.data("container")),i=t.find(e.data("show")),n=t.find(e.data("hide")),{show:i,hide:n}},$(document).on("click","a[data-more-link-behavior=true]",function(e){var t;return e.preventDefault(),t=$(e.target),t.trigger("show_more")}),$(document).on("show_more","*",function(t){var n,i,r;return t.stopPropagation(),i=e($(t.target)),r=i.show,n=i.hide,n.addClass("hidden"),n.hide(),r.removeClass("hidden"),r.show()}),$(document).on("show_less","*",function(t){var n,i,r;return t.stopPropagation(),i=e($(t.target)),r=i.show,n=i.hide,r.addClass("hidden"),r.hide(),n.removeClass("hidden"),n.show()})}.call(this),function(){$(document).on("resize_boxy",function(){return function(e,t){var n;return n=_.find(Widgets.Base.open_widgets||[],function(e){return"BoxOver"===e.widget_name}),null!=t&&null!=n?n.set_height(t):void 0}}(this))}.call(this),function(){Aedu.Behaviors.ScrollScope=function(){var e;return e=!1,{enable:function(t){return e||$(document).scrollScope(),e=!0,t.attr("data-scroll-scope",!0)}}}()}.call(this),function(){$(document).on("focus click","textarea.autoexpand_on_focus",function(){return $(this).autosize()})}.call(this),function(){var e=function(e){var t=e.attr("maxlength");t&&t>0&&e.keydown(function(){e.val().length>t&&e.val(e.val().substring(0,t))})};$a.each_current_and_future("textarea",e)}(),function(){$a.each_current_and_future("time.js-time-ago",function(e){return e.timeago()})}.call(this),function(){$a.each_current_and_future(".js-tooltip",function(e){return e.tooltip()})}.call(this),function(){this.$w||(this.$w={}),this.Widgets||(this.Widgets={})}.call(this),Widgets.Base={parent:null,open_widgets:[],inherit:function(e){var t=$x.extend($x.object(this),e);return t.parent=this,t},create:function(e){var t=$x.object(this);return t.init(e),t},target_element:null,init:function(e){this.target_element=e.nextTo;var t=e.down||10,n=e.along||0,i=$(this.target_element).offset();this.offset={left:i.left+n,top:i.top+t}},dom_element:null,j_element:null,definition:function(){return["div.base-widget"]},build:function(){this.dom_element=JSML.transform(this.definition()),this.j_element=$(this.dom_element),this.j_element.hide()},insert:function(){document.body.appendChild(this.dom_element)},remove:function(){var e=this.dom_element;e?e.parentNode.removeChild(e):$a.log("el wasn't defined")},position:function(){this.target_element&&this.j_element.css({position:"absolute",left:this.offset.left,top:this.offset.top})},show:function(){this.prepare(),this.j_element.show(),this.add_to_open_widgets()},fadeIn:function(){this.prepare(),this.j_element.fadeIn(),this.add_to_open_widgets()},hide:function(){$("#overlay_background").hide(),this.j_element.hide(),this.cleanup(),this.remove_from_open_widgets(),"function"==typeof this.after_hide_callback&&this.after_hide_callback()},fadeOut:function(){var e=this;this.j_element.fadeOut(function(){e.cleanup(),e.remove_from_open_widgets(),"function"==typeof e.after_hide_callback&&e.after_hide_callback()})},shake:function(e){e="undefined"!=typeof e?e:"5px";var t=this;t.j_element.animate({marginLeft:"-"+e},100,function(){t.j_element.animate({marginLeft:e},100,function(){t.j_element.animate({marginLeft:"0px"},100)})})},hide_all:function(){for(var e=Widgets.Base.open_widgets.slice(),t=0;t<e.length;t++)e[t].hide()},add_to_open_widgets:function(){Widgets.Base.open_widgets.push(this)},remove_from_open_widgets:function(){var e=Widgets.Base.open_widgets.indexOf(this);e>=0&&Widgets.Base.open_widgets.splice(e)},prepare:function(){this.insert(),this.position()},cleanup:function(){this.j_element.html(""),this.remove()},flash:function(e,t){"undefined"==typeof t&&(t={});var n=t.fadeInMS||100,i=t.visibleMS||400,r=t.fadeOutMS||400,o=this;o.prepare(),o.j_element.fadeIn(n,function(){setTimeout(function(){o.j_element.fadeOut(r,function(){o.cleanup(),e&&e()})},i)})},bind_fade_to_events:function(){var e=this,t=$.map(arguments,function(e){return"string"==typeof e[0]?$(e[0]):e[0]}),n=$.map(arguments,function(e){return e[1]}),i=function(){$.each(t,function(e,t){t.unbind(n[e],i)}),"none"!==e.j_element.css("display")&&e.fadeOut()};$.each(t,function(e,t){t.bind(n[e],i)})}},/* ========================================================================
 * Bootstrap: tooltip.js v3.2.0
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.tooltip"),o="object"==typeof t&&t;(r||"destroy"!=t)&&(r||i.data("bs.tooltip",r=new n(this,o)),"string"==typeof t&&r[t]())})}var n=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};n.VERSION="3.2.0",n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var r=this.options.trigger.split(" "),o=r.length;o--;){var a=r[o];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show()},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var i=this,r=this.tip(),o=this.getUID(this.type);this.setContent(),r.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&r.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,l=s.test(a);l&&(a=a.replace(s,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element);var u=this.getPosition(),c=r[0].offsetWidth,d=r[0].offsetHeight;if(l){var p=a,h=this.$element.parent(),f=this.getPosition(h);a="bottom"==a&&u.top+u.height+d-f.scroll>f.height?"top":"top"==a&&u.top-f.scroll-d<0?"bottom":"right"==a&&u.right+c>f.width?"left":"left"==a&&u.left-c<f.left?"right":a,r.removeClass(p).addClass(a)}var m=this.getCalculatedOffset(a,u,c,d);this.applyPlacement(m,a);var g=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},n.prototype.applyPlacement=function(t,n){var i=this.tip(),r=i[0].offsetWidth,o=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),t.top=t.top+a,t.left=t.left+s,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var l=i[0].offsetWidth,u=i[0].offsetHeight;"top"==n&&u!=o&&(t.top=t.top+o-u);var c=this.getViewportAdjustedDelta(n,t,l,u);c.left?t.left+=c.left:t.top+=c.top;var d=c.left?2*c.left-r+l:2*c.top-o+u,p=c.left?"left":"top",h=c.left?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(d,i[0][h],p)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),r=e.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(r),r.isDefaultPrevented()?void 0:(i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],i="BODY"==n.tagName;return e.extend({},"function"==typeof n.getBoundingClientRect?n.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:i?e(window).width():t.outerWidth(),height:i?e(window).height():t.outerHeight()},i?{top:0,left:0}:t.offset())},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var r={top:0,left:0};if(!this.$viewport)return r;var o=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-o-a.scroll,l=t.top+o-a.scroll+i;s<a.top?r.top=a.top-s:l>a.top+a.height&&(r.top=a.top+a.height-l)}else{var u=t.left-o,c=t.left+o+n;u<a.left?r.left=a.left-u:c>a.width&&(r.left=a.left+a.width-c)}return r},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),function(){$.fn.tooltip.Constructor.DEFAULTS.template='<div class="academia-tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}.call(this),/* ========================================================================
 * Bootstrap: popover.js v3.2.0
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),r=i.data("bs.popover"),o="object"==typeof t&&t;(r||"destroy"!=t)&&(r||i.data("bs.popover",r=new n(this,o)),"string"==typeof t&&r[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.2.0",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},n.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.HoverPopover=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.$el.data("bs.popover")?void 0:(this.on_shown=e.on_shown,this.show_delay=e.show_delay,this.hide_delay=e.hide_delay,this.before_show=e.before_show,this.frozen=!1,e.trigger="manual",this.$el.popover(e),this._popover_el().on("mouseenter",function(e){return function(){return e._unschedule_close()}}(this)).on("mouseleave",function(e){return function(){return e._schedule_close()}}(this)))},n.prototype.events={mouseenter:"_schedule_open",mouseleave:"_schedule_close",click:"_handle_click","shown.bs.popover":"_emit_shown"},n.prototype.freeze=function(){return this._unschedule_open(),this._unschedule_close(),this.frozen=!0},n.prototype.unfreeze=function(){return this.frozen=!1,this.$el.is(":hover")||this._popover_el().is(":hover")?this._schedule_open():this._schedule_close()},n.prototype._emit_shown=function(){return null!=this.on_shown?this.on_shown(this._popover_el()):void 0},n.prototype._handle_click=function(e){return e.stopPropagation(),this.popover_shown?void 0:(this._show(),e.preventDefault())},n.prototype._schedule_open=function(e){return this.frozen||$a.isLeftMouseButtonDown(e)?void 0:(this._unschedule_close(),this.openme=setTimeout(function(e){return function(){return e.popover_shown?void 0:e._show()}}(this),this.show_delay))},n.prototype._unschedule_open=function(){return null!=this.openme?clearTimeout(this.openme):void 0},n.prototype._schedule_close=function(){return this.frozen?void 0:(this._unschedule_open(),this.closeme=setTimeout(function(e){return function(){return e._hide()}}(this),this.hide_delay))},n.prototype._unschedule_close=function(){return null!=this.closeme?clearTimeout(this.closeme):void 0},n.prototype._show=function(){var e;return e=function(e){return function(){return e.popover_shown=!0,e.$el.popover("show"),_.defer(function(){return e.popover_shown?e._hide_on_clicking_elsewhere():void 0})}}(this),this.before_show?this.before_show(e):e()},n.prototype._hide_on_clicking_elsewhere=function(){return $(document).on("click.hover-popover",function(e){return function(t){return e._popover_el()?e._popover_el().has($(t.target)).length>0?void 0:_.defer(function(){return e.popover_shown?e._hide():void 0}):void 0}}(this))},n.prototype._hide=function(){return this.popover_shown=!1,this.frozen=!1,this.$el.popover("hide"),$(document).off("click.hover-popover")},n.prototype._popover_el=function(){var e;return null!=(e=this.$el.data("bs.popover"))?e.tip():void 0},n.prototype.remove=function(){return this._hide(),n.__super__.remove.apply(this,arguments)},_,n}(Backbone.View)}.call(this),function(){var e;e=function(e){return function(t){return t.authResponse?FB.api("/me/permissions",function(n){return n&&!n.error&&_.findWhere(n.data,{permission:"email",status:"granted"})?void e.resolve(t.authResponse):(FB.api("/me/permissions","DELETE",function(){}),e.reject())}):e.reject()}},this.Facebook={is_ready:!1,ready_listeners:[],connected_url:"/auth/connect",disconnected_url:"/auth/disconnect",default_permissions:"email,user_friends,user_education_history,user_work_history",scope:function(){return this.default_permissions},run_ready_listeners:function(){var e,t;for(this.is_ready=!0,e=void 0,t=[];e=this.ready_listeners.shift();)t.push(e());return t},_when_ready:function(e){return this.is_ready?e():this.ready_listeners.push(e)},get_login_status:function(e){return this._when_ready(function(){return FB.getLoginStatus(e)})},check_login_status:function(){var t;return t=new $.Deferred,this.get_login_status(e(t)),t},authorize:function(t){var n,i;return null==t&&(t=!1),n=new $.Deferred,i={scope:this.scope()},t&&(i.auth_type="rerequest"),this._when_ready(function(){return function(){return FB.login(e(n),i)}}(this)),n},check_permissions_granted:function(e){var t;return t=new $.Deferred,FB.api("/me/permissions",function(n){var i,r,o,a;return n&&!n.error&&(a=function(){var t,o,a;for(a=[],t=0,o=e.length;o>t;t++)r=e[t],i=_.findWhere(n.data,{permission:r,status:"granted"}),a.push(null!=i);return a}(),o=_.reduce(a,function(e,t){return e&&t},!0),t.resolve(o)),t.resolve(!1)}),t},register_connected:function(e){return $.post(this.connected_url,{provider:"facebook",uid:e.userID,"oauth[token]":e.accessToken,"oauth[expires]":e.expiresIn})},deregister_connected_and_reload:function(){return FB.login(function(e){return e.authResponse?FB.api({method:"auth.revokeAuthorization",params:{uid:e.authResponse.userID}},function(){return $.post(Facebook.disconnected_url,{provider:"facebook"},function(){return window.location.reload(!0)})}):void 0})}}}.call(this),function(){this.Google={last_successful_auth_response:!1,disconnect_api_url:"https://accounts.google.com/o/oauth2/revoke?token=",disconnect_url:"auth/disconnect",connect_url:"auth/connect",scopes:"openid email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/contacts.readonly https://www.googleapis.com/auth/plus.me",old_scopes:"openid email https://www.googleapis.com/auth/userinfo.profile https://www.google.com/m8/feeds/ https://www.googleapis.com/auth/plus.me",authorize:function(){var e;return this.last_successful_auth_response?(e=new $.Deferred,e.resolve(this.last_successful_auth_response),e):this._request_auth({scope:this.scopes,immediate:!1})},check_authorization:function(){return this._request_auth({scope:this.scopes,immediate:!0}).fail(function(e){return function(t){return"immediate_failed"===(null!=t?t.error:void 0)?e._request_auth({scope:e.old_scopes,immediate:!0}):void 0}}(this))},_request_auth:function(e){var t;return t=new $.Deferred,"undefined"==typeof gapi?t.reject():gapi.auth.authorize(_.extend({client_id:Google.client_id},e),function(e){return function(n){return(null!=n?n.access_token:void 0)?(e.last_successful_auth_response=n,t.resolve(n)):t.reject(n)}}(this)),t},get_user_info:function(){var e;return e=new $.Deferred,gapi.client.load("oauth2","v2",function(){return gapi.client.oauth2.userinfo.get({userId:"me"}).then(function(t){return e.resolve(t.result)},function(){return e.reject()})}),e},register_connected:function(e,t){return $.post(Google.connect_url,{provider:"google",uid:t.id,"oauth[token]":e.access_token,"oauth[expires]":e.expires_in})},deregister_connected_and_reload:function(){return this.authorize().done(function(e){var t;return t=Google.disconnect_api_url+e.access_token,$.ajax({type:"GET",url:t,async:!1,contentType:"application/json",dataType:"jsonp",success:function(){return $.post(Google.disconnect_url,{provider:"google","oauth[token]":e.access_token,"oauth[expires]":e.expires_in},function(){return window.location.reload()})}})})}}}.call(this),function(){var e,t,n,i,r,o,a,s,l;e=function(){function e(e,t){this.routeHelper=e,this.ajaxResponseDataKey=t,this.pendingItems=[],this.retrieve=_.debounce(this.retrievePendingItems,100)}return e.prototype.queue=function(e,t){return this.pendingItems.push({itemId:e,callback:t}),this.retrieve()},e.prototype.retrievePendingItems=function(){var e,t;if(0!==this.pendingItems.length)return t=this.pendingItems.slice(),e=_.keys(_.groupBy(this.pendingItems,"itemId")),this.pendingItems=[],$.ajax({dataType:"jsonp",url:this.routeHelper(e),success:function(e){return function(n){return _.each(n[e.ajaxResponseDataKey],function(e,n){var i;return n=parseInt(n),i=_.filter(t,function(e){return e.itemId===n}),_.each(i,function(t){return t.callback(e)})})}}(this)})},e}(),l=function(e){return $r.api_v0_works_views_url({work_ids:e})},window.Academia.workViewCountsFetcher=new e(l,"views"),s=function(e){return $r.api_v0_works_percentiles_url({work_ids:e})},window.Academia.workPercentilesFetcher=new e(s,"percentiles"),a=function(e){return $r.api_v0_works_certification_counts_url({work_ids:e})},window.Academia.workCertificationCountsFetcher=new e(a,"certification_counts"),o=function(e){return $r.api_v0_works_bookmark_counts_url({work_ids:e})},window.Academia.workBookmarkCountsFetcher=new e(o,"bookmark_counts"),t=function(e){return $r.api_v0_certifications_ranks_paper_ranks_url({ids:e})},window.Academia.paperRanksFetcher=new e(t,"paper_ranks"),i=function(e){return $r.api_v0_social_distance_url()+"?work_ids[]="+e.join("&work_ids[]=")},window.Academia.socialDistanceFetcher=new e(i,"works"),r=function(e){return $r.api_v0_profiles_user_relation_stats_url({ids:e})},window.Academia.userRelationStats=new e(r,"profile_user_relation_stats"),n=function(e){return $r.api_v0_post_download_data_url({ids:e})},window.Academia.postDownloadDataFetcher=new e(n,"post_download_data")}.call(this),function(){this.AcademiaSharing={}}.call(this),function(){$(document).on("click","*[data-academia-share]",function(e){var t;return t=new AcademiaSharing.BookmarkButtonView({el:$(e.currentTarget)}),t.model.fetch().error(function(){return t.model.set({message:""})}).always(function(){return t.handle_bookmark_click()})})}.call(this),function(){AcademiaSharing.UndoTracker=function(){function e(){this.consecutive_undos=parseInt($.cookie(this.cookie_name)||0),$.removeCookie(this.cookie_name,this.cookie_settings())}return e.prototype.cookie_name="autobookmark_undo",e.prototype.increment=function(){return $.cookie(this.cookie_name,this.consecutive_undos+1,this.cookie_settings())},e.prototype.cookie_settings=function(){return{path:"/",domain:"."+$domain,expires:$a.days_from_now(7)}},e}()}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/modal_view"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="academia_sharing_modal clearfix"><div class="work_share_container">'+(null==(t=i)?"":t)+'</div><div class="input"><textarea name="message" maxlength="500" class="message">'+jade.escape(null==(t=e)?"":t)+'</textarea></div><a href="#" style="display: none" class="button red unshare">Remove</a><a href="#" class="button blue save">Save</a><a href="#" class="button light-grey cancel">Cancel</a></div>')}.call(this,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"preview"in i?i.preview:"undefined"!=typeof preview?preview:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/settings_link"]=function(){var e=[];return e.push('<div class="top_banner_flash orange"><i class="close">&times;</i><a href="/settings#privacy-settings" class="action">Settings</a><p class="message">Did you know you can prevent your downloads from being automatically bookmarked? Visit your <a href="/settings#privacy-settings">Privacy Settings.</a></p></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/bookmarks/templates/success_notice"]=function(e){var t=[],n=e||{};return function(e){t.push('<div class="js-top-banner-flash top_banner_flash blue"><i class="close">&times;</i><a class="action">Undo</a><p class="message">'),t.push(e?'Paper downloaded and added to your public <a href="/Bookmarks">bookmarks</a>':'Paper added to your public <a href="/Bookmarks">bookmarks</a>'),t.push("</p></div>")}.call(this,"isDownload"in n?n.isDownload:"undefined"!=typeof isDownload?isDownload:void 0),t.join("")}}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;AcademiaSharing.Bookmark=function(n){function i(){return this.sync=e(this.sync,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.modelName="bookmark",i.prototype.routeKey="api_v0_bookmark",i.for_target_arx=function(e,t){var n,i,r,o;return null==t&&(t={}),r=e.split("/"),o=r[0],n=r[1],i=new AcademiaSharing.Bookmark({content_type:o,content_id:parseInt(n)}),i.set(t),i},i.prototype.target_arx=function(){return this.get("content_type")+"/"+this.get("content_id")},i.prototype.url=function(e){return"read"===e&&null==this.id?$r.find_api_v0_bookmarks_path({subdomain_param:"api","bookmark[content_type]":this.get("content_type"),"bookmark[content_id]":this.get("content_id")}):i.__super__.url.apply(this,arguments)},i.prototype.sync=function(e){var t;return t=i.__super__.sync.apply(this,arguments),!t||"create"!==e&&"update"!==e||t.done(function(e){return function(){return e.trigger("save")}}(this)),t},i.prototype.preview_url=function(){return $r.html_api_v0_work_path({id:this.get("content_id"),subdomain_param:"api"})},i.prototype.toJSON=function(){return _.omit(this.attributes,"preview")},i}(Academia.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;AcademiaSharing.BookmarkButtonView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.set_model(this.options.model||this.build_model(this.options.model_options)),this},n.prototype.set_model=function(e){return this.model=e,this.model.on("sync",function(e){return function(){return e.set_bookmarked()}}(this)),this.model.on("destroy",function(e){return function(){return e.model.unset("id"),e.set_unbookmarked()}}(this))},n.prototype.build_model=function(e){var t,n,i,r;return t=this.$el.data("academia-share"),n=this.$el.parents(".work_share_container").data("reshare-of"),i=(null!=e?e.source:void 0)||this.$el.data("share-source"),r=(null!=e?e.source_details:void 0)||this.$el.data("share-source-details"),null==r&&this.$el.data("share-source-details-news-story-verb")&&(r={story_verb:this.$el.data("share-source-details-news-story-verb")}),AcademiaSharing.Bookmark.for_target_arx(t,{share_id:n,source:i,source_details:r})},n.prototype.handle_bookmark_click=function(){return this.model.id?this.handle_remove():this.handle_save()},n.prototype.handle_remove=function(){return $w.confirm("Bookmark exists. Remove it?",{nextTo:this.$el},function(e){return function(){return e.model.destroy()}}(this))},n.prototype.handle_save=function(){return this.model.save({message:""},{success:function(e){return function(){var t;return t=new AcademiaSharing.SuccessNoticeView({model:e.model,link_settings_on_undo:!1}),t.show(!1)}}(this)})},n.prototype.set_bookmarked=function(){return this.$el.addClass("after_success").find('*[data-content="button_text"]').text("Bookmarked")},n.prototype.set_unbookmarked=function(){return this.$el.removeClass("after_success").find('*[data-content="button_text"]').text("Bookmark")},n}(Academia.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;AcademiaSharing.SuccessNoticeView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.jstTemplate="core/sitewide_business_elements/bookmarks/templates/success_notice",n.prototype.elements={banner:".top_banner_flash",close:".close",undo:".action",message:".message"},n.prototype.events={"click %close":"handle_close","click %undo":"handle_undo"},n.prototype.handle_close=function(){return this.$el.remove(),this.trigger("close")},n.prototype.handle_undo=function(){return this.$els.undo.remove(),this.cancel_fadeout(),this.model.destroy({success:function(e){return function(){return e.display_undo_success()}}(this)})},n.prototype.show=function(e){return null==e&&(e=!0),$("#site").before(this.$el.html(JST[this.jstTemplate]({isDownload:e}))),this._find_elements(),this.fadeout_after_delay()},n.prototype.fadeout_after_delay=function(e){return null==e&&(e=5e3),this.scheduledFade=setTimeout(function(e){return function(){return e.$el.fadeOut({complete:function(){return e.trigger("close")}})}}(this),e)},n.prototype.cancel_fadeout=function(){return null!=this.scheduledFade&&clearTimeout(this.scheduledFade),this.$el.stop()},n.prototype.display_undo_success=function(){return this.options.link_settings_on_undo?(this.$el.html(JST["core/sitewide_business_elements/bookmarks/templates/settings_link"]),this.fadeout_after_delay(15e3)):(this.$els.banner.removeClass("blue").addClass("orange"),this.$els.message.html("Bookmark removed"),this.fadeout_after_delay())},n}(Academia.View)}.call(this),function(){var e,t;(e=this.c).Documents||(e.Documents={}),(t=this.c.Documents).Download||(t.Download={})}.call(this),function(){this.c.Documents.AutoBookmark=function(){function e(){}return e.trigger=function(t,n,i){var r,o,a,s;return r=new AcademiaSharing.Bookmark({content_type:"Work",content_id:n.asset_id,source:"download",share_id:t.parents(".work_share_container").data("reshare-of"),from_download_at:i}),e._bind_buttons_to_bookmark(r),o=$.Deferred(),r.fetch({error:function(e,t){return 404===t.status?e.save({},{success:function(e){return o.resolve(e)},error:function(){return o.reject()}}):o.reject()},success:function(e){return o.resolve(e)}}),s=new AcademiaSharing.UndoTracker,r.on("destroy",function(){return s.increment()}),a=function(e){return o.done(function(t){return t.destroy({success:function(){return e()}})}).fail(function(){return e()})},{undo_bookmark:a,link_settings_on_undo:s.consecutive_undos>=2}},e._bind_buttons_to_bookmark=function(e){return $("*[data-academia-share='"+e.target_arx()+"']").each(function(){return new AcademiaSharing.BookmarkButtonView({el:$(this),model:e})})},e}()}.call(this),function(){var e="CREATED",t="UNDOING",n="UNDONE",i=5e3,r=15e3;Aedu.Documents.AutoBookmarkPanel=React.createClass({displayName:"AutoBookmarkPanel",propTypes:{undoBookmark:React.PropTypes.func.isRequired,linkSettingsOnUndo:React.PropTypes.bool,onDone:React.PropTypes.func.isRequired},getInitialState:function(){return{bookmarkState:e}},componentDidMount:function(){this.setDoneTimeout(i)},componentWillUnmount:function(){this.clearDoneTimeout()},clearDoneTimeout:function(){this.doneTimeout&&window.clearTimeout(this.doneTimeout)},setDoneTimeout:function(e){this.state.bookmarkState!==t&&(this.clearDoneTimeout(),this.doneTimeout=window.setTimeout(this.props.onDone,e))},undoBookmark:function(){this.clearDoneTimeout(),this.setState({bookmarkState:t}),this.props.undoBookmark(function(){this.setState({bookmarkState:n}),this.setDoneTimeout(r)}.bind(this))},renderText:function(){return this.state.bookmarkState===e||this.state.bookmarkState===t?React.createElement("span",null,"Added to your"," ",React.createElement("a",{href:"/Bookmarks",style:{color:"inherit"},className:"u-textDecorationUnderline"},"public bookmarks")):this.state.bookmarkState===n?React.createElement("span",null,"Bookmark removed"):void 0},renderAction:function(){return this.state.bookmarkState===e?React.createElement("span",{onClick:this.undoBookmark,className:"u-clickable"},"Undo"):this.state.bookmarkState===t?React.createElement("span",null,"Undoing..."):this.state.bookmarkState===n&&this.props.linkSettingsOnUndo?React.createElement("a",{href:"/settings#privacy-settings",style:{color:"inherit"}},"Privacy Settings"):void 0},render:function(){return React.createElement("div",{onMouseEnter:this.clearDoneTimeout,onMouseLeave:_.partial(this.setDoneTimeout,i)},React.createElement("span",{className:"u-tcGrayDark"},React.createElement("i",{className:"fa fa-bookmark u-tcBlue u-mr2x"}),this.renderText()),React.createElement("span",{className:"u-floatRight u-tcGray"},this.renderAction()))}})}(),function(){var e;e=new Date,this.c.Documents.DownloadButton=function(){function t(e){this.$el=$(e),this.data=this.$el.data("download"),this.postDownloadPopoverData=this.$el.data("postDownload"),this.sutdPopover=new c.Documents.DownloadPopover(this.data)}return t.prototype.handleClick=function(e){var t,n,i,r;if(this.addTrackingTokenToHref(new Date(e.timeStamp)),this.sutdPopover.should_show())e.preventDefault(),this.sutdPopover.show();else if("undefined"!=typeof $current_user&&null!==$current_user&&(this.styleAsDownloaded(),r=this.postDownloadPopoverData&&!_.contains(_.pluck(this.postDownloadPopoverData.authors,"id"),$current_user.id)&&!this.postDownloadPopoverData.canned_reader_message_exists&&!this.nonWork()))return i=$current_user.preferences.public_bookmarks&&!this.postDownloadPopoverData.bookmark_exists,i&&(t=c.Documents.AutoBookmark.trigger(this.$el,this.data,new Date(e.timeStamp))),n=Aedu.User.viewed&&_.contains(_.pluck(this.postDownloadPopoverData.authors,"id"),Aedu.User.viewed.id)?Aedu.User.viewed:this.postDownloadPopoverData.owner,new Aedu.Documents.PostDownloadPopover({$downloadButton:this.$el,work:this.postDownloadPopoverData.work,attachmentId:this.postDownloadPopoverData.attachment_id,authors:this.postDownloadPopoverData.authors,primaryAuthor:n,readerMessageSource:this.data.button_location,shouldShowAutoBookmarkPopover:i,undoBookmark:null!=t?t.undo_bookmark:void 0,linkSettingsOnUndoBookmark:null!=t?t.link_settings_on_undo:void 0}).show()},t.prototype.nonWork=function(){return null!=this.data.asset_type&&"Work"!==this.data.asset_type},t.prototype.styleAsDownloaded=function(){return this.$el.addClass("after_success").find('*[data-content="button_text"]').text("Downloaded")},t.prototype.addTrackingTokenToHref=function(e){var t;return t=this.$el.attr("href"),t?this.$el.attr("href",this.addTrackingTokenToUrl(t,e)):void 0},t.prototype.addTrackingTokenToUrl=function(e,t){var n,i,r,o;return r=$a.decompose_url(e),o=r[0],i=r[1],n=r[2],_(i).any(function(e){return"ct"===e[0]})||i.push(["ct",this.generateTrackingToken(t)]),_(i).any(function(e){return"s"===e[0]})||i.push(["s",this.data.button_location]),$a.build_url(o,i,n)},t.prototype.generateTrackingToken=function(t){var n;return n=[Math.round(e.getTime()/1e3),Math.round(t.getTime()/1e3)],"undefined"!=typeof $current_user&&null!==$current_user&&n.push($current_user.id),window.btoa(n.join(","))},t}(),$(document).on("click","*[data-download]",function(e){return new c.Documents.DownloadButton(e.currentTarget).handleClick(e)})}.call(this),function(){this.c.Documents.DownloadPopover=function(){function e(e){this.options=e,(null==this.options.track||this.options.track)&&(this.tracker=new c.Documents.DownloadTracker(this.options))}return e.prototype.should_show=function(){return!("undefined"!=typeof $current_user&&null!==$current_user||this.options.always_allow_download||$a.is_mobile()||this.constructor._popover_disabled)},e.prototype.show=function(){var e;return null!=(e=this.tracker)&&e.opened_popover(),this._create_boxy()},e.prototype._show_signup_modal=function(){return UserSource.remember("download"),SessionModal.pubSub.trigger("signup:show")},e.prototype._create_boxy=function(){return this.boxy&&this.boxy.hide_all(),this.boxy=$w.boxover({iframe:this._build_url(),title:"You must be logged in to download",top:"100px",width:"512px",height:"280px",classes:"SignupWall--iframe-container",onclose:function(e){return function(){var t;return null!=(t=e.tracker)?t.closed_popover():void 0}}(this)})},e.prototype._build_url=function(){var e,t;return e="//"+$app_host+"/signup_wall",t=[],this.options.redirect_to&&t.push(["post_login_redirect_path",encodeURIComponent(this.options.redirect_to)]),t.push(["a_id",this.options.attachment_id]),t.push(["boxy","iframe"]),t.push(["user_source","download"]),this.options.button_location&&t.push(["button_location",this.options.button_location]),$a.build_url(e,t)},e.set_feature_flags=function(){return this._popover_disabled=jQuery.cookie("ab_test_june_2012_5"),null!=this._popover_disabled&&(this._popover_disabled="true"===this._popover_disabled),null==this._popover_disabled?jQuery.ajax({url:$r.api_v0_feature_flags_path({subdomain_param:"api"}),dataType:"json",success:function(e){return function(t){var n;return e._popover_disabled=t.ab_test_june_2012_5,jQuery.cookie("ab_test_june_2012_5",null!=(n=t.ab_test_june_2012_5)?n:!1,{domain:$domain,path:"/",expires:365})}}(this)}):void 0},e}(),c.Documents.DownloadPopover.set_feature_flags()}.call(this),function(){this.c.Documents.DownloadTracker=function(){function e(e){this.notifier=new c.Server.Notification("sutd"),this.options=e}return e.prototype.opened_popover=function(){return $(window).on("unload.sutd",function(e){return function(){return e.closed_window()}}(this)),this.notifier.notify({event_type:"download",location:this.options.button_location,auvid:$auvid,attachment_id:this.options.attachment_id,work_id:"Work"===this.options.asset_type?this.options.asset_id:void 0})},e.prototype.closed_popover=function(){return $(window).off("unload.sutd"),this.notifier.notify({event_type:"download_closed",auvid:$auvid})},e.prototype.closed_window=function(){return this.notifier.notify({event_type:"unload",auvid:$auvid})},e}()}.call(this),function(){var e=function(e){this.$downloadButton=e.$downloadButton,this.work=e.work,this.attachmentId=e.attachmentId,this.authors=e.authors,this.primaryAuthor=e.primaryAuthor,this.readerMessageSource=e.readerMessageSource,this.shouldShowAutoBookmarkPopover=e.shouldShowAutoBookmarkPopover,this.undoBookmark=e.undoBookmark,this.linkSettingsOnUndo=e.linkSettingsOnUndo,this.id=_.uniqueId()};e.prototype.clickListener=function(e){var t=$(e.target).closest(this.$getEl()).length>0,n=$(e.target).closest(".js-top-banner-flash").length>0;t||n||this.hide()},e.prototype.show=function(){this.$downloadButton.popover("destroy");var e=this.$downloadButton.closest(".js-post-download-popover-container");0===e.length&&(e=$("body")),this.$downloadButton.popover({trigger:"manual",template:JST["core/sitewide_business_elements/download/templates/post_download_popover"]({id:this.id,contentWidth:Aedu.Documents.ReaderMessagePanel.width}),content:" ",container:e,placement:"bottom"}),this.$downloadButton.popover("show"),this.listenForClicks(),ReactDOM.render(React.createElement(Aedu.Documents.ReaderMessagePanel,{workId:this.work.id,workNoun:_.findWhere(Works.SECTIONS,{doc_type:this.work.document_type||"other"}).noun,attachmentId:this.attachmentId,onDone:this.hide.bind(this),onTransition:this.hideBottom.bind(this,!1),authorFirstName:this.primaryAuthor.first_name,authorCount:this.authors.length,readerMessageSource:this.readerMessageSource}),this.$getTopContent()[0]),this.shouldShowAutoBookmarkPopover&&(this.$getBottomPopover().show(),ReactDOM.render(React.createElement(Aedu.Documents.AutoBookmarkPanel,{undoBookmark:this.undoBookmark,linkSettingsOnUndo:this.linkSettingsOnUndoBookmark,onDone:this.hideBottom.bind(this,!0)}),this.$getBottomContent()[0]))},e.prototype.hide=function(){this.dontListenForClicks(),this.$downloadButton.popover("hide")},e.prototype.hideBottom=function(e){e?this.$getBottomPopover().fadeOut():this.$getBottomPopover().hide()},e.prototype.listenForClicks=function(){$("body").on("click"+this.getEventNamespace(),this.clickListener.bind(this))},e.prototype.dontListenForClicks=function(){$("body").off(this.getEventNamespace())},e.prototype.getEventNamespace=function(){return".post_download_popover_"+this.id},e.prototype.$getEl=function(){return $("[data-post-download-popover-id="+this.id+"]")},e.prototype.$getTopContent=function(){return this.$getEl().find(".js-top-content")},e.prototype.$getBottomContent=function(){return this.$getEl().find(".js-bottom-content")},e.prototype.$getBottomPopover=function(){return this.$getEl().find(".js-bottom-popover")},Aedu.Documents.PostDownloadPopover=e}(),function(){var e="COMPOSE",t="SENDING",n="SENT",i=React.createClass({displayName:"HoverIgnoreDetector",propTypes:{duration:React.PropTypes.number.isRequired,onIgnore:React.PropTypes.func.isRequired},clearTimeout:function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)},setTimeout:function(){this.clearTimeout(),this.timeout=window.setTimeout(this.props.onIgnore,this.props.duration)},componentWillUnmount:function(){this.clearTimeout()},componentWillMount:function(){this.setTimeout()},render:function(){return React.createElement("div",{onMouseEnter:this.clearTimeout,onMouseLeave:this.setTimeout},this.props.children)}});Aedu.Documents.ReaderMessagePanel=React.createClass({displayName:"ReaderMessagePanel",propTypes:{readerMessageSource:React.PropTypes.string.isRequired,workId:React.PropTypes.number.isRequired,workNoun:React.PropTypes.string,attachmentId:React.PropTypes.number.isRequired,authorFirstName:React.PropTypes.string.isRequired,authorCount:React.PropTypes.number.isRequired,onDone:React.PropTypes.func.isRequired,onTransition:React.PropTypes.func.isRequired},getInitialState:function(){return{step:e,messageBody:""}},kaleNotify:function(e,t){var n=_.extend({event:e,work_id:this.props.workId,attachment_id:this.props.attachmentId},t);Kale.notify({collectionName:"logged_in_post_download",eventData:n})},componentDidMount:function(){this.kaleNotify("popover-shown")},submitReaderMessage:function(){this.setState({step:t,error:null}),$.ajax({type:"POST",url:$r.api_v0_reader_messages_path({subdomain_param:"api"}),data:{work_id:this.props.workId,attachment_id:this.props.attachmentId,message:this.state.messageBody,source:this.props.readerMessageSource}}).done(function(t){t.success?this.messageSent():this.setState({step:e,error:"Sending failed"})}.bind(this)).fail(function(){this.setState({step:e,error:"Sending failed"})}.bind(this)),this.kaleNotify("reader-message-submitted",{})},messageSent:function(){this.setState({step:n}),this.props.onTransition()},andTheirCoauthors:function(){return 1===this.props.authorCount?"":2===this.props.authorCount?"and their coauthor":"and their "+$h.numberWord(this.props.authorCount-1)+" coauthors"},onMessageBodyChange:function(e){this.setState({messageBody:e.target.value})},render:function(){return this.state.step===e||this.state.step===t?React.createElement("div",null,React.createElement("div",{className:"u-taCenter u-fs14 u-fw500 u-mt3x u-mb5x"},"Let ",this.props.authorFirstName," ",this.andTheirCoauthors()," know why you downloaded this\xa0",(this.props.workNoun||"paper").replace(" ","\xa0"),": "),React.createElement("textarea",{value:this.state.messageBody,onChange:this.onMessageBodyChange,disabled:this.state.step===t,className:"TextArea u-mb4x",placeholder:"What sparked your interest in this paper?",ref:function(e){null!=e&&e.focus()}}),React.createElement("div",{className:"u-tcRed"},this.state.error),React.createElement("button",{onClick:this.submitReaderMessage,className:"Button Button--sm u-floatRight",disabled:""===this.state.messageBody||this.state.step===t},this.state.step===t?"SENDING":"SEND")):this.state.step===n?React.createElement(i,{onIgnore:this.props.onDone,duration:2500},React.createElement("div",{className:"u-taCenter u-fs14 u-fw500 u-mv5x"},"Sent! ",React.createElement("a",{href:$r.threads_url()},"View messages"))):void 0}}),Aedu.Documents.ReaderMessagePanel.width="320px"}(),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/download/templates/post_download_popover"]=function(e){var t=[],n=e||{};
return function(e,n){t.push('<div role="tooltip"'+jade.attr("data-post-download-popover-id",n,!0,!1)+' style="max-width: none;margin-top: 14px;" class="js-post-download-popover popover u-bgColorGrayLightest"><div class="arrow popover-bottom-arrow-gray-lightest"></div><h3 class="popover-title"></h3><div'+jade.attr("style","width: "+e+";",!0,!1)+' class="js-top-content popover-content DesignSystem u-p4x"></div><div style="position: relative;"><div style="top: 10px;left: -1px;max-width: none;" class="js-bottom-popover looks-like-popover u-positionAbsolute u-bgColorGrayLightest"><div'+jade.attr("style","width: "+e+";",!0,!1)+' class="js-bottom-content looks-like-popover-content DesignSystem u-p4x"></div></div></div></div>')}.call(this,"contentWidth"in n?n.contentWidth:"undefined"!=typeof contentWidth?contentWidth:void 0,"id"in n?n.id:"undefined"!=typeof id?id:void 0),t.join("")}}.call(this),function(){var e,t,n,i;n=function(e,t,n){return $(document).ready(function(){var i;return null!=t&&(i=$(t)),e.fadeOut("fast",function(){return e.hasClass("js-display-inline-block")?null!=i?i.fadeIn("fast").css("display","inline-block"):void 0:(null!=i&&i.removeClass("hidden"),null!=i?i.fadeIn("fast"):void 0)}),n.fail(function(t){return e.stop(!0,!0),null!=i&&i.stop(!0,!0),e.show(),null!=i&&i.hide(),t.responseText?$w.flash(t.responseText,{nextTo:e,visibleMS:2e3}):void 0})})},i=function(e,t,n){var i,r;return r="follow"===n?{original:"data-follow-user-id",opposite:"data-unfollow-user-id"}:{original:"data-unfollow-user-id",opposite:"data-follow-user-id"},i=_.reject($("["+r.original+"='"+t+"']"),function(){return function(t){return t===e[0]}}(this)),_.each(i,function(){return function(e){var n,i;return i=$(e),n=i.siblings("["+r.opposite+"='"+t+"']").first(),i.addClass("hidden"),n.removeClass("hidden").show()}}(this))},$(document).on("click","*[data-follow-user-id]",function(e){var t,r,o,a;return e.preventDefault(),t=$(e.currentTarget),a=t.data("follow-user-id"),o=t.siblings("[data-unfollow-user-id]")[0],$a.is_logged_in()?(r=Follow.followUser(a,t.data("follow-user-source"),t.data("follow-user-src-details")),n(t,o,r),r.done(function(){return function(){return i(t,a,"follow")}}(this))):void Follow.showSignupToFollow(a,t.data("follow-user-fname"))}),$(document).on("click","*[data-unfollow-user-id]",function(e){var t,r,o,a;if($a.is_logged_in())return e.preventDefault(),t=$(e.currentTarget),a=t.data("unfollow-user-id"),r=t.siblings("[data-follow-user-id]")[0],o=Follow.unfollowUser(a),n(t,r,o),o.done(function(){return function(){return i(t,a,"unfollow")}}(this))}),$(document).on("click","*[data-block-user-id]",function(e){var t,n;if($a.is_logged_in())return t=$(e.currentTarget),n=t.data("block-user-id"),Follow.blockUser(n).done(function(){return window.location.reload()})}),$(document).on("click","*[data-unblock-user-id]",function(e){var t,i,r;if($a.is_logged_in())return t=$(e.currentTarget),r=t.data("unblock-user-id"),i=Follow.unblockUser(r),n(t,"*[data-follow-user-id="+r+"], *[data-block-user-id="+r+"]",i)}),$(document).ready(function(){$a.is_logged_in()||$("*[data-follow-user-id]").removeClass("hidden")}),$a.is_logged_in()&&(e=Aedu.User.current,t=function(e){return e.removeClass("hidden"),e.removeClass("btn-hidden")},$a.each_current_and_future("*[data-follow-user-id].hidden, *[data-follow-user-id].btn-hidden",function(n){var i;return i=n.data("follow-user-id"),i===e.id||e.follows(i)?void 0:t(n)}),$a.each_current_and_future("*[data-unfollow-user-id].hidden, *[data-unfollow-user-id].btn-hidden",function(n){var i;return i=n.data("unfollow-user-id"),i!==e.id&&e.follows(i)?t(n):void 0}),$a.is_owner()&&$a.each_current_and_future("*[data-block-user-id].hidden, *[data-block-user-id].btn-hidden",function(n){var i;return i=n.data("block-user-id"),i===e.id||e.follows(i)?void 0:t(n)}),$a.each_current_and_future("*[data-follow-ri-id].hidden, *[data-follow-ri-id].btn-hidden",function(n){var i;return i=n.data("follow-ri-id"),e.has_interest(i)?void 0:t(n)}),$a.each_current_and_future("*[data-unfollow-ri-id].hidden, *[data-unfollow-ri-id].btn-hidden",function(n){var i;return i=n.data("unfollow-ri-id"),e.has_interest(i)?t(n):void 0})),$(document).on("click","*[data-follow-ri-id]",function(e){var t,i,r;return e.preventDefault(),t=$(e.currentTarget),r=t.data("follow-ri-id"),i=FollowRI.follow_ri(r),n(t,"*[data-unfollow-ri-id="+r+"]",i)}),$(document).on("click","*[data-unfollow-ri-id]",function(e){var t,i,r;if($a.is_logged_in())return e.preventDefault(),t=$(e.currentTarget),r=t.data("unfollow-ri-id"),i=FollowRI.unfollow_ri(r),n(t,"*[data-follow-ri-id="+r+"]",i)})}.call(this),function(){window.Academia||(window.Academia={}),window.Academia.openTwitterShareWindow=function(e,t,n){var i,r;return r="http://twitter.com/intent/tweet?text="+encodeURIComponent(e),null!=t&&t.length>0&&(r=r+"&url="+encodeURIComponent(t)),null!=n&&n.length>0&&(r=r+"&via="+encodeURIComponent(n)),i="toolbar=0,scrollbars=1,resizable=1,width=600,height=400",window.open(r,"",i)}}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/modals/templates/confirm_modal"]=function(e){var t,n=[],i=e||{};return function(e,i,r,o,a){n.push('<div aria-hidden="true" class="confirm-modal modal fade"><div class="confirm-modal-dialog modal-dialog"><div class="modal-content"><div class="confirm-modal-body modal-body"><button data-dismiss="modal" class="close confirm-modal-close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="text-center"><strong>'+jade.escape(null==(t=o)?"":t)+"</strong></h4>"),a&&n.push('<p class="text-dark">'+jade.escape(null==(t=a)?"":t)+"</p><br/>"),n.push('<div class="row"><div class="col-xs-6"><button data-dismiss="modal" class="js-confirm-modal-cancel-button btn btn-muted btn-lg btn-block">'+jade.escape(null==(t=e)?"":t)+'</button></div><div class="col-xs-6"><button'+jade.cls(["js-confirm-modal-confirm-button","btn","btn-lg","btn-block",i],[null,null,null,null,!0])+">"+jade.escape(null==(t=r)?"":t)+"</button></div></div></div></div></div></div>")}.call(this,"cancelButtonText"in i?i.cancelButtonText:"undefined"!=typeof cancelButtonText?cancelButtonText:void 0,"confirmButtonClasses"in i?i.confirmButtonClasses:"undefined"!=typeof confirmButtonClasses?confirmButtonClasses:void 0,"confirmButtonText"in i?i.confirmButtonText:"undefined"!=typeof confirmButtonText?confirmButtonText:void 0,"mainText"in i?i.mainText:"undefined"!=typeof mainText?mainText:void 0,"subText"in i?i.subText:"undefined"!=typeof subText?subText:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.ConfirmModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="core/sitewide_business_elements/modals/templates/confirm_modal",n.prototype.events={"click .js-confirm-modal-confirm-button":"_confirmClicked","click .js-confirm-modal-cancel-button":"_cancelClicked"},n.prototype.initialize=function(e){return this.options=e,this.successCallback=this.options.successCallback,this.render(),this.$el.appendTo("body"),this.ui={$modal:this.$(".confirm-modal")},this.ui.$modal.on("hidden.bs.modal",function(e){return function(){return e.remove()}}(this)).modal("show"),this},n.prototype.render=function(){return this.$el.append(JST[this.template](this.viewOptions())),this},n.prototype._confirmClicked=function(){return this.ui.$modal.modal("hide"),"function"==typeof this.successCallback&&this.successCallback(),this.trigger("confirm")},n.prototype._cancelClicked=function(){return this.trigger("cancel")},n.prototype.remove=function(){return this.trigger("close"),n.__super__.remove.call(this)},n.prototype.viewOptions=function(){var e,t;return t=_(this.options).pick(["successCallback","mainText","subText","cancelButtonText","confirmButtonText","confirmButtonClasses"]),e={confirmButtonClasses:"btn-danger"},_(e).extend(t)},n}(Backbone.View)}.call(this),Aedu.NagApi={showIfAppropriate:function(e,t){var n=$r.api_v0_user_nag_path({user_id:Aedu.User.current.id,id:e,subdomain_param:"api"});return $.get(n).done(function(e){e.show&&t&&t()})},recordShow:function(e){var t=$r.record_show_api_v0_user_nags_path({user_id:Aedu.User.current.id,id:e,subdomain_param:"api"});return $.post(t)}},function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.AutocompleteSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={submit:"preventDefault","select2-open":"addOpenStyles","select2-close":"removeOpenStyles"},n.prototype.initialize=function(){return this.ui={$input:this.$(".js-nav-search-input")},this.initializeSelect2(),this.ui.$input.focus(function(e){return function(){return e.showPrompt()}}(this))},n.prototype.initializeSelect2=function(){return this.ui.$input.select2({useExistingInput:!0,closeOnSelect:!0,minimumInputLength:3,matcher:function(){return!0},delay:100,dropdownCssClass:"js-nav-search-results nav-search-results bootstrap",formatResult:function(e){return function(t){return e.formatResult(t)}}(this),formatSelection:function(e){return function(t){return e.redirectToResult(t)}}(this),formatNoMatches:function(e){return function(){return e.formatNoMatches()}}(this),formatInputTooShort:function(e){return function(){return e.formatPrompt()}}(this),formatSearching:function(e){return function(){return e.formatSearching()}}(this),ajax:{url:"/ac_search",dataType:"json",quietMillis:100,data:function(e){return{q:e,limit:20}},results:function(e){return e}}})},n.prototype.addOpenStyles=function(){return this.$el.addClass("nav-search-open"),this.addDropdownArrow(),this.determineResultsHeight()},n.prototype.removeOpenStyles=function(){return this.$el.removeClass("nav-search-open"),this.removeDropdownArrow()},n.prototype.redirectToResult=function(e){return $a.track_single_request({typeahead_hit:!0}),window.location.href=e.entity_url},n.prototype.formatResult=function(e){return this.addViewAllButton(),JST["core/sitewide_business_elements/navbar/templates/search_result"]({result:e})},n.prototype.formatPrompt=function(){return $a.is_logged_in()&&Aedu.User.current.has_rollout_feature("can_become_premium")&&!Aedu.User.current.premium?(this.formatStatusMessage(),"<div class='DesignSystem text-center'> <div class='u-p8x'> Type to search for People, Research Interests and&nbsp;Universities </div> </div>"):this.formatStatusMessage("Type to search for People, Research Interests and Universities")},n.prototype.formatNoMatches=function(){return this.formatStatusMessage('<i class="fa fa-warning"></i>&nbsp;&nbsp;No matches found')},n.prototype.formatSearching=function(){return this.formatStatusMessage('<i class="fa fa-spinner fa-spin"></i>&nbsp;&nbsp;Searching...')},n.prototype.formatStatusMessage=function(e){return this.removeViewAllButton(),this.determineResultsHeight(),"<div class='text-center padding-8x'>"+e+"</div>"},n.prototype.preventDefault=function(e){return e.isTrigger?void 0:e.preventDefault()},n.prototype.showPrompt=function(){return this.ui.$input.select2("open")},n.prototype.addDropdownArrow=function(){return $(".js-nav-search-results").append('<div class="js-top-search-dropdown-arrow DropdownArrow"></div>')},n.prototype.removeDropdownArrow=function(){return $(".js-top-search-dropdown-arrow.DropdownArrow").remove()},n.prototype.addViewAllButton=function(){var e;return e=$(".js-nav-search-results"),e.find(".js-nav-search-view-all").length>0?void 0:(e.append('<div><a class="ViewAllResults btn padding-vertical-3x btn-block text-uppercase js-nav-search-view-all">View All Results</a></div>'),e.find(".js-nav-search-view-all").click(function(e){return function(t){return $(t.currentTarget).html('<i class="fa fa-spinner fa-spin"></i>'),e.$el.submit()}}(this)))},n.prototype.determineResultsHeight=function(){var e;return e=$(".select2-results"),1===e.find(".select2-no-results").length?e.css("max-height","none"):e.css("max-height","200px")},n.prototype.removeViewAllButton=function(){return $(".js-nav-search-view-all").parent().remove()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.NavigationController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .js-main-nav-my-account-link":"toggleMyAccountMenu","mouseenter #default-position-button":"hideAll"},n.prototype.initialize=function(e){return null==e&&(e={}),this.showHighlightedNotification=e.showHighlightedNotification,$(function(e){return function(){return e.render()}}(this))},n.prototype.render=function(){return this.ui={$myAccountLink:this.$(".js-main-nav-my-account-link"),$myAccountMenu:this.$(".js-main-nav-my-account-menu"),$notificationsLink:this.$(".js-main-nav-notifications-link-container"),$discussionsMenu:this.$(".js-main-nav-discussions-dropdown-trigger")},this.closeDropdownsOnEscape(),this.initializeMyAccountHover(),this.notificationContainerView=new Aedu.NotificationContainerView({el:this.ui.$notificationsLink,showHighlightedNotification:this.showHighlightedNotification}),this.listenTo(this.notificationContainerView,"closeNavDropdowns",this.hideAll)},n.prototype.closeDropdownsOnEscape=function(){return $(document).keydown(function(e){return function(t){return 27===t.keyCode?e.hideAll():void 0}}(this))},n.prototype.initializeMyAccountHover=function(){var e,t,n;if(!$a.is_mobile())return n=this.ui,e=n.$myAccountLink,t=n.$myAccountMenu,_.each([e,t],function(n){return function(i){return i.hover(function(){return t.data("hovered",!0),e.hasClass("account_open")?void 0:(n.hideAll(),t.fadeIn(200),e.addClass("account_open"))},function(){return t.data("hovered",!1),_.delay(function(){return t.data("hovered")?void 0:(t.fadeOut(200),e.removeClass("account_open"))},1e3)})}}(this))},n.prototype.toggleMyAccountMenu=function(e){return e.preventDefault(),$a.is_mobile()?this.ui.$myAccountMenu.toggle():void 0},n.prototype.hideAll=function(){return this.ui.$myAccountMenu.hide(),this.ui.$discussionsMenu.parent().removeClass("open"),this.ui.$myAccountLink.removeClass("account_open"),this.notificationContainerView.trigger("closeNotificationDropdown")},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.NotificationContainerView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .js-main-nav-notifications-link":"toggleNotificationsDropdown","click .js-main-nav-notifications-count":"toggleNotificationsDropdown"},n.prototype.initialize=function(e){return this.showHighlightedNotification=e.showHighlightedNotification,this.notificationsDropdownShown=!1,this.render(),this.addSourceToInternalClicks()},n.prototype.render=function(){return this.ui={$notificationsDropdown:this.$(".js-main-nav-notifications-container"),$notificationsContent:this.$(".js-main-nav-notifications-content"),$notificationsCounter:this.$(".js-main-nav-notifications-count"),$notificationsLink:this.$(".js-main-nav-notifications-link")},this.on("closeNotificationDropdown",this.closeDropdown),this.showUnreadNotificationCount()},n.prototype.showUnreadNotificationCount=function(){return $.get($r.unread_count_api_v0_notifications_path({subdomain_param:"api"})).done(function(e){return function(t){var n;return n=t.count,e.ui.$notificationsCounter.text(e.formatCount(n)),e.addNotificationCountToPageTitle(n),e.showHighlightedNotification?e.ui.$notificationsLink.click():void 0}}(this))},n.prototype.formatCount=function(e){return 0===e?"":e>99?"99+":e.toString()},n.prototype.toggleNotificationsDropdown=function(e){return e.preventDefault(),e.stopPropagation(),this.alreadySeen?this.markNotificationsRead():this.alreadySeen=!0,this.showHighlightedNotification?this.showHighlightedNotification=!1:this.notificationsAlreadyInitialized||(this.populateNotificationContent(),this.notificationsAlreadyInitialized=!0),this.resetUnreadNotificationCount(),this.notificationsDropdownShown?this.closeDropdown():(this.trigger("closeNavDropdowns"),this.ui.$notificationsDropdown.fadeIn(200),$("body").on("click.notificationDropdown",function(e){return function(t){return e.clickIsInsideNotificationsDropdown(t)?void 0:e.closeDropdown()}}(this)),this.notificationsDropdownShown=!0)},n.prototype.resetUnreadNotificationCount=function(){return this.ui.$notificationsCounter.html(""),this.removeNotificationsCountFromPageTitle()},n.prototype.markNotificationsRead=function(){return this.ui.$notificationsDropdown.find(".js-notification-popover").addClass("notification-popover-message-is-read").removeClass("notification-popover-message-is-unread")},n.prototype.closeDropdown=function(){return $("body").off("click.notificationDropdown"),this.ui.$notificationsDropdown.hide(),this.notificationsDropdownShown=!1},n.prototype.clickIsInsideNotificationsDropdown=function(e){return $(e.target).closest(".drop_notifications").length>0},n.prototype.addNotificationCountToPageTitle=function(e){return e>0?document.title="("+e+") "+document.title:void 0},n.prototype.removeNotificationsCountFromPageTitle=function(){return document.title=document.title.replace(/^\(\d+\)\s+/,"")},n.prototype.populateNotificationContent=function(){var e;return e=new Aedu.Notifications.Container,this.ui.$notificationsContent.html(e.$el)},n.prototype.addSourceToInternalClicks=function(){return $(".js-notification-popover").on("click","[data-notification-message-type]",function(e){var t;return t=$(e.currentTarget),$a.track_single_request_with_source("notification_popover",{notification_type:t.data("notification-message-type")})})},n}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/navbar/templates/search_result"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="media_v2 padding-vertical-1x"><div class="media-left media-middle text-center">'),e.image_url?n.push("<img"+jade.attr("src",e.image_url,!0,!1)+" onerror=\"if (this.src != '/images/tiny_no_pic.png') this.src = '/images/tiny_no_pic.png'\" class=\"avatar-md avatar-rectangle\"/>"):"ResearchInterest"==e.type?n.push('<div class="avatar-md avatar-rectangle valign-wrapper bg-gray-light"><i class="fa fa-tag valign-item text-white"></i></div>'):"University"==e.type&&n.push('<div class="avatar-md avatar-rectangle valign-wrapper bg-gray-light"><i class="fa fa-university valign-item text-white"></i></div>'),n.push('</div><div class="media-body media-middle"><h6 class="text-bold margin-top-0x margin-bottom-0x">'+jade.escape(null==(t=e.display_name)?"":t)+"</h6>"),e.description&&n.push('<small style="width:250px" class="text-gray text-slim text-truncate">'+jade.escape(null==(t=e.description)?"":t)+"</small>"),n.push("</div></div>")}.call(this,"result"in i?i.result:"undefined"!=typeof result?result:void 0),n.join("")}}.call(this),function(){var e=function(){$("#top_banner").is(":visible")&&$("body").css({"background-position":"0px 40px"})},t=function(){$("#top_panel").is(":visible")&&$("body").css({"background-position":"0px 78px"})};$(document).ready(function(){e(),t()})}(),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/research_interest_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i,r){n.push('<div class="clearfix"><div class="ri-card-main js-ri-card-main padding-top-4x padding-horizontal-4x clickable text-center"><a'+jade.attr("href",r.url,!0,!1)+' class="ri-card-name margin-top-3x margin-vertical-1x margin-bottom-1x">'+jade.escape(null==(t=r.name)?"":t)+"</a><div"+jade.attr("data-stats-for-ri",r.id,!0,!1)+' class="ri-card-stats margin-top-4x margin-bottom-3x row"><div class="col-xs-6 padding-vertical-2x ri-col"><strong data-stat="followers_count" class="ri-card-stat-num js-ri-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="ri-card-stat-label"> People</span></div><div class="col-xs-6 padding-vertical-2x ri-col"><strong data-stat="works_count" class="ri-card-stat-num js-ri-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="ri-card-stat-label"> Documents</span></div></div></div><div class="ri-card-actions text-center btn-toolbar">');var o=e.is_logged_in()&&i.User.current.has_interest(r.id);n.push("<a"+jade.attr("data-follow-ri-id",r.id,!0,!1)+' data-follow-ri-source="ri_card"'+jade.attr("style",o?"display: none":!1,!0,!1)+' class="btn btn-primary"><small><i class="fa fa-plus"></i>&nbsp;&nbsp;Follow</small></a><a'+jade.attr("data-unfollow-ri-id",r.id,!0,!1)+jade.attr("style",o?!1:"display: none",!0,!1)+' class="btn btn-primary"><small><i class="fa fa-check"></i>&nbsp;&nbsp;Following</small></a></div></div>')}.call(this,"$a"in i?i.$a:"undefined"!=typeof $a?$a:void 0,"Aedu"in i?i.Aedu:"undefined"!=typeof Aedu?Aedu:void 0,"ri"in i?i.ri:"undefined"!=typeof ri?ri:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;c.ResearchInterestCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._cardContainer(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._cardContent()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard ri-card")}()}),this.ri=null!=this.options.ri?new Aedu.ResearchInterest(this.options.ri):this._findResearchInterestFromContent(),null!=this.ri?(this._initClickable(),this.on_shown=this._showStats):void 0},n.prototype._findResearchInterestFromContent=function(){var e,t,n;return n=this.$el.data("has-card-for-ri"),t=$("*[data-card-contents-for-ri="+n+"]"),t&&(e=t.html())?this.ri=new Aedu.ResearchInterest(JSON.parse(e)):void 0},n.prototype._initClickable=function(){return this.$el.data("bs.popover").tip().on("click",".js-ri-card-main",function(e){return function(t){return t.metaKey||t.ctrlKey?void 0:window.location=e.ri.get("url")}}(this))},n.prototype._showStats=function(e){var t;return t=function(t){return function(n,i){var r;return r="*[data-stats-for-ri="+t.ri.id+"] .js-ri-card-stat-num[data-stat="+n+"]",e.find(r).text($h.commaizeInt(i))}}(this),this.ri.loadFollowersCount().done(function(e){return t("followers_count",e)}),this.ri.loadWorksCount().done(function(e){return"no_count"!==e?t("works_count",e):void 0})},n.prototype._cardContent=function(){return JST["core/sitewide_business_elements/research_interest_card/templates/card"]({ri:this.ri.toJSON()})},n.prototype._cardContainer=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n}(HoverPopover),$a.is_logged_in()&&$a.each_current_and_future("*[data-has-card-for-ri]",function(e){return new c.ResearchInterestCard({el:$(e)})})}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/research_interest_list_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="clearfix"><ul class="list-group ri-list-card-negative-margin">'),function(){var r=i;if("number"==typeof r.length)for(var o=0,a=r.length;a>o;o++){var s=r[o];if(n.push('<li class="list-group-item padding-top-1x"><div class="text-center btn-toolbar pull-right margin-top-4x ri-list-card-actions">'),e.User.current){var l=e.User.current&&e.User.current.has_interest(s.id);n.push("<a"+jade.attr("data-follow-ri-id",s.id,!0,!1)+' data-follow-ri-source="ri_list_card"'+jade.attr("style",l?"display: none":!1,!0,!1)+' class="btn btn-xs btn-primary"><small><div class="fa fa-plus"></div></small></a><a'+jade.attr("data-unfollow-ri-id",s.id,!0,!1)+jade.attr("style",l?!1:"display: none",!0,!1)+' class="btn btn-xs btn-success-clear"><small><i class="fa fa-check"></i></small></a>')}n.push("</div><span"+jade.attr("data-stats-for-ri",s.id,!0,!1)+"><a"+jade.attr("href",s.get("url"),!0,!1)+' class="margin-top-2x text-truncate link-unstyled h5 margin-bottom-0x padding-bottom-1x padding-right-5x">'+jade.escape(null==(t=s.get("name"))?"":t)+'</a><strong data-stat="followers_count" class="js-ri-card-stat-num ri-card-stat-label"><i class="fa fa-spinner fa-spin"></i></strong><span class="ri-card-stat-label"> People</span></span></li>')}else{var a=0;for(var o in r){a++;var s=r[o];if(n.push('<li class="list-group-item padding-top-1x"><div class="text-center btn-toolbar pull-right margin-top-4x ri-list-card-actions">'),e.User.current){var l=e.User.current&&e.User.current.has_interest(s.id);n.push("<a"+jade.attr("data-follow-ri-id",s.id,!0,!1)+' data-follow-ri-source="ri_list_card"'+jade.attr("style",l?"display: none":!1,!0,!1)+' class="btn btn-xs btn-primary"><small><div class="fa fa-plus"></div></small></a><a'+jade.attr("data-unfollow-ri-id",s.id,!0,!1)+jade.attr("style",l?!1:"display: none",!0,!1)+' class="btn btn-xs btn-success-clear"><small><i class="fa fa-check"></i></small></a>')}n.push("</div><span"+jade.attr("data-stats-for-ri",s.id,!0,!1)+"><a"+jade.attr("href",s.get("url"),!0,!1)+' class="margin-top-2x text-truncate link-unstyled h5 margin-bottom-0x padding-bottom-1x padding-right-5x">'+jade.escape(null==(t=s.get("name"))?"":t)+'</a><strong data-stat="followers_count" class="js-ri-card-stat-num ri-card-stat-label"><i class="fa fa-spinner fa-spin"></i></strong><span class="ri-card-stat-label"> People</span></span></li>')}}}.call(this),n.push("</ul></div>")}.call(this,"Aedu"in i?i.Aedu:"undefined"!=typeof Aedu?Aedu:void 0,"ris"in i?i.ris:"undefined"!=typeof ris?ris:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.ResearchInterestListCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._cardContainer(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._cardContent()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard ri-list-card")}()}),this.list=this._getResearchInterestListFromOptions(e),null!=this.list&&(this.on_shown=this._showStats),Aedu.Behaviors.ScrollScope.enable(this._popover_el().find(".popover-content"))},n.prototype._getResearchInterestListFromOptions=function(e){var t,n,i,r,o,a,s,l,u;if(u=this.$el.data("remove-ri"),l=[],null!=e.work.research_interests)for(o=e.work.research_interests,t=0,i=o.length;i>t;t++)s=o[t],s.id!==u&&l.push(new Aedu.ResearchInterest(s));else if(null!=e.work.interests)for(a=e.work.interests,n=0,r=a.length;r>n;n++)s=a[n],s.id!==u&&l.push(new Aedu.ResearchInterest(s));return null!=Aedu.User.current?_(l).sortBy(function(e){return!Aedu.User.current.has_interest(e.id)}):l},n.prototype._showStats=function(e){var t,n,i,r,o;for(i=this.list,r=[],t=0,n=i.length;n>t;t++)o=i[t],r.push(function(){var t;return t="*[data-stats-for-ri="+o.get("id")+"] .js-ri-card-stat-num[data-stat=followers_count]",o.loadFollowersCount().done(function(n){return e.find(t).text($h.commaizeInt(n))})}());return r},n.prototype._cardContent=function(){return JST["core/sitewide_business_elements/research_interest_list_card/templates/card"]({ris:this.list})},n.prototype._cardContainer=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n}(HoverPopover)}.call(this),function(){var e,t,n;window.confirmAccountEmail&&(n=Aedu.User.current,n.banned?n.requested_unflag?t="Your account was flagged as suspicious, and your reconsideration request is awaiting manual review. We're sorry for any inconvenience.":(t="Your account was flagged as suspicious by an automated system. If this was an error, please accept our apologies.",e={"Request Unflagging":function(){return document.location="/user_unflag_requests/new"}}):(t="Please confirm your account. We've sent a confirmation link to "+window.confirmAccountEmail,e={Resend:function(){return $.post("/confirm/send_new_email").done(function(){return document.location="/confirm/sent"})},"Change Email":function(){return document.location="/confirm/sent#email"}}),$(document).ready(function(){return new ConfirmationBanner.BelowNavView({mode:"warning",message:t,actions:e}).render()}))}.call(this),function(){this.JST||(this.JST={}),this.JST["core/sitewide_business_elements/user_card/templates/card"]=function(e){var t,n=[],i=e||{};return function(e,i,r,o){n.push('<div class="clearfix"><div class="user-card-main clickable text-center"><a'+jade.attr("href",r.url,!0,!1)+' class="user-card-photo"><img'+jade.attr("src",r.photo,!0,!1)+jade.attr("alt",r.display_name,!0,!1)+' class="circle s65"/></a><a'+jade.attr("href",r.url,!0,!1)+' class="user-card-name">'+jade.escape(null==(t=r.display_name)?"":t)+"</a>"),r.is_affiliated()&&r.department&&r.position?n.push('<div class="user-card-affiliation">'+jade.escape(null==(t=r.department.university.name+", "+r.department.name+", "+r.position)?"":t)+"</div>"):r.has_research_interests()&&n.push('<div class="user-card-affiliation">'+jade.escape(null==(t=o)?"":t)+"</div>"),n.push("<div"+jade.attr("data-stats-for-user",r.id,!0,!1)+' class="user-card-stats row"><div class="col-xs-4"><strong data-stat="followers_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Followers</span></div><div class="col-xs-4"><strong data-stat="works_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Documents</span></div><div class="col-xs-4"><strong data-stat="views_count" class="user-card-stat-num"><i class="fa fa-spinner fa-spin"></i></strong><br/><span class="user-card-stat-label"> Views</span></div></div></div><div class="user-card-actions text-center btn-toolbar"><a data-send-message="data-send-message"'+jade.attr("data-recipient-id",r.id,!0,!1)+' class="btn btn-muted logged_in_only"><small><i class="fa fa-envelope"></i>&nbsp;&nbsp;Message</small></a>');var a=e.is_logged_in()&&i.User.current.follows(r.id);n.push("<a"+jade.attr("data-follow-user-id",r.id,!0,!1)+' data-follow-user-source="user_card"'+jade.attr("data-follow-user-fname",r.first_name,!0,!1)+jade.attr("style",a?"display: none":!1,!0,!1)+' class="btn btn-primary"><small><i class="fa fa-plus"></i>&nbsp;&nbsp;Follow</small></a><a'+jade.attr("data-unfollow-user-id",r.id,!0,!1)+jade.attr("style",a?!1:"display: none",!0,!1)+' class="btn btn-primary"><small><i class="fa fa-check"></i>&nbsp;&nbsp;Following</small></a></div></div>')}.call(this,"$a"in i?i.$a:"undefined"!=typeof $a?$a:void 0,"Aedu"in i?i.Aedu:"undefined"!=typeof Aedu?Aedu:void 0,"profile"in i?i.profile:"undefined"!=typeof profile?profile:void 0,"research_interest_sentence"in i?i.research_interest_sentence:"undefined"!=typeof research_interest_sentence?research_interest_sentence:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.UserCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return n.__super__.initialize.call(this,{html:!0,placement:"bottom",container:this._card_container(),show_delay:400,hide_delay:250,content:function(e){return function(){return e._card_content()}}(this),template:function(){return $($.fn.popover.Constructor.DEFAULTS.template).addClass("popover-hovercard user-card")}()}),this.user=e.user||this._find_user_from_content(),null!=this.user?(this._init_clickable(),this.on_shown=this._show_stats,this._handle_message_click()):void 0},n.prototype._find_user_from_content=function(){var e,t,n;return n=this.$el.data("has-card-for-user"),t=$("*[data-card-contents-for-user="+n+"]"),t&&(e=t.html())?this.user=Aedu.User.from_json(e):void 0
},n.prototype._init_clickable=function(){return this.$el.data("bs.popover").tip().on("click",".user-card-main",function(e){return function(t){return t.metaKey||t.ctrlKey?void 0:window.location=e.user.url}}(this))},n.prototype._handle_message_click=function(){return this.$el.on("shown.bs.popover",function(e){return function(){var t;return t=e.$el.data("bs.popover").tip().find("*[data-send-message]"),t.data("message-view")||t.data("message-view",new Messages.ModalFormView(e.user.id)),t.data("message-view").on("shown",function(){return e.freeze()}),t.data("message-view").on("hidden",function(){return e.unfreeze()})}}(this))},n.prototype._show_stats=function(e){var t;return t=function(t){return function(n,i){var r;return r="*[data-stats-for-user="+t.user.id+"] .user-card-stat-num[data-stat="+n+"]",e.find(r).text($h.commaizeInt(i))}}(this),this.user.load_followers_count().done(function(){return function(e){return t("followers_count",e)}}(this)),this.user.load_works_count().done(function(){return function(e){return t("works_count",e)}}(this)),this.user.load_views_counts().done(function(){return function(e){return t("views_count",e.all_time_stats.documents_count+e.all_time_stats.non_documents_count)}}(this))},n.prototype._card_content=function(){return JST["core/sitewide_business_elements/user_card/templates/card"]({profile:this.user,research_interest_sentence:this._research_interest_sentence()})},n.prototype._card_container=function(){return this.$el.parent().is("div, li")&&this.$el.parents(".bootstrap").length?void 0:"#bootstrap-modal-container"},n.prototype._research_interest_sentence=function(e){var t,n,i,r;return null==e&&(e=2),this.user.has_research_interests()?(t=this.user.interests.length,n=t>e+1?e:t,r=_(this.user.interests).first(n),i=r.map(function(e){return e.name}),t>n&&i.push(t-n+" more interests"),$h.to_sentence(i)):void 0},n}(HoverPopover),$a.is_logged_in()&&$a.each_current_and_future("*[data-has-card-for-user]",function(e){return new Aedu.UserCard({el:$(e)})})}.call(this),function(){this.UserSource={sources:["unknown"],remember:function(e){return this.sources.push(e)},last:function(){return _.last(this.sources)}}}.call(this),function(){Aedu.startStandaloneWorkCreator=function(e,t){var n;return n={cb:encodeURIComponent(window.location.toString().replace(/(#add)$/,"")),section:encodeURIComponent(e)},t&&(n.source=encodeURIComponent(t)),window.location=$r.Papers_Upload_path(n)}}.call(this),function(){var e,t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.app=window.app||{},app.models=app.models||{},app.views=app.views||{},app.config=app.config||{},app.config.max_file_size=104857600,app.config.max_file_name_length=125,app.config.accepted_file_types=["pdf","txt","ps","rtf","epub","odt","odp","ods","odg","odf","sxw","sxc","sxi","sxd","doc","ppt","pps","xls","docx","pptx","ppsx","xlsx","csv","tsv"],Academia.BasicUploader=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.template=_.template('<button class="button upload"><%= button_text %></button> <input type=file <%= multiple %>>'),i.prototype.elements={uploader:"input[type=file]",upload_button:"button"},i.prototype.initialize=function(){var e,t;return i.__super__.initialize.apply(this,arguments),(e=this.options).max_size||(e.max_size=app.config.max_file_size),(t=this.options).button_text||(t.button_text="Upload"),req("jquery.fileupload")},i.prototype.render=function(){return i.__super__.render.call(this,{defaults:{button_text:this.options.button_text,multiple:this.options.multiple?"multiple":""}}),this._fix_min_width_and_height(),req("jquery.fileupload",function(t){return function(){var n;return t.$els.uploader.fileupload({url:t.options.url,dataType:"json",formData:{document_domain:$no_document_domain?null:document.domain},dropZone:("function"==typeof(n=t.options).drop_zone?n.drop_zone():void 0)||t.$el,add:function(n,i){return t.options.max_size&&!t._size_ok(i.files[0])||t.options.file_types&&!t._file_type_ok(i.files[0])?void 0:i.files[0].name.length>125?void alert("Sorry, your file name is too long to upload. Please shorten to 125 characters or less."):(i.uploading_file=new e(i),i.submit(),t._record_event("upload_started"),t.trigger("add",i.uploading_file))},progress:function(e,t){return t.uploading_file.trigger("progress",t.progress())},done:function(e,t){return t.uploading_file.trigger("done",t)},fail:function(e,n){return t._record_event("upload_failed",$a.fileUploadErrorString(n),"basic_uploader"),n.uploading_file.trigger("fail",n)}})}}(this))},i.prototype.set_button_html=function(e){return this.$els.upload_button.html(e)},i.prototype.show_spinner=function(){var e;return e=$image_url("loaders/loader-green.gif"),this.set_button_html("<img src='"+e+"'>")},i.prototype.reset_button_html=function(){return this.$els.upload_button.html(this.options.button_text)},i.prototype._fix_min_width_and_height=function(){var e,t;return t=this.$els.upload_button.outerWidth(),e=this.$els.upload_button.outerHeight(),t>0&&e>0?(this.$els.upload_button.css("min-width",t),this.$els.upload_button.css("min-height",e)):setTimeout(function(e){return function(){return e._fix_min_width_and_height()}}(this),500)},i.prototype._size_ok=function(e){return e.size>this.options.max_size?(this.trigger("maximum_file_size_exceeded"),!1):!0},i.prototype._file_type_ok=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.options.file_types,t)?!0:(this.trigger("invalid_file_type",t),this._report_invalid_extensions_upload_attempt(t),!1)},i.prototype._report_invalid_extensions_upload_attempt=function(e){var t;return t=$r.record_invalid_extension_api_v0_attachments_path({subdomain_param:"api"}),$.post(t,{extensions:[e]})},i}(Academia.View),e=function(){function e(e){this.file=e.files[0]}return _.extend(e.prototype,Backbone.Events),e}(),Academia.Uploader=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="uploader",n.prototype.template=_.template("<div class='errors'> <p class='file_size_warning'>Please choose a smaller file<%= max_size_message %>.</p> <p class='file_type_warning'>Sorry, we don't support that file type.</p> <p class='server_error_warning'> Sorry, something went wrong! Your upload may or may not have finished. Please refresh the page, and try again if the uploaded file does not appear. </p> </div> <div class='upload_container'></div> <div class='progress_bar'> <div class='progress'>&nbsp;</div> </div>"),n.prototype.elements={upload_container:".upload_container",upload_button:"button",upload_progress:".progress",progress_bar:".progress_bar",file_size_warning:".file_size_warning",file_type_warning:".file_type_warning",server_error_warning:".server_error_warning"},n.prototype.initialize=function(){var e;return n.__super__.initialize.apply(this,arguments),"allow_multiple"in this.options||(this.options.allow_multiple=!0),(e=this.options).max_size||(e.max_size=app.config.max_file_size),this._create_uploader()},n.prototype.render=function(){return n.__super__.render.call(this,{defaults:{max_size_message:this._max_size_message(this.options.max_size)}}),this.uploader.setElement(this.$els.upload_container).render(),this},n.prototype.render_and_insert=function(e,t){return null==t&&(t="insertAfter"),this.render(),this.$el[t](e),this},n.prototype.reset=function(){return this.$els.progress_bar.hide(),this.$els.file_size_warning.hide(),this.$els.file_type_warning.hide(),this.$els.server_error_warning.hide(),this.uploader.reset_button_html()},n.prototype.update_upload_progress=function(e){return this.$els.progress_bar.show(),this.$els.upload_progress.css("width",e+"%"),this.uploader.set_button_html(e>=100?"99%":e+"%")},n.prototype.upload_complete=function(){return this.$els.progress_bar.hide(),this.uploader.set_button_html('<i class="fa fa-ok"></i>')},n.prototype._create_uploader=function(){return this.uploader=this.options.uploader||this._create_basic_uploader(),this.uploader.on("add",function(e){return function(t){return e._add(t)}}(this)),this.uploader.on("maximum_file_size_exceeded",function(e){return function(){return e.trigger("maximum_file_size_exceeded"),e.$els.file_size_warning.show()}}(this)),this.uploader.on("invalid_file_type",function(e){return function(t){return e.trigger("invalid_file_type",t),e.$els.file_type_warning.show()}}(this))},n.prototype._add=function(e){return this.options.add&&this.options.add(),this.uploader.show_spinner(),this.options.uploading&&this.options.uploading(this),this.options.disable_during_upload&&$(this.options.disable_during_upload()).attr("disabled","disabled"),e.on("progress",function(e){return function(t){return e._progress(t)}}(this)),e.on("done",function(e){return function(t){return e._done(t)}}(this)),e.on("fail",function(e){return function(){return e._failure()}}(this))},n.prototype._progress=function(e){var t;return t=parseInt(e.loaded/e.total*100,10),this.update_upload_progress(t)},n.prototype._done=function(e){return this.upload_complete(),this.options.done&&this.options.done(e,this),this.options.disable_during_upload&&$(this.options.disable_during_upload()).removeAttr("disabled"),this.options.allow_multiple?setTimeout(function(e){return function(){return e.reset()}}(this),2e3):void 0},n.prototype._failure=function(){return this.reset(),this.$els.server_error_warning.show()},n.prototype._create_basic_uploader=function(){return new Academia.BasicUploader(_.pick(this.options,"url","button_text","multiple","max_size","file_types"))},n.prototype._max_size_message=function(e){return" (less than "+window.$h.humanFileSize(e)+")"},n}(Academia.View),app.views.Uploader_v2=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.max_file_size=e.max_file_size||app.config.max_file_size,this.max_file_name_length=e.max_file_name_length||app.config.max_file_name_length,this.accepted_file_types=e.accepted_file_types||app.config.accepted_file_types,this.notifier=e.event_recorder,req("jquery.fileupload",function(t){return function(){return e.input.fileupload({url:e.url||t._attachment_url(e.work_id,e.source),dataType:"json",formData:{document_domain:$no_document_domain?null:document.domain},dropZone:e.dropZone,add:function(e,n){var i,r;return i=n.files[0],(r=t._validate_file(i))?void t.trigger("error",r,i):(n.submit(),t._record_event("upload_started"),t.trigger("add",i))},progress:function(e,n){var i,r;return r=n.files[0],null!=(i=r.model)&&i.trigger("progress",n.progress()),t.trigger("progress",n.progress())},done:function(e,n){var i,r;return r=n.files[0],null!=(i=r.model)&&i.trigger("done",n),t.trigger("done",n)},fail:function(e,n){var i,r;return r=n.files[0],null!=(i=r.model)&&i.trigger("fail",n),t.trigger("fail",n),t._record_event("upload_failed",$a.fileUploadErrorString(n),"v2_uploader")}})}}(this))},n.prototype._validate_file=function(e){var t;return t=_.compact([this._validate_file_size(e),this._validate_file_type(e),this._validate_file_name_length(e)]),0!==t.length?t:void 0},n.prototype._validate_file_size=function(e){return e.size>this.max_file_size?{file_size:e.size}:void 0},n.prototype._validate_file_name_length=function(e){return e.name.length>this.max_file_name_length?{file_name_length:e.name.length}:void 0},n.prototype._validate_file_type=function(e){var t;return t=_.last(e.name.split(/\./)).toLowerCase(),_.include(this.accepted_file_types,t)?void 0:{file_type:t}},n.prototype._attachment_url=function(e,t){var n;return n={work_id:e,subdomain_param:"api"},t&&(n.source=t),$r.api_v0_attachments_path(n)},n.prototype._record_event=function(e,t,n){return("undefined"!=typeof $a&&null!==$a?$a.log:void 0)&&$a.log(e),null!=this.notifier?this.notifier.notify({event:e,user_id:$current_user.id,source:n||this.options.source,error:t,user_time:parseInt((new Date).getTime()/1e3)}):void 0},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.ResponsiveScribdDocumentView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.zoomPerPixel=null,this.scribdIds=e.scribdIds,this.ui={$loader:this.$(".js-scribd-document-loader"),$container:this.$(".js-scribd-document-container")},this._throttledCheckForPageChange=_.throttle(function(e){return function(){return e._checkForPageChange()}}(this),250),this.tracker=new Aedu.ScribdDocumentTracker(e.attachmentId,this)},n.prototype.show=function(){return this.ui.$loader.show(),this.ui.$container.append("<div id='scribd-reflowable-doc'></div>"),this.scribdDoc=this._getDoc(),this.scribdDoc.addEventListener("docReady",function(e){return function(t){return e._onDocReady(t)}}(this)),$(window).on("scroll.scribd-"+this.scribdIds.docId,function(e){return function(){return e._throttledCheckForPageChange()}}(this))},n.prototype.tear_down=function(){return this.scribdDoc.__remove(),this.scribdDoc=null,$(window).off("scroll.scribd-"+this.scribdIds.docId)},n.prototype._resizeScribd=function(){var e;return null!=this.scribdDoc?(this.trigger("beforeResize"),e=this.zoomPerPixel*this._calculateWidth(),this.scribdDoc.api.setZoom(e),this.trigger("afterResize")):void 0},n.prototype._calculateWidth=function(){var e;return e=$("#scribd-reflowable-doc").outerWidth(),$a.log("scribd document width: ",e),e},n.prototype._onDocReady=function(e){var t;return this.ui.$loader.hide(),t=this.$(".outer_page:first").width(),this.zoomPerPixel=1/t,this._resizeScribd(),$(window).on("resize",function(e){return function(){return e._resizeScribd()}}(this)),this.trigger("docReady",e)},n.prototype._getDoc=function(){var e;return e=scribd.Document.getDoc(this.scribdIds.docId,this.scribdIds.accessKey),e.addParam("jsapi_version",2),e.addParam("disable_related_docs",!0),e.addParam("disable_resume_reading",!0),e.addParam("hideZoomControls",!0),e.seamless("scribd-reflowable-doc"),e},n.prototype._checkForPageChange=function(){var e;if(this.scribdDoc)return e=this.getPage(),this.currentPage!==e?($a.log("Scribd page: "+e+", was: "+this.currentPage),this.trigger("pageChanged",{was:this.currentPage,page:e}),this.currentPage=e):void 0},n.prototype.getPage=function(e){var t;return null==e&&(e=document),t=0,_.each($('[id^="outer_page_"]'),function(e){return $(e).offset().top<$(document).scrollTop()?t++:void 0}),t},n}(Backbone.View)}.call(this),function(){Aedu.ScribdDocumentTracker=function(){function e(e,t){var n;this.attachmentId=e,this.docView=t,_.extend(this,Backbone.Events),this.events=[],this.listenTo(this.docView,"docReady",this.recordDocumentReady),this.listenTo(this.docView,"pageChanged",this.recordPageChange),$(window).on("beforeunload",function(e){return function(){return e.recordUnload()}}(this)),null!=window.navigator.sendBeacon&&null!=window.FormData?(this.sendData=function(e,t){var n,i;return n=new FormData,_.each(t,function(e,t){return n.append(t,e)}),i=navigator.sendBeacon(e,n),i?void 0:$a.log("sendBeacon failed for: "+JSON.stringify(t))},n=15e3):(this.sendData=$.post,n=1e3),this.flushEventsThrottled=_.throttle(function(e){return function(){return e.flushEvents()}}(this),n)}return e.loadedAt=new Date,e.prototype.recordDocumentReady=function(){return this.enqueueEvent("docReady",this.docView.getPage()),this.flushEventsThrottled()},e.prototype.recordPageChange=function(e){return this.enqueueEvent("pageChanged",e.page),this.flushEventsThrottled()},e.prototype.recordUnload=function(){this.enqueueEvent("unload",this.docView.getPage()),this.flushEvents(!1)},e.prototype.enqueueEvent=function(e,t){return this.events.push({event:e,ms_since_load:(new Date).getTime()-this.constructor.loadedAt,page:t})},e.prototype.flushEvents=function(e){return null==e&&(e=!0),this.events.length>0?!Aedu.hit_data&&e?void setTimeout(function(e){return function(){return e.flushEventsThrottled()}}(this),500):(this.sendData($r.api_v0_scribd_events_path({subdomain_param:"api"}),{hit:JSON.stringify(Aedu.hit_data),attachment_id:this.attachmentId,events:JSON.stringify(this.events)}),this.events=[]):void 0},e}()}.call(this),Widgets.YesNo={message:"Are you sure?",yes:"Confirm",no:"Cancel",create:function(e){function t(){}t.prototype=this;var n=new t;if(e.message&&(n.message=e.message),e.yes&&(n.yes=e.yes),e.no&&(n.no=e.no),e.onYes&&(n.onYes=e.onYes),e.onNo&&(n.onNo=e.onNo),e.nextTo){n.target=e.nextTo;var i=e.down||20,r=e.along||0,o=$(n.target).offset();n.offset={left:o.left+r,top:o.top+i}}return n.raw_el=JSML.transform(["div.yes-no-widget",["div.yes-no-widget-message",n.message],["div.yes-no-widget-buttons",["img.yes-no-spinner",{src:$image_url("spinner.gif"),style:"display: none;"}]," ",["a.no",{href:"#",onclick:function(){return n.onNo.apply(n),!1}},n.no]," ",["a.yes",{href:"#",onclick:function(){return n.onYes.apply(n),!1}},n.yes]]]),n.j_el=$(n.raw_el),n.j_el.css({position:"absolute",left:n.offset.left,top:n.offset.top,"z-index":1e5}),n.dimensions&&n.j_el.css({width:""+n.dimensions.width+"px",height:""+n.dimensions.height+"px"}),n.j_el.hide(),document.body.appendChild(n.raw_el),n},waiting:function(e){e?this.j_el.find(".yes-no-spinner").show():this.j_el.find(".yes-no-spinner").hide()},onNo:function(){return this.fadeOutAndRemove("fast"),!1},fadeIn:function(){this.j_el.fadeIn("fast")},fadeOutAndRemove:function(e,t){var n=this.j_el;n.fadeOut(e,function(){n.remove()}),t&&t()}},Widgets.BoxOver=Widgets.Base.inherit({widget_name:"BoxOver",url:null,internal_definition:null,type:null,title:null,width:null,height:null,top:null,positioning:null,DEFAULT_TOP:75,DEFAULT_WIDTH:500,DEFAULT_HEIGHT:300,init:function(e){"undefined"!=typeof e.iframe&&(this.url=e.iframe),"undefined"!=typeof e.title&&(this.title=e.title),this.width="undefined"!=typeof e.width?parseInt(e.width,10):this.DEFAULT_WIDTH,this.height="undefined"!=typeof e.height?parseInt(e.height,10):this.DEFAULT_HEIGHT,this.top="undefined"!=typeof e.top?parseInt(e.top,10):this.DEFAULT_TOP,this.onclose="undefined"!=typeof e.onclose?e.onclose:function(){},"absolute"==e.positioning?(this.positioning="absolute",this.top+=$(window).scrollTop()):this.ensure_all_visible(),this.build()},ensure_all_visible:function(){var e=$(window).scrollTop(),t=$(window).height(),n=this.j_element,i=n?n.offset().top-e:this.top,r=n?n.height():this.height;i+r>t?(this.positioning="absolute",this.top+=e):this.positioning="fixed",this.j_element&&this.j_element.css({position:this.positioning,top:this.top})},content_width:function(){return this.width},content_height:function(){return this.height},set_height:function(e,t,n){var i=this,r=i.j_element.find(".container_title_bar").height();this.height=e,t||(t="fast");var o=function(){i.j_element.height(e+r),"fixed"==i.positioning&&i.ensure_all_visible(),n&&"function"==typeof n&&n()};i.j_element.find("iframe").animate({height:""+i.height+"px"},t,function(){i.j_element.css({height:""+i.height+"px"}),i.j_element.find("table").css({height:""+i.height+"px"}),o()})},position:function(){var e=this.j_element.width();this.width&&(e=this.width),this.j_element.css(this.styles(e)),function(t){$(window).on("resize",function(){t.j_element.css(t.styles(e))})}(this),this.j_element.find("table").css({width:""+this.width+"px",height:""+this.height+"px"}),this.j_element.find("iframe").css({width:""+this.content_width()+"px",height:""+this.height+"px"})},styles:function(e){var t=$(window).width(),n={position:this.positioning,zIndex:100,left:""+(t-e)/2+"px",top:""+this.top+"px",height:""+this.height+"px",width:""+e+"px"};return n},show:function(){var e=this,t=$("#overlay_background");e.j_element.find(".container_content").html("");var n=$(document.createElement("iframe"));n.attr("src",e.url),e.j_element.find(".container_content").append(n),e.j_element.find(".boxover_widget_close").click(function(){return t.fadeOut("fast"),e.hide(),e.onclose(),!1}),e.prepare(),e.position(),e.j_element.show(),e.add_to_open_widgets(),e.show_wait_view(),n.load(function(){e.show_content_view()})},show_wait_view:function(){var e=this;e.j_element.find(".container_content").hide();var t=e.j_element.find(".container_wait_content");t.css({height:""+e.height+"px","background-color":"#ffffff","text-align":"center","padding-top":""+e.content_height()/2+"px"}),t.show()},show_content_view:function(){var e=this;e.j_element.find(".container_wait_content").hide(),e.j_element.find(".container_content").show()},definition:function(){var e=this,t=function(){var t="";return e.internal_definition&&(t=e.internal_definition),null!==e.title?["div.container_center",{valign:"top"},[".container_title_bar",[".container_close.boxover_widget_close",["i",{"class":"fa fa-times icon-dark"},""]],[".container_title",e.title]],[".container_content",t],[".container_wait_content",["i",{"class":"fa fa-spinner fa-spin fa-lg"},""]]]:["div.container_content",{valign:"top"},t]};return["#boxover_widget",t()]}}),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n=[].slice;$w.modal_box=function(e,t){var n;return null==t&&(t={}),n=new Widgets.ModalBox(e),n.on("shown",function(){return"function"==typeof e.after_show?e.after_show(n):void 0}),n.show(t)},Widgets.ModalBox=function(){function n(e){this._handle_window_keyup=t(this._handle_window_keyup,this),_.extend(this,Backbone.Events),this.title=e.title||"",this.contents=e.contents||"",this.width=e.width||"600px",this.close_on_esc=null!=e.close_on_esc?e.close_on_esc:!0,this._adjust_top_margin_throttled=_.throttle(function(e){return function(){return e._adjust_top_margin()}}(this),200)}return n.prototype.template=_.template("<div class=modal_overlay> <div class=modal_overlay_box> <div class=modal_title_bar> <%= title %> <i class='fa fa-times'></i> </div> <div class='modal_contents clearfix'></div> </div> </div>"),n.prototype.show=function(t){return $("#overlay_background").fadeIn(100,function(n){return function(){return n.$el=$(n.template({title:e(n.title,t)})),n.$el.find(".modal_contents").append(e(n.contents,t)),n.$el.find(".modal_overlay_box").css({width:n.width}),$(window).on("keyup",n._handle_window_keyup),$(window).on("resize",n._adjust_top_margin_throttled),$("body").addClass("no_scroll"),$("body").append(n.$el),n._adjust_top_margin(),n._bind_events(),n.trigger("shown")}}(this)),this},n.prototype.hide=function(){return this.$el.hide(),$("#overlay_background").fadeOut(200,function(e){return function(){return e.$el.remove(),$(window).off("keyup",e._handle_window_keyup),$(window).off("resize",e._adjust_top_margin_throttled),$("body").removeClass("no_scroll"),e.trigger("hidden")}}(this))},n.prototype._handle_window_keyup=function(e){return 27===e.keyCode&&this.close_on_esc?(e.preventDefault(),e.stopPropagation(),this.hide()):void 0},n.prototype._adjust_top_margin=function(){var e,t,n,i;return e=this.$el.find(".modal_overlay_box"),t=e.outerHeight(),i=$(window).height(),0===t?setTimeout(this._adjust_top_margin,200):(n=Math.max((i-t)/2,50),e.css({marginTop:n+"px"}))},n.prototype._bind_events=function(){return this.$el.on("click",function(e){return function(t){return $(t.target).is(e.$el)?e.hide():void 0}}(this)),this.$el.on("click",".modal_title_bar i",function(e){return function(){return e.hide()}}(this)),this.$el.on("resize_modal",function(e){return function(t){return t.stopPropagation(),e._adjust_top_margin()}}(this)),this.$el.on("hide_modal",function(e){return function(t){return t.stopPropagation(),e.hide()}}(this))},n}(),e=function(){var e,t;return t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],"function"==typeof t?t.apply(null,e):t}}.call(this),Widgets.Notification=Widgets.Base.inherit({message:"",init:function(e){this.parent.init(e),this.message=e.message,this.build()},definition:function(){return[".notification-widget",[".notification-widget-message",this.message]]}}),_.extend($w,{flash:function(e,t,n){"undefined"==typeof t&&(t={}),t.message=e;var i=Widgets.Notification.create(t);i.flash(n,t)},confirm:function(e,t,n){"undefined"==typeof t&&(t={});var i;return t.message=e,t.onYes=function(){i.fadeOutAndRemove("fast",n)},i=Widgets.YesNo.create(t),i.fadeIn(),i},boxover:function(e){var t=Widgets.BoxOver.create(e);return $("#overlay_background").fadeTo("fast",.6),t.show(),$("#boxover_widget").addClass(e.classes||""),t}}),Works.SECTIONS={Books:{noun:"book",doc_type:"book",suggested_fields:["abstract","more_info","publication_date","publisher"],og_icon:"open-graph-icons/fb-book.gif",og_type:"book"},Papers:{noun:"paper",doc_type:"paper",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},Talks:{noun:"talk",doc_type:"talk",suggested_fields:["abstract","organization","location","time","event_date"],og_icon:"open-graph-icons/fb-talk.gif",og_type:"article"},"Teaching Documents":{noun:"teaching document",doc_type:"teaching_document",suggested_fields:["more_info","abstract","location","event_date"],og_icon:"open-graph-icons/fb-teaching.gif",og_type:"article"},Drafts:{noun:"draft",doc_type:"draft",suggested_fields:["abstract","more_info"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Book Reviews":{noun:"book review",doc_type:"book_review",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Conference Presentations":{noun:"conference presentation",doc_type:"conference_presentation",suggested_fields:["abstract","journal_name","location","time","event_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},"Thesis Chapters":{noun:"thesis chapter",doc_type:"thesis_chapter",suggested_fields:["abstract","more_info","completion_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"},Other:{noun:"document",doc_type:"other",suggested_fields:["abstract","more_info","publication_name","publication_date"],og_icon:"open-graph-icons/fb-paper.gif",og_type:"article"}},/*

Modified by Academia.edu to add useExistingInput and forcePlaceholder options.
This is pretty ugly, but so is what Select2 does to your markup by default.

Rather than ever upgrading Select2, we should consider moving to a less
opinionated and/or more Bootstrap & React-compatible autocomplete/typeahead
library.

Select2 4.0 moves even further in the direction of specializing as a fancier
version of an actual select tag, rather than a general-purpose typeahead library.

The right answer might be Twitter's typeahead module, which is designed for
Bootstrap compatibility, but unfortunately it depends on jQuery 1.9, and as of
writing we're on 1.8. Or, maybe we should find a React library, or write our own.

========================

Copyright 2012 Igor Vaynberg

Version: 3.4.1 Timestamp: Thu Jun 27 18:02:10 PDT 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.

*/
function(e){"undefined"==typeof e.fn.each2&&e.fn.extend({each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function n(e,t){for(var n=0,i=t.length;i>n;n+=1)if(r(e,t[n]))return n;return-1}function i(){var t=e(B);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function r(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function o(t,n){var i,r,o;if(null===t||t.length<1)return[];for(i=t.split(n),r=0,o=i.length;o>r;r+=1)i[r]=e.trim(i[r]);return i}function a(e){return e.outerWidth(!1)-e.width()}function s(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function l(n){n.on("mousemove",function(n){var i=L;(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function u(e,n,i){i=i||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function c(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function d(e,t){var i=u(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){n(e.target,t.get())>=0&&i(e)})}function p(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),e.is(":visible")&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function h(t){t=e(t)[0];var n=0,i=0;if("selectionStart"in t)n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var r=document.selection.createRange();i=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),n=r.text.length-i}return{offset:n,length:i}}function f(e){e.preventDefault(),e.stopPropagation()}function m(e){e.preventDefault(),e.stopImmediatePropagation()}function g(t){if(!I){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);I=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),I.attr("class","select2-sizer"),e("body").append(I)}return I.text(t.val()),I.width()}function v(t,n,i){var r,o,a=[];r=t.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0===this.indexOf("select2-")&&a.push(this)})),r=n.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(o=i(this),o&&a.push(this))})),t.attr("class",a.join(" "))}function y(e,t,n,i){var r=e.toUpperCase().indexOf(t.toUpperCase()),o=t.length;return 0>r?void n.push(i(e)):(n.push(i(e.substring(0,r))),n.push("<span class='select2-match'>"),n.push(i(e.substring(r,r+o))),n.push("</span>"),void n.push(i(e.substring(r+o,e.length))))}function _(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function b(n){var i,r=0,o=null,a=n.quietMillis||100,s=n.url,l=this;return function(u){window.clearTimeout(i),i=window.setTimeout(function(){r+=1;var i=r,a=n.data,c=s,d=n.transport||e.fn.select2.ajaxDefaults.transport,p={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},h=e.extend({},e.fn.select2.ajaxDefaults.params,p);a=a?a.call(l,u.term,u.page,u.context):null,c="function"==typeof c?c.call(l,u.term,u.page,u.context):c,o&&o.abort(),n.params&&(e.isFunction(n.params)?e.extend(h,n.params.call(l)):e.extend(h,n.params)),e.extend(h,{url:c,dataType:n.dataType,data:a,success:function(e){if(!(r>i)){var t=n.results(e,u.page);u.callback(t)}}}),o=d.call(l,h)},a)}}function w(t){var n,i,r=t,o=function(e){return""+e.text};e.isArray(r)&&(i=r,r={results:i}),e.isFunction(r)===!1&&(i=r,r=function(){return i});var a=r();return a.text&&(o=a.text,e.isFunction(o)||(n=a.text,o=function(e){return e[n]})),function(t){var n,i=t.term,a={results:[]};return""===i?void t.callback(r()):(n=function(r,a){var s,l;if(r=r[0],r.children){s={};for(l in r)r.hasOwnProperty(l)&&(s[l]=r[l]);s.children=[],e(r.children).each2(function(e,t){n(t,s.children)}),(s.children.length||t.matcher(i,o(s),r))&&a.push(s)}else t.matcher(i,o(r),r)&&a.push(r)},e(r().results).each2(function(e,t){n(t,a.results)}),void t.callback(a))}}function C(n){var i=e.isFunction(n);return function(r){var o=r.term,a={results:[]};e(i?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||r.matcher(o,n))&&a.results.push(e?this:{id:this,text:this})}),r.callback(a)}}function S(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error(n+" must be a function or a falsy value")}function x(t){return e.isFunction(t)?t():t}function k(t){var n=0;return e.each(t,function(e,t){t.children?n+=k(t.children):n++}),n}function A(e,n,i,o){var a,s,l,u,c,d=e,p=!1;if(!o.createSearchChoice||!o.tokenSeparators||o.tokenSeparators.length<1)return t;for(;;){for(s=-1,l=0,u=o.tokenSeparators.length;u>l&&(c=o.tokenSeparators[l],s=e.indexOf(c),!(s>=0));l++);if(0>s)break;if(a=e.substring(0,s),e=e.substring(s+c.length),a.length>0&&(a=o.createSearchChoice.call(this,a,n),a!==t&&null!==a&&o.id(a)!==t&&null!==o.id(a))){for(p=!1,l=0,u=n.length;u>l;l++)if(r(o.id(a),o.id(n[l]))){p=!0;break}p||i(a)}}return d!==e?e:void 0}function E(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var T,R,D,P,N,I,M,O,L={x:0,y:0},T={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case T.LEFT:case T.RIGHT:case T.UP:case T.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case T.SHIFT:case T.CTRL:case T.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},B="<div class='select2-measure-scrollbar'></div>";M=e(document),N=function(){var e=1;return function(){return e++}}(),M.on("mousemove",function(e){L.x=e.pageX,L.y=e.pageY}),R=E(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,o,a,u,p=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=n.useExistingInput?this.createContainerForExistingInput():this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+N()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c(function(){return n.element.closest("body")}),n.useExistingInput||v(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(x(n.containerCss)),this.container.addClass(x(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),n.useExistingInput?(this.container.insertBefore(this.opts.element),this.container.prepend(this.opts.element),this.opts.element.addClass("select2-input").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck",!1)):this.opts.element.attr("tabindex","-1").before(this.container),this.opts.element.data("select2",this),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(x(n.dropdownCssClass)),this.dropdown.data("select2",this),this.results=r=this.container.find(p),this.search=o=this.container.find("input.select2-input"),this.resultsPage=0,this.context=null,this.initContainer(),l(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",p,this.bind(this.highlightUnderEvent)),d(80,this.results),this.dropdown.on("scroll-debounced",p,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&r.mousewheel(function(e,t,n,i){var o=r.scrollTop();i>0&&0>=o-i?(r.scrollTop(0),f(e)):0>i&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()&&(r.scrollTop(r.get(0).scrollHeight-r.height()),f(e))}),s(o),o.on("keyup-change input paste",this.bind(this.updateResults)),o.on("focus",function(){o.addClass("select2-focused")}),o.on("blur",function(){o.removeClass("select2-focused")}),this.dropdown.on("mouseup",p,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var a=n.element.prop("disabled");a===t&&(a=!1),this.enable(!a);var u=n.element.prop("readonly");u===t&&(u=!1),this.readonly(u),O=O||i(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus()},destroy:function(){var e=this.opts.element,n=e.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},createContainerForExistingInput:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:r(e.attr("locked"),"locked")||r(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,a,s,l,u=this;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=a=n.element),a&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,r,o){var a,s=this.opts.id;(a=function(i,r,l){var c,d,p,h,f,m,g,v,y,_;for(i=n.sortResults(i,r,o),c=0,d=i.length;d>c;c+=1)p=i[c],f=p.disabled===!0,h=!f&&s(p)!==t,m=p.children&&p.children.length>0,g=e("<li></li>"),g.addClass("select2-results-dept-"+l),g.addClass("select2-result"),g.addClass(h?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-disabled"),m&&g.addClass("select2-result-with-children"),g.addClass(u.opts.formatResultCssClass(p)),v=e(document.createElement("div")),v.addClass("select2-result-label"),_=n.formatResult(p,v,o,u.opts.escapeMarkup),_!==t&&v.html(_),g.append(v),m&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),a(p.children,y,l+1),g.append(y)),g.data("select2-data",p),r.append(g)})(r,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(s=n.id,n.id=function(e){return e[s]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(a?(n.query=this.bind(function(e){var n,r,o,a={results:[],more:!1},s=e.term;o=function(t,n){var i;t.is("option")?e.matcher(s,t.text(),t)&&n.push(u.optionToData(t)):t.is("optgroup")&&(i=u.optionToData(t),t.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(r=this.getPlaceholderOption(),r&&(n=n.not(r))),n.each2(function(e,t){o(t,a.results)}),e.callback(a)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=b.call(n.element,n.ajax)):"data"in n?n.query=w(n.data):"tags"in n&&(n.query=C(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(e){return{id:e,text:e}}),n.initSelection===t&&(n.initSelection=function(t,i){var a=[];e(o(t.val(),n.separator)).each(function(){var t=this,i=this,o=n.tags;e.isFunction(o)&&(o=o()),e(o).each(function(){return r(this.id,t)?(i=this.text,!1):void 0}),a.push({id:t,text:i})}),i(a)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e,n=this.opts.element;n.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e,i=n.prop("disabled");i===t&&(i=!1),this.enable(!i);var e=n.prop("readonly");e===t&&(e=!1),this.readonly(e),v(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(x(this.opts.containerCssClass)),v(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(x(this.opts.dropdownCssClass))}),n.on("propertychange.select2 DOMAttrModified.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(this.mutationCallback),this.propertyObserver.observe(n.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){return e===t&&(e=!0),this._enabled===e?!1:(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface(),!0)},readonly:function(e){return e===t&&(e=!1),this._readonly===e?!1:(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r,o=this.dropdown,a=this.container.offset(),s=this.container.outerHeight(!1),l=this.container.outerWidth(!1),u=o.outerHeight(!1),c=e(window).scrollLeft()+e(window).width(),d=e(window).scrollTop()+e(window).height(),p=a.top+s,h=a.left,f=d>=p+u,m=a.top-u>=this.body().scrollTop(),g=o.outerWidth(!1),v=c>=h+g,y=o.hasClass("select2-drop-above");this.opts.dropdownAutoWidth?(r=e(".select2-results",o)[0],o.addClass("select2-drop-auto-width"),o.css("width",""),g=o.outerWidth(!1)+(r.scrollHeight===r.clientHeight?0:O.width),g>l?l=g:g=l,v=c>=h+g):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),p-=t.top,h-=t.left),y?(n=!0,!m&&f&&(n=!1)):(n=!1,!f&&m&&(n=!0)),v||(h=a.left+l-g),n?(p=a.top-u,this.container.addClass("select2-drop-above"),o.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),o.removeClass("select2-drop-above")),i=e.extend({top:p,left:h,width:l},x(this.opts.dropdownCss)),o.css(i)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){function t(){return{width:Math.max(document.documentElement.scrollWidth,e(window).width()),height:Math.max(document.documentElement.scrollHeight,e(window).height())}}var n,i,r=this.containerId,o="scroll."+r,a="resize."+r,s="orientationchange."+r;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),n=e("#select2-drop-mask"),0==n.length&&(n=e(document.createElement("div")),n.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),n.hide(),n.appendTo(this.body()),n.on("mousedown touchstart click",function(t){var n,i=e("#select2-drop");i.length>0&&(n=i.data("select2"),n.opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close(),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==n[0]&&this.dropdown.before(n),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),i=t(),n.css(i).show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var l=this;this.container.parents().add(window).each(function(){e(this).on(a+" "+o+" "+s,function(){var n=t();e("#select2-drop-mask").css(n),l.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,i="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return x(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,i,r,o,a,s,l=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return void l.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),i=e(t[n]),r=i.offset().top+i.outerHeight(!0),n===t.length-1&&(s=l.find("li.select2-more-results"),s.length>0&&(r=s.offset().top+s.outerHeight(!0))),o=l.offset().top+l.outerHeight(!0),r>o&&l.scrollTop(l.scrollTop()+(r-o)),a=i.offset().top-l.offset().top,0>a&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){i+=t;var r=e(n[i]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var i,r,o=this.findHighlightableChoices();return 0===arguments.length?n(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),i=e(o[t]),i.addClass("select2-highlighted"),this.ensureHighlightVisible(),r=i.data("select2-data"),void(r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r})))},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,r=this,o=this.search.val(),a=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:a,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:o,page:i,context:a}),r.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(r.opts.formatLoadMore(i+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):n.remove(),r.positionDropdown(),r.resultsPage=i,r.context=e.context)})})))},tokenize:function(){},updateResults:function(n){function i(){l.removeClass("select2-active"),d.positionDropdown()}function o(e){u.html(e),i()}var a,s,l=this.search,u=this.results,c=this.opts,d=this,p=l.val(),h=e.data(this.container,"select2-last-term");if((n===!0||!h||!r(p,h))&&(e.data(this.container,"select2-last-term",p),n===!0||this.showSearchInput!==!1&&this.opened())){var f=this.getMaximumSelectionSize();if(f>=1&&(a=this.data(),e.isArray(a)&&a.length>=f&&S(c.formatSelectionTooBig,"formatSelectionTooBig")))return void o("<li class='select2-selection-limit'>"+c.formatSelectionTooBig(f)+"</li>");if(l.val().length<c.minimumInputLength)return o(S(c.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+c.formatInputTooShort(l.val(),c.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0));if(c.maximumInputLength&&l.val().length>c.maximumInputLength)return void o(S(c.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+c.formatInputTooLong(l.val(),c.maximumInputLength)+"</li>":"");c.formatSearching&&0===this.findHighlightableChoices().length&&o("<li class='select2-searching'>"+c.formatSearching()+"</li>"),l.addClass("select2-active"),s=this.tokenize(),s!=t&&null!=s&&l.val(s),this.resultsPage=1,c.query({element:c.element,term:l.val(),page:this.resultsPage,context:null,matcher:c.matcher,callback:this.bind(function(a){var s;return this.opened()?(this.context=a.context===t?null:a.context,this.opts.createSearchChoice&&""!==l.val()&&(s=this.opts.createSearchChoice.call(d,l.val(),a.results),s!==t&&null!==s&&d.id(s)!==t&&null!==d.id(s)&&0===e(a.results).filter(function(){return r(d.id(this),d.id(s))}).length&&a.results.unshift(s)),0===a.results.length&&S(c.formatNoMatches,"formatNoMatches")?void o("<li class='select2-no-results'>"+c.formatNoMatches(l.val())+"</li>"):(u.empty(),d.opts.populateResults.call(this,u,a.results,{term:l.val(),page:this.resultsPage,context:null}),a.more===!0&&S(c.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+d.opts.escapeMarkup(c.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(a,n),i(),void this.opts.element.trigger({type:"select2-loaded",items:a}))):void this.search.removeClass("select2-active")})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),i=n.closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children().first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,i,r,o,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),o=0,a=i.length;a>o;o+=1)if(r=i[o].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}if(!this.opts.useExistingInput){var i=n.call(this);null!==i&&this.container.css("width",i)}}}),D=E(R,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var t,n,i;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),t=this.search.get(0),t.createTextRange?(n=t.createTextRange(),n.collapse(!1),n.select()):t.setSelectionRange&&(i=this.search.val().length,t.setSelectionRange(i,i)),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var t,n=this.container,i=this.dropdown;this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+N()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===T.PAGE_UP||e.which===T.PAGE_DOWN)return void f(e);switch(e.which){case T.UP:case T.DOWN:return this.moveHighlight(e.which===T.UP?-1:1),void f(e);case T.ENTER:return this.selectHighlighted(),void f(e);case T.TAB:return void this.selectHighlighted({noFocus:!0});case T.ESC:return this.cancel(e),void f(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==T.TAB&&!T.isControl(e)&&!T.isFunctionKey(e)&&e.which!==T.ESC){if(this.opts.openOnEnter===!1&&e.which===T.ENTER)return void f(e);if(e.which==T.DOWN||e.which==T.UP||e.which==T.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void f(e)}return e.which==T.DELETE||e.which==T.BACKSPACE?(this.opts.allowClear&&this.clear(),void f(e)):void 0}})),s(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),m(e),this.close(),this.selection.focus())})),t.on("mousedown",this.bind(function(t){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),f(t)})),i.on("mousedown",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){f(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");if(t){var n=this.getPlaceholderOption();this.opts.element.val(n?n.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection([]),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var e;return(e=this.getPlaceholderOption())!==t&&e.is(":selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val()},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find(":selected");t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var o=n.val(),a=null;t.query({matcher:function(e,n,i){var s=r(o,t.id(i));return s&&(a=i),s},callback:e.isFunction(i)?function(){i(a)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,o=this;if(this.findHighlightableChoices().each2(function(e,t){return r(o.id(t.data("select2-data")),o.opts.element.val())?(i=e,!1):void 0}),n!==!1&&this.highlight(t===!0&&i>=0?i:0),t===!0){var a=this.opts.minimumResultsForSearch;a>=0&&this.showSearch(k(e.results)>=a)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.close(),t&&t.noFocus||this.selection.focus(),r(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),n=this.opts.formatSelection(e,r,this.opts.escapeMarkup),n!==t&&r.append(n),i=this.opts.formatSelectionCssClass(e,r),i!==t&&r.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")
},val:function(){var e,n=!1,i=null,r=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find(":selected").each2(function(e,t){return i=r.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),n&&r.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e,n){var i;return 0===arguments.length?(i=this.selection.data("select2-data"),i==t&&(i=null),i):void(e&&""!==e?(i=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),n&&this.triggerChange({added:e,removed:i})):this.clear(n))}}),P=E(R,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find(":selected").each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var a=o(n.val(),t.separator),s=[];t.query({matcher:function(n,i,o){var l=e.grep(a,function(e){return r(e,t.id(o))}).length;return l&&s.push(o),l},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<a.length;n++)for(var o=a[n],l=0;l<s.length;l++){var u=s[l];if(r(o,t.id(u))){e.push(u),s.splice(l,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},initContainer:function(){var t,n=".select2-choices";this.opts.useExistingInput?this.searchContainer=this.selection=t=this.container:(this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n));var i=this;this.selection.on("mousedown",".select2-search-choice",function(){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+N()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),r=n.next(".select2-search-choice:not(.select2-locked)"),o=h(this.search);if(n.length&&(e.which==T.LEFT||e.which==T.RIGHT||e.which==T.BACKSPACE||e.which==T.DELETE||e.which==T.ENTER)){var a=n;return e.which==T.LEFT&&i.length?a=i:e.which==T.RIGHT?a=r.length?r:null:e.which===T.BACKSPACE?(this.unselect(n.first()),this.searchWidthTen(),a=i.length?i:r):e.which==T.DELETE?(this.unselect(n.first()),this.searchWidthTen(),a=r.length?r:null):e.which==T.ENTER&&(a=null),this.selectChoice(a),f(e),void(a&&a.length||this.open())}if((e.which===T.BACKSPACE&&1==this.keydowns||e.which==T.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void f(e);if(this.selectChoice(null),this.opened())switch(e.which){case T.UP:case T.DOWN:return this.moveHighlight(e.which===T.UP?-1:1),void f(e);case T.ENTER:return this.selectHighlighted(),void f(e);case T.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case T.ESC:return this.cancel(e),void f(e)}if(e.which!==T.TAB&&!T.isControl(e)&&!T.isFunctionKey(e)&&e.which!==T.BACKSPACE&&e.which!==T.ESC){if(e.which===T.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===T.PAGE_UP||e.which===T.PAGE_DOWN)&&f(e),e.which===T.ENTER&&f(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.useExistingInput||this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){if(!this.opts.useExistingInput){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e===t||0!==this.getVal().length&&!this.opts.forcePlaceholder||this.search.hasClass("select2-focused")!==!1?(this.search.val(""),this.searchWidthTen()):(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width")))}},searchWidthTen:function(){this.opts.useExistingInput||this.search.width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var i=[],r=[],o=this;e(t).each(function(){n(o.id(this),i)<0&&(i.push(o.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.searchWidthTen()):this.countSelectableResults()>0?(this.searchWidthTen(),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.searchWidthTen()),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r,o=!n.locked,a=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?a:s,u=this.id(n),c=this.getVal();i=this.opts.formatSelection(n,l.find("div"),this.opts.escapeMarkup),i!=t&&l.find("div").replaceWith("<div>"+i+"</div>"),r=this.opts.formatSelectionCssClass(n,l.find("div")),r!=t&&l.addClass(r),o&&l.find(".select2-search-choice-close").on("mousedown",f).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),f(t))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",n),l.insertBefore(this.searchContainer),c.push(u),this.setVal(c)},unselect:function(e){var t,i,r=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),t&&(i=n(this.id(t),r),i>=0&&(r.splice(i,1),this.setVal(r),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))},postprocessResults:function(e,t,i){var r=this.getVal(),o=this.results.find(".select2-result"),a=this.results.find(".select2-result-with-children"),s=this;o.each2(function(e,t){var i=s.id(t.data("select2-data"));n(i,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),a.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&i!==!1&&s.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&S(s.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+s.opts.formatNoMatches(s.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-a(this.search)},resizeSearch:function(){if(!this.opts.useExistingInput){var e,t,n,i,r,o=a(this.search);e=g(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,r=n-(t-i)-o,e>r&&(r=n-o),40>r&&(r=n-o),0>=r&&(r=e),this.search.width(r)}},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),o(e,this.opts.separator))},setVal:function(t){if(!this.opts.useExistingInput){var i;this.select?this.select.val(t):(i=[],e(t).each(function(){n(this,i)<0&&i.push(this)}),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))}},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)r(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var r,o=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),i&&o.triggerChange(this.buildChangeDetails(r,this.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,r,o=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(r=this.data(),t||(t=[]),i=e.map(t,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(r,this.data())),void 0)}}),e.fn.select2=function(){var i,r,o,a,s,l=Array.prototype.slice.call(arguments,0),u=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","readonly","positionDropdown","data","search"],c=["val","opened","isFocused","container","data"],d={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])i=0===l.length?{}:e.extend({},l[0]),i.element=e(this),"select"===i.element.get(0).tagName.toLowerCase()?s=i.element.prop("multiple"):i.useExistingInput?(i.multiple||i.maximumSelectionSize||(i.maximumSelectionSize=1),s=i.multiple=!0):(s=i.multiple||!1,"tags"in i&&(i.multiple=s=!0)),r=s?new P:new D,r.init(i);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(n(l[0],u)<0)throw"Unknown method: "+l[0];if(a=t,r=e(this).data("select2"),r===t)return;if(o=l[0],"container"===o?a=r.container:"dropdown"===o?a=r.dropdown:(d[o]&&(o=d[o]),a=r[o].apply(r,l.slice(1))),n(l[0],c)>=0)return!1}}),a===t?this:a},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var r=[];return y(e.text,n.term,r,i),r.join("")},formatSelection:function(e,n,i){return e?i(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(){return t},formatSelectionCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return(""+t).toUpperCase().indexOf((""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:A,escapeMarkup:_,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:b,local:w,tags:C},util:{debounce:u,markMatch:y,escapeMarkup:_},"class":{"abstract":R,single:D,multi:P}}}}(jQuery),function(){this.Search||(this.Search={})}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/coauthor_search_cant_find"]=function(){var e=[];return e.push('<div class="bootstrap"><div class="select2-footer"><div class="margin-vertical-3x"><p>&nbsp; Can\'t Find Your Co-Author?</p><button type="submit" onclick="jQuery(\'input#authors-input\').trigger(\'select2-footer-clicked\');jQuery(\'input#work-edit-modal-coauthors-input\').trigger(\'select2-footer-clicked\');" class="btn btn-primary text-bold margin-left-4x">Add Co-Author</button></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/create_department"]=function(){var e=[];return e.push('<div id="affiliation-editor-create-department-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header text-center"><button aria-label="Close" data-dismiss="modal" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Create Department</h4></div><div class="modal-body text-center"><form class="form-inline"><input placeholder="Enter department name..." class="form-control text-slim"/><button type="submit" class="btn btn-primary text-bold margin-left-4x">ADD</button></form></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/create_ri_modal"]=function(){var e=[];return e.push('<div id="ri-search-create-ri-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header text-center"><button aria-label="Close" data-dismiss="modal" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Create Research Interest</h4></div><div class="modal-body text-center"><form class="form-inline"><input placeholder="Enter a research interest..." class="form-control text-slim"/><button type="submit" class="btn btn-primary text-bold create-ri-submit-btn">ADD</button></form></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/research_interest_result"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="media_v2"><div class="media-body media-middle"><small class="text-truncate">'+jade.escape(null==(t=i.name)?"":t)+'</small></div><div class="media-right"><small class="text-gray text-slim">'+jade.escape(null==(t=e.commaizeInt(i.followers))?"":t)+"&nbsp;"+jade.escape(null==(t=e.pluralize(i.followers,"follower"))?"":t)+"</small></div></div>")}.call(this,"$h"in i?i.$h:"undefined"!=typeof $h?$h:void 0,"ri"in i?i.ri:"undefined"!=typeof ri?ri:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["search/templates/user_result"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="media_v2"><div class="media-left media-middle"><img'+jade.attr("src",e.profile_pic_url,!0,!1)+' onerror="if (this.src != \'/images/s65_no_pic.png\') this.src = \'/images/s65_no_pic.png\';" class="avatar-lg"/></div><div class="select2-user-info media-body media-middle text-truncate"><div class="select2-user-name text-bold">'+jade.escape(null==(t=e.name)?"":t)+'</div><div class="select2-user-university">'+jade.escape(null==(t=e.university)?"":t)+"</div></div></div>")}.call(this,"user"in i?i.user:"undefined"!=typeof user?user:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.Base=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{minimumInputLength:2,matcher:function(){return!0},formatResult:this.formatResult,formatResultCssClass:this.formatResultCssClass,formatSelection:this.formatSelection}),_.defaults(e.ajax,{dataType:"json",quietMillis:100}),this.$el.select2(e).on("change",function(e){return function(t){return e.change(t)}}(this)).on("select2-opening",function(e){return function(){return e.opening()}}(this)).on("select2-open",function(e){return function(){return e.open()}}(this)).on("select2-close",function(e){return function(){return e.close()}}(this)),this.collection?(this.resetData(),this.listenTo(this.collection,"add remove change error",this.resetData,this)):void 0},n.prototype._getDefaults=function(){},n.prototype.change=function(e){var t;return(t=e.added)?this.trigger("item-selected",t):(t=e.removed)?this.trigger("item-removed",t):void 0},n.prototype.currentSearchString=function(){return this.$el.select2("container").find(".select2-search-field input").val()},n.prototype.resetData=function(){return this.$el.select2("data",this.collection.models)},n.prototype.opening=function(){},n.prototype.open=function(){},n.prototype.close=function(){},n.prototype.formatSelection=function(){},n.prototype.formatResult=function(){},n.prototype.formatResultCssClass=function(){},n.prototype.parse=function(){},n.prototype.remove=function(){return this.$el.select2("destroy"),n.__super__.remove.apply(this,arguments)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;this.Search.UserSearch=function(n){function i(){return this.formatResult=e(this.formatResult,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.resultTemplate="search/templates/user_result",i.prototype.initialize=function(e){return _.defaults(e,{tags:[],multiple:!0,ajax:{url:"/users/search",data:function(t){return function(n){return{q:n,hide_users:t._hideUsers().join(","),include_contacts:null!=e?e.includeContacts:void 0,limit:null!=e?e.limit:void 0}}}(this),results:function(e){return function(t){return{results:_.map((null!=t?t.results:void 0)||[],e.parse,e)}}}(this)}}),i.__super__.initialize.apply(this,arguments)},i.prototype._hideUsers=function(){return[$current_user.id]},i.prototype.formatSelection=function(e,t,n){return n(e.get("name"))},i.prototype.formatResult=function(e){return JST[this.resultTemplate]({user:e.toJSON()})},i.prototype.formatResultCssClass=function(){return"select2-user-result bordered-search-result bootstrap"},i.prototype.parse=function(e){var t;return t=new Backbone.Model(e),t.get("profile_pic_url")||t.set("profile_pic_url","/images/s65_no_pic.png"),t.get("id")&&!t.get("university")&&t.set("university","Independent"),t},i}(this.Search.Base)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CoauthorSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{includeContacts:!0,placeholder:"Add co-authors...",formatNoMatches:this.trackNoResults,id:function(e){return e.get("email")}}),this.on("item-selected",this.addCoauthor,this),this.on("item-removed",this.removeCoauthor,this),n.__super__.initialize.apply(this,arguments)},n.prototype.opening=function(){var e;return e=JST["search/templates/coauthor_search_cant_find"](),this.$el.select2("container").find("div.select2-drop").append(e)},n.prototype.trackNoResults=function(){return"undefined"!=typeof heap&&null!==heap?heap.track("Coauthor search: no results"):void 0},n.prototype._hideUsers=function(){return this.collection.pluck("tagged_user_id").concat(n.__super__._hideUsers.apply(this,arguments))},n.prototype.addCoauthor=function(e){return this.collection.add(Works.CoauthorTag.fromUserSearch(e))},n.prototype.removeCoauthor=function(e){return this.collection.remove(e)},n}(this.Search.UserSearch)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CreateDepartment=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="search/templates/create_department",n.prototype.events={"shown.bs.modal":"_focusInput",submit:"_handleSubmit"},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.$modal=this.$("#affiliation-editor-create-department-modal"),this.$input=this.$("input"),$("body").append(this.$el),this},n.prototype.show=function(e){return this.$input.val(e),this.$modal.modal("show")},n.prototype._handleSubmit=function(e){return e.preventDefault(),this.options.save(this.$input.val()),this.$modal.modal("hide"),!1},n.prototype._focusInput=function(){return this.$input.focus()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.CreateRIModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="search/templates/create_ri_modal",n.prototype.className="bootstrap",n.prototype.events={"shown.bs.modal":"_focusInput",submit:"_handleSubmit"},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.$modal=this.$("#ri-search-create-ri-modal"),this.$input=this.$("input"),$("body").append(this.$el),this},n.prototype.show=function(e){return this.$input.val(e),this.$modal.modal("show")},n.prototype._handleSubmit=function(){return this.collection.add(new Backbone.Model({name:this.$input.val(),followers:0})),this.$modal.modal("hide"),!1},n.prototype._focusInput=function(){return this.$input.focus()},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.DepartmentSearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){var t,i;return this.universityId=e.universityId,this.allowCreation=e.allowCreation,t=e.department,(null!=t?t.name:void 0)&&(i={id:t.id||-1,name:t.name}),_.defaults(e,{placeholder:"Department",ajax:{url:"/ac_university_departments/"+this.universityId,data:function(){return function(e){return{q:e}}}(this),results:function(){return function(e){return{results:e.results}}}(this)},initSelection:function(e,t){return i?t(i):void 0}}),this.allowCreation&&(this.createNewView=new Search.CreateDepartment({save:function(e){return function(t){return e.$el.select2("data",{id:-1,name:t},!0)}}(this)}),this.createNewView.render()),n.__super__.initialize.apply(this,arguments),i?this.$el.select2("data",i,!0):void 0},n.prototype.formatSelection=function(e,t,n){return n(e.name)},n.prototype.formatResult=function(e,t,n,i){return i(e.name)},n.prototype.opening=function(){return this.allowCreation?this._addCreateNewButtonToFooter(this.$el.select2("container").find(".select2-drop")):void 0},n.prototype._addCreateNewButtonToFooter=function(e){return e.find("#affiliation-editor-create-department-btn").length>0?void 0:(e.append('<div class="select2-footer"> <a id="affiliation-editor-create-department-btn" class="text-gray-dark">'+I18n.t("department_search.create_new")+"</a> </div>"),e.find("#affiliation-editor-create-department-btn").click(function(e){return function(){return e.createNewView.show(e.currentSearchString()),e.$el.select2("close")}}(this)))},n}(this.Search.Base)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;this.Search.ResearchInterestSearch=function(n){function i(){return this.formatResult=e(this.formatResult,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.resultTemplate="search/templates/research_interest_result",i.prototype.initialize=function(e){return _.defaults(e,{placeholder:"Add a research interest...",multiple:!0,ajax:{url:"/tags/search",data:function(e){return function(t){return{q:t,exclude_tags:JSON.stringify(e.collection.pluck("id"))}}}(this),results:function(e){return function(t){return{results:e._parseSearchResults(t.results)}}}(this)}}),i.__super__.initialize.apply(this,arguments),this.createNewView=new Search.CreateRIModal({collection:this.collection}).render()},i.prototype.opening=function(){return this._addCreateNewButtonToFooter(this.$el.select2("container").find(".select2-drop"))},i.prototype.formatSelection=function(e,t,n){return n(e.get("name"))},i.prototype.formatResult=function(e){return JST[this.resultTemplate]({ri:e.toJSON()})},i.prototype.formatResultCssClass=function(){return"bordered-search-result bootstrap"},i.prototype._parseSearchResults=function(e){return _(e).map(function(e){return new Backbone.Model({id:e.id,name:e.display_name,followers:e.weight})})},i.prototype._addCreateNewButtonToFooter=function(e){return e.append('<div class="bootstrap select2-footer"> <a id="ri-search-create-new-ri" class="text-gray-dark"> Or create a new research interest... </a> </div>'),e.find("#ri-search-create-new-ri").click(function(e){return function(){return e.createNewView.show(e.currentSearchString()),e.$el.select2("close")}}(this))},i}(this.Search.Base)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Search.UniversitySearch=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return _.defaults(e,{placeholder:"University",ajax:{url:"/ac_universities",data:function(){return function(e){return{q:e}}}(this),results:function(){return function(e){return{results:e.results}}}(this)},initSelection:function(t,n){var i;return i=e.university,(null!=i?i.id:void 0)&&(null!=i?i.name:void 0)?n({id:i.id,display_name:i.name}):void 0}}),n.__super__.initialize.apply(this,arguments)},n.prototype.formatSelection=function(e,t,n){return n(e.display_name)},n.prototype.formatResult=function(e,t,n,i){return i(e.display_name)},n}(this.Search.Base)}.call(this),function(){var e;(e=this.Aedu).Auth||(e.Auth={})}.call(this),function(){this.Aedu.Auth.EmailSignupController=function(){function e(e){this.track=e.track,this.init_elements(e.elements),this.init_provided_fields(e.fields),this.notifier=new c.Server.Notification("sutd"),this.init_form()}return e.prototype.init_elements=function(e){return this.elements={},_.each(e,function(e){return function(t,n){return e.elements[n]=$(t)}}(this)),this.elements.submit=this.elements.form.find("[type=submit]")},e.prototype.init_provided_fields=function(e){return _.each(e,function(e){return function(t,n){var i;return i=$(n),null!=t&&i.val(t),e.track?i.on("keypress.tracker",function(t){return i.off("keypress.tracker"),e.notifier.notify({event_type:"started_typing",location:t.target.id,auvid:$auvid})}):void 0}}(this))},e.prototype.init_form=function(){return this.elements.form.on("submit",function(e){return function(t){return e.handle_submission(t)}}(this))},e.prototype.submit_url=function(){var e;return e=this.elements.form.attr("action")},e.prototype.handle_submission=function(){var e;if(!this.submitting)return this.disable_submit(),this.track&&this.notifier.notify({event_type:"attempted_submit",auvid:$auvid}),e=this.elements.form.serializeObject(),e.user_source=UserSource.last(),$.ajax({type:"POST",url:this.submit_url(),data:e,dataType:"json",xhrFields:{withCredentials:!0}}).always(function(e){return function(){return e.elements.spinner.hide(),e.enable_submit()}}(this)).done(function(e){return function(t){var n,i,r;return r=t[0],n=t[1],i=t[2],r?e.redirect_on_success(n.redirect):e.handle_validation_errors(i)}}(this)).fail(function(){return function(){return alert("Oops... Something just went wrong! We're taking a look at the issue right now. Please try again in a few minutes.")}}(this)),this.elements.spinner.show(),!1},e.prototype.disable_submit=function(){return this.submitting=!0,this.elements.submit.attr("disabled",!0)},e.prototype.enable_submit=function(){return this.submitting=!1,this.elements.submit.attr("disabled",!1)},e.prototype.redirect_on_success=function(e){return null==e&&(e="/StartRegPath"),window.parent.location.href=e},e.prototype.handle_validation_errors=function(e){return this.displayErrors(e),$(document).trigger("set_iframe_size"),this.notifier.notify({event_type:"validation_failure",error:JSON.stringify(e),auvid:$auvid})
},e.prototype.renderErrorHTML=function(e){return"<div class='js-signup-input-inner-error signup-input-inner-error u-tcRed a-fadeInDownShort u-fs11'>"+e+"</div>"},e.prototype.displayErrors=function(e){var t,n,i,r,o;return t=$('[name="user[email]"]'),n=$('[name="user[first_name]"]'),r=$('[name="user[last_name]"]'),o=$('[name="user[password]"]'),i=t.add(n).add(r).add(o),i.removeClass("TextInput--error").addClass("TextInput--dark").css({"padding-top":0}),$(".js-signup-input-inner-error").remove(),_.each(e,function(e){return function(i){var a,s;return s=i[0],a=i[1],"user[email]"===s&&e.showErrorForInput(t,a),"user[first_name]"===s&&e.showErrorForInput(n,a),"user[last_name]"===s&&e.showErrorForInput(r,a),"user[password]"===s?e.showErrorForInput(o,a):void 0}}(this))},e.prototype.showErrorForInput=function(e,t){return e.addClass("TextInput--error").removeClass("TextInput--dark").after(this.renderErrorHTML(t.replace(/\.$/g,""))).css({"padding-top":10})},e}()}.call(this),function(){this.Aedu.Auth.OAuthAdapter=function(){function e(e){_.extend(this,Backbone.Events),this.provider=e}return e.prototype.login=function(e){return null==e&&(e={}),this._authorize().done(function(t){return function(n){var i;return i=$login_protocol+"://"+window.location.host+"/sessions",t._post(i,n,e)}}(this))},e.prototype.register=function(e){return null==e&&(e={}),this._authorize().done(function(t){return function(n){var i,r;return r=$login_protocol+"://"+window.location.host+"/registrations",i=_.extend({user_source:UserSource.last()},e),t._post(r,n,i)}}(this))},e.prototype._authorize=function(){return this.trigger("oauth:attempt"),this._authorizeForProvider().fail(function(e){return function(){return e.trigger("oauth:canceled")}}(this)).done(function(e){return function(){return e.trigger("oauth:authorized")}}(this))},e.prototype._post=function(e,t,n){return $.ajax({type:"POST",url:e,data:_.extend({provider:this.provider,oauth:{token:t.access_token||t.accessToken,expires:t.expires_in||t.expiresIn,scopes:this._scopesForProvider()}},n),dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){return function(t){var n,i;return i=t[0],n=t[1],i?e.trigger("oauth:success",n):(null!=n?n.email:void 0)?e.trigger("oauth:email_taken",n):e.trigger("oauth:invalid",n)}}(this)).fail(function(e){return function(){return e.trigger("oauth:error")}}(this))},e.prototype._scopesForProvider=function(){var e;switch(this.provider){case"google":return null!=(e=Google.last_successful_auth_response)?e.scope:void 0;case"facebook":return Facebook.scope()}},e.prototype._authorizeForProvider=function(){switch(this.provider){case"google":return Google.authorize();case"facebook":return Facebook.authorize()}},e}()}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Auth.OauthButton=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var i;return e(n,t),i=2e3,n.prototype.errorTemplate="auth/templates/oauth_error",n.prototype.events={click:"debouncedHandleClick"},n.prototype.initialize=function(e){return n.__super__.initialize.apply(this,arguments),this.adapter=new Aedu.Auth.OAuthAdapter(this.provider()),this.debounceClickHandler(),this.listenToOAuthEvents(),this.redirectPath=e.redirectPath,e},n.prototype.debounceClickHandler=function(){return this.debouncedHandleClick=_.debounce(function(e){return function(t){return e.handleClick(t)}}(this),i,!0)},n.prototype.handleClick=function(e){return e.preventDefault(),this.attemptOAuthConnect()},n.prototype.attemptOAuthConnect=function(){},n.prototype.provider=function(){},n.prototype.listenToOAuthEvents=function(){},n.prototype.prettyProvider=function(){return $h.capitalize(this.provider())},n.prototype.displayError=function(e){var t,n;return null!=(n=this.$errorModal)&&n.remove(),t=JST[this.errorTemplate]({message:e}),$("#bootstrap-modal-container").append(t),this.$errorModal=$("#oauth-error-modal"),this.$errorModal.modal("show")},n.prototype.redirectToLoginWithPrefilledEmail=function(e){return window.parent.location.href=$a.build_url("/login",[["login",e],["email_was_taken",!0],["provider",this.prettyProvider()]])},n}(Backbone.View),Aedu.Auth.OauthButton.Login=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.attemptOAuthConnect=function(){return this.adapter.login(this.provider())},n.prototype.listenToOAuthEvents=function(){return this.listenTo(this.adapter,"oauth:success",function(){return window.parent!==window?window.parent.location.reload():window.location.href=this.successRedirectUrl()}),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(t){return e.redirectToLoginWithPrefilledEmail(t.email)}}(this)),this.listenTo(this.adapter,"oauth:invalid",function(e){return function(){return e.displayError("We couldn't find an Academia.edu account matching your "+e.prettyProvider()+" account.<br/><br/>Please choose a different login method or <a href='/signup'>create an account</a>.")}}(this)),this.listenTo(this.adapter,"oauth:error",function(e){return function(){return e.displayError("Sorry, something went wrong! We're looking into it now.<br/><br/>Please choose a different login method or try again in a few minutes.")}}(this))},n.prototype.successRedirectUrl=function(){return this.redirectPath?this.redirectPath:window.parent!==window?window.parent.location.href:/\/(login|signup)/.test(document.location.pathname)?"/":document.location.href},n}(Aedu.Auth.OauthButton),Aedu.Auth.OauthButton.Login.Facebook=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"facebook"},n}(Aedu.Auth.OauthButton.Login),Aedu.Auth.OauthButton.Login.Google=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"google"},n}(Aedu.Auth.OauthButton.Login),Aedu.Auth.OauthButton.Connect=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.extraRegParams=(null!=e?e.registrationParams:void 0)||{},n.__super__.initialize.apply(this,arguments)},n.prototype.attemptOAuthConnect=function(){return this.adapter.register(this.extraRegParams)},n.prototype.listenToOAuthEvents=function(){return this.listenTo(this.adapter,"oauth:success",function(e){return(null!=e?e.redirect:void 0)?window.parent.location.href=e.redirect:window.parent.location.reload()}),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(t){return e.redirectToLoginWithPrefilledEmail(t.email)}}(this)),this.listenTo(this.adapter,"oauth:error oauth:invalid",function(e){return function(){return e.displayError("Sorry, something went wrong! We're looking into it now.<br/><br/>Please choose a different signup method or try again in a few minutes.")}}(this)),this.options.track?this.trackEvents():void 0},n.prototype.trackEvents=function(){return this.listenTo(this.adapter,"oauth:attempt",function(e){return function(){return e.notify(e.eventType())}}(this)),this.listenTo(this.adapter,"oauth:success",function(e){return function(){return e.notify(e.eventType()+"_complete")}}(this)),this.listenTo(this.adapter,"oauth:email_taken",function(e){return function(){return e.notify("email_was_taken")}}(this)),this.listenTo(this.adapter,"oauth:canceled",function(e){return function(){return e.notify(e.eventType()+"_cancelled")}}(this))},n.prototype.notify=function(e){return this.notifier||(this.notifier=new c.Server.Notification("sutd")),this.notifier.notify({event_type:e,auvid:$auvid})},n.prototype.eventType=function(){},n}(Aedu.Auth.OauthButton),Aedu.Auth.OauthButton.Connect.Facebook=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"facebook"},n.prototype.eventType=function(){return"fb_connect"},n}(Aedu.Auth.OauthButton.Connect),Aedu.Auth.OauthButton.Connect.Google=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.provider=function(){return"google"},n.prototype.eventType=function(){return"google_connect"},n}(Aedu.Auth.OauthButton.Connect)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Aedu.Auth.SignupWallController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.events={"click .js-signup-login-button":"handleLogin","click .js-signup-open-email-form":"showEmailForm"},n.prototype.initialize=function(){return this.notifier=new c.Server.Notification("sutd"),this.initResize()},n.prototype.handleLogin=function(e){var t,n,i;return e.preventDefault(),t=window.parent.location,i=[["post_login_redirect_path",t.href]],n=$a.build_url("/login",i),t.href=n},n.prototype.initResize=function(){return $(document).bind("set_iframe_size",function(e){return function(){return e.triggerResize()}}(this))},n.prototype.triggerResize=function(){return top.$(top.document).trigger("resize_boxy",this.newHeight())},n.prototype.newHeight=function(){return this.$el.parent("body").height()},n.prototype.showEmailForm=function(){return $(".js-signup-email-form-container").removeClass("u-displayNone"),$(".js-signup-connect-buttons").addClass("u-displayNone"),this.triggerResize()},n}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["auth/templates/oauth_error"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div id="oauth-error-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-body"><button aria-label="Close" data-dismiss="modal" class="pull-right close"><span aria-hidden="true">&times;</span></button><div class="padding-4x text-bold">'+(null==(t=e)?"":t)+"</div></div></div></div></div>")}.call(this,"message"in i?i.message:"undefined"!=typeof message?message:void 0),n.join("")}}.call(this),function(){this.Messages={send_message:function(e){var t;return t=e.data,$.ajax({type:"POST",dataType:"json",url:$r.api_v0_messages_path({subdomain_param:"api"}),data:t})},is_blocked:function(e){var t;return t=$r.api_v0_user_blocks_path({user_id:$current_user.id,recipient_id:e,subdomain_param:"api"}),$.ajax(t)}}}.call(this),function(){this.JST||(this.JST={}),this.JST["messages/templates/form"]=function(e){var t=[],n=e||{};return function(n){t.push('<style>.recipient-input .select2-input {\n  width: 520px !important;\n}\n\n</style><form class="new_message DesignSystem"><div class="row"><div class="col-xs-12"><input type="hidden" name="message[sender_id]"'+jade.attr("value",n.id,!0,!1)+"/>"),t.push(e.message_thread_id?'<input type="hidden" name="message[message_thread_id]"'+jade.attr("value",e.message_thread_id,!0,!1)+"/>":'<div class="input recipient"><input type="hidden" name="message[recipient_id]"'+jade.attr("value",e.recipient_id,!0,!1)+' class="recipient-input u-mb5x"/></div>'),t.push('<div class="input body"><textarea rows="4" name="message[body]" class="autoexpand_on_focus TextArea u-mb5x"></textarea></div><button data-loading-text="&lt;i class=&quot;fa fa-spinner fa-spin&quot;&gt;&lt;/i&gt;" class="Button Button--blue submit-reply-button">Send</button></div></div></form>')}.call(this,"$current_user"in n?n.$current_user:"undefined"!=typeof $current_user?$current_user:void 0),t.join("")}}.call(this),function(){Messages.FormView=function(){function e(e,t){this.data=e,this.success=t,this.placeholder=this.data.placeholder||"Write a message"}return e.prototype.render=function(){return JST["messages/templates/form"](this.data)},e.prototype.after_render=function(e){var t,n,i;return i=e.find(".new_message"),n=i.find(".submit-reply-button"),t=i.find("textarea"),t.attr("placeholder",this.placeholder),t.autosize({callback:function(){return i.trigger("resize_modal")}}),this.data.message_thread_id||new Messages.RecipientFinder(i.find(".recipient-input")),n.on("click",function(e){return function(t){return t.preventDefault(),n.button("loading"),Messages.send_message({data:i.serialize()}).always(function(){return n.button("reset")}).done(function(){return"function"==typeof e.success?e.success.apply(e,arguments):void 0}).error(function(e){var t,i,r;return r=JSON.parse(e.responseText),r.errors&&(i=$a.errors_array(r.errors),t=i[0]),t||(t="Sorry, an error occurred. Please try again."),$w.flash(t,{nextTo:n,visibleMS:2e3})})}}(this))},e}()}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Messages.ModalFormView=function(t){function n(e){this.form_view=new Messages.FormView({recipient_id:e},function(e){return window.location.href=e.message.message_thread_url}),n.__super__.constructor.call(this,{title:"Send a Message",contents:this.form_view.render(),width:"550px",close_on_esc:!1}),this.on("shown",function(e){return function(){return e.form_view.after_render(e.$el)}}(this))}return e(n,t),n}(Widgets.ModalBox)}.call(this),function(){var e;e=function(e,t,n){var i;return e?(i=t.find("i.fa"),i.addClass("fa-spinner fa-spin"),Messages.is_blocked(e).always(function(){return i.removeClass("fa-spinner fa-spin")}).done(function(e){return e.blocked?$w.flash("You cannot message "+e.name+".",{nextTo:t,visibleMS:2e3}):n()})):void n()},$(document).on("click","*[data-send-message]",function(t){var n,i;return t.preventDefault(),n=$(t.currentTarget),i=n.data("recipient-id"),n.data("message-view")||n.data("message-view",new Messages.ModalFormView(i)),e(i,n,function(){return n.data("message-view").show()})})}.call(this),function(){Messages.RecipientFinder=function(){function e(e){this.el=e,this._initialValue().always(function(e){return function(t){return e._initAutocomplete(null!=t?t.recipient:void 0)}}(this))}return e.prototype._initAutocomplete=function(e){var t;return new Search.UserSearch({el:this.el,placeholder:"Choose a recipient",minimumInputLength:0,maximumSelectionSize:5,limit:25}),this.el.trigger("resize_modal"),t=this.el.data("select2"),e&&t.updateSelection(new Backbone.Model(e)),t.search.on("keyup",function(){return function(e){return 27===e.keyCode?(e.stopPropagation(),t.cancel()):void 0}}(this))},e.prototype._initialValue=function(){var e;return(e=this.el.val())?$.ajax({url:$r.recipient_api_v0_messages_path({id:e,subdomain_param:"api"}),dataType:"json"}):{always:function(e){return e()}}},e}()}.call(this),Aedu.Premium=Aedu.Premium||{},function(){Aedu.Premium.IntroducingPremiumTeaser=React.createClass({displayName:"IntroducingPremiumTeaser",render:function(){return React.createElement("div",{className:"DesignSystem"},React.createElement("div",{className:"u-ph12x u-pv16x"},React.createElement("div",{className:"container-fluid"},this.renderLogo(),this.renderTitle(),this.renderDescription(),this.renderCheckboxes(),this.renderButtons())))},renderLogo:function(){return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12 u-taCenter"},React.createElement("img",{src:$image_url("academia-logo-redesign-2015-A_yellow.svg"),style:{height:32}})))},renderTitle:function(){return React.createElement("div",{className:"row u-mt8x"},React.createElement("div",{className:"col-xs-12 u-taCenter u-fs24 u-fw900 u-tcGrayDarkest"},"Introducing Academia Premium"))},renderDescription:function(){return React.createElement("div",{className:"row u-mt8x"},React.createElement("div",{className:"col-xs-12 u-taCenter u-fontSerif u-tcGrayDarker u-fs13"},"The mission of Academia is to put every academic paper on the internet, available for free, and to enhance discussion and collaboration around papers. Over 300 million people read papers on Academia every year and the majority of those readers are from the developing world. In order for us to achieve our mission, we have to develop a sustainable business model. This is why we are introducing Academia Premium. Academia Premium is for people who want extra features on Academia, and for people who want to support innovation on Academia."))},renderCheckboxes:function(){return React.createElement("div",null,React.createElement("div",{className:"row u-mt8x"},this.renderCheckbox("Support Our Mission"),this.renderCheckbox("See Your Bookmarkers",!0),this.renderCheckbox("Advanced Paper Search",!0)),React.createElement("div",{className:"row u-mt3x"},this.renderCheckbox("Expanded Visitor Data"),this.renderCheckbox("Impact Statistics",!0),this.renderCheckbox("Name & Paper Mentions",!0)))},renderCheckbox:function(e,t){var n=classNames("col-xs-4 u-fs11 u-tcGrayDarker",{"u-pl0x":t});return React.createElement("div",{className:n},React.createElement("i",{className:"fa fa-check u-tcYellow u-mr1x"}),e)},renderButtons:function(){return React.createElement("div",{className:"row u-mt8x"},React.createElement("div",{className:"col-xs-6"},React.createElement("button",{className:"Button Button--block Button--lg Button--inverseGray","data-dismiss":"modal"},"Close")),React.createElement("div",{className:"col-xs-6"},React.createElement("a",{className:"Button Button--block Button--lg Button--yellow",href:$r.upgrade_url({trigger:"teaser-modal"})},"Learn More")))}})}(),function(){this.JST||(this.JST={}),this.JST["premium/templates/premium_icon"]=function(e){var t,n=[],i=e||{};return function(e,i,r){n.push('<div class="DesignSystem"><div style="width:330px" class="u-p7x u-taCenter"><div class="u-textUppercase u-tcGrayDark u-letterSpacing0_5">Academia Premium Feature</div><p class="u-mv5x">'+jade.escape(null==(t=e)?"":t)+"</p><a"+jade.attr("href",i,!0,!1)+jade.attr("data-main-header-link-target","premium_popover_link_for_"+r,!0,!1)+' class="Button Button--blue Button--sm">Learn More</a></div></div>')}.call(this,"bodyText"in i?i.bodyText:"undefined"!=typeof bodyText?bodyText:void 0,"learnMoreLinkUrl"in i?i.learnMoreLinkUrl:"undefined"!=typeof learnMoreLinkUrl?learnMoreLinkUrl:void 0,"premiumFeature"in i?i.premiumFeature:"undefined"!=typeof premiumFeature?premiumFeature:void 0),n.join("")}}.call(this),function(){this.ConfirmationBanner={}}.call(this),function(){this.JST||(this.JST={}),this.JST["confirmation_banner/templates/below_nav_view"]=function(e){var t,n=[],i=e||{};return function(e,i,r,o){n.push("<div"+jade.cls(["confirmation-banner-below-nav","text-center",i],[null,null,!0])+'><span class="h5 text-white text-bold"><i'+jade.cls(["fa",r],[null,!0])+"></i>&nbsp;&nbsp;"+jade.escape(null==(t=o)?"":t)+"</span>"),function(){var i=e;if("number"==typeof i.length)for(var r=0,o=i.length;o>r;r++){var a=i[r];n.push("&nbsp;&nbsp;&nbsp;<a"+jade.attr("data-action",a,!0,!1)+' class="h5 text-white text-bold text-underline clickable">'+jade.escape(null==(t=a)?"":t)+"</a>")}else{var o=0;for(var r in i){o++;var a=i[r];n.push("&nbsp;&nbsp;&nbsp;<a"+jade.attr("data-action",a,!0,!1)+' class="h5 text-white text-bold text-underline clickable">'+jade.escape(null==(t=a)?"":t)+"</a>")}}}.call(this),n.push("</div>")}.call(this,"actions"in i?i.actions:"undefined"!=typeof actions?actions:void 0,"bannerClass"in i?i.bannerClass:"undefined"!=typeof bannerClass?bannerClass:void 0,"iconClass"in i?i.iconClass:"undefined"!=typeof iconClass?iconClass:void 0,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["confirmation_banner/templates/overlay_view"]=function(e){var t,n=[],i=e||{};return function(e,i){n.push('<div class="top_banner_flash blue"><i class="close">\xd7</i><div class="actions">'),function(){var i=e;if("number"==typeof i.length)for(var r=0,o=i.length;o>r;r++){var a=i[r];n.push("<a"+jade.attr("data-action",a,!0,!1)+' class="action">'+jade.escape(null==(t=a)?"":t)+"</a>")}else{var o=0;for(var r in i){o++;var a=i[r];n.push("<a"+jade.attr("data-action",a,!0,!1)+' class="action">'+jade.escape(null==(t=a)?"":t)+"</a>")}}}.call(this),n.push('</div><p class="message">'+jade.escape(null==(t=i)?"":t)+"</p></div>")}.call(this,"actions"in i?i.actions:"undefined"!=typeof actions?actions:void 0,"message"in i?i.message:"undefined"!=typeof message?message:void 0,"undefined"in i?i.undefined:void 0),n.join("")}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;ConfirmationBanner.BelowNavView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.defaultFadeout=1500,n.fadeInTime=250,n.fadeOutTime=500,n.defaultAfter="#main-header-container",n.prototype.className="bootstrap",n.prototype.jstTemplate="confirmation_banner/templates/below_nav_view",n.prototype.events={"click *[data-action]":"actionWasClicked"},n.prototype.initialize=function(e){return this.mode=e.mode,this.message=e.message,this.actions=e.actions||{},this.afterElement=$(e.after||this.constructor.defaultAfter),this.fadeout=e.fadeout,this.fadeout===!0&&(this.fadeout=this.constructor.defaultFadeout),"success"===this.mode?(this.bannerClass="bg-success",this.iconClass="fa-check-circle"):"warning"===this.mode?(this.bannerClass="bg-warning",this.iconClass="fa-exclamation-triangle"):void 0},n.prototype.actionWasClicked=function(e){return this.actions[$(e.target).data("action")](),this.fadeout?this.close():void 0},n.prototype.render=function(){return this.$el.html(JST[this.jstTemplate]({message:this.message,actions:_.keys(this.actions),bannerClass:this.bannerClass,iconClass:this.iconClass})),this.afterElement.after(this.$el).fadeIn(this.constructor.fadeInTime),this.fadeout?this.$el.delay(this.fadeout).fadeOut(this.constructor.fadeOutTime):void 0},n.prototype.close=function(){return this.$el.fadeOut(ConfirmationBanner.BelowNavView.fadeOutTime)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;ConfirmationBanner.OverlayView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.defaultFadeout=1500,n.fadeInTime=250,n.fadeOutTime=500,n.prototype.jstTemplate="confirmation_banner/templates/overlay_view",n.prototype.events={"click .close":"closeWasClicked","click .actions .action":"actionWasClicked"},n.prototype.initialize=function(e){return this.message=e.message,this.actions=e.actions||{},this.fadeout=e.fadeout,this.fadeout===!0?this.fadeout=ConfirmationBanner.OverlayView.defaultFadeout:void 0},n.prototype.closeWasClicked=function(){return this.close()},n.prototype.actionWasClicked=function(e){return this.actions[$(e.target).data("action")](),this.close()},n.prototype.render=function(){return $("#site").before(this.$el.html(JST[this.jstTemplate]({message:this.message,actions:_.keys(this.actions)})).fadeIn(ConfirmationBanner.OverlayView.fadeInTime)),this.fadeout?this.$el.delay(this.fadeout).fadeOut(ConfirmationBanner.OverlayView.fadeOutTime):void 0},n.prototype.close=function(){return this.$el.fadeOut(ConfirmationBanner.OverlayView.fadeOutTime)},n}(Backbone.View)}.call(this),function(){var e;(e=this.Aedu).Notifications||(e.Notifications={})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.Notification=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.view=function(){return{el:this.get("html")}},n}(Backbone.Model)}.call(this),function(){var e,t,n,i;e=function(e){return e.data("bs.popover")?void 0:(new Works.CoauthorTagEdit({el:e,model:new Works.CoauthorTag(e.data("suggested-tag"))}),e.mouseenter())},i=function(e){var t;return t=$("*[data-coauthor-suggestion-notification="+e+"]").data("suggested-tag"),new Works.CoauthorTag(t)},t=function(e){var t;return t=e.data("confirm-coauthor-suggestion"),e.html('<i class="fa fa-spinner fa-spin"></i>'),i(t).save().done(function(){return e.html('<i class="fa fa-check"></i>&nbsp;&nbsp;Confirmed'),$("*[data-dismiss-coauthor-suggestion="+t+"]").parent(".notification-message-dismiss").remove()})},n=function(e){var t;return t=e.data("dismiss-coauthor-suggestion"),e.html('<i class="fa fa-spinner fa-spin"></i>'),i(t).rejectAsSuggestion().done(function(){return e.parents(".panel").fadeOut(),e.parents(".notification-popover").fadeOut()})},$(document).on("mouseenter","*[data-coauthor-suggestion-notification]",function(t){return e($(t.currentTarget))}),$(document).on("click","*[data-confirm-coauthor-suggestion]",function(e){return e.preventDefault(),t($(e.currentTarget))}),$(document).on("click","*[data-dismiss-coauthor-suggestion]",function(e){return n($(e.currentTarget))})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.NotificationCollection=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Aedu.Notifications.Notification,n}(Backbone.Collection)}.call(this),function(){var e;e=function(e){return e.button("loading"),$.ajax({type:"POST",url:$r.api_v0_discussion_audience_invitations_path({subdomain_param:"api",discussion_id:e.data("invitation-id")})}).done(function(){return window.location.replace(e.data("discussion-url"))}).fail(function(){return alert("Failure joining session."),e.button("reset")})},$(document).on("click",".js-notification-join-button",function(t){return t.preventDefault(),e($(t.currentTarget))})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.MostRecentNotifications=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.url=$r.api_v0_notifications_path({subdomain_param:"api"}),n.prototype.initialize=function(){return this.set("notifications",new Aedu.Notifications.NotificationCollection)},n.prototype.parse=function(e){return this.get("notifications").add(e.notifications),_.omit(e,"notifications")},n.prototype.fetch=function(e){return e=e||{},this.get("earliest_created_at")&&_.extend(e,{data:{created_before:this.get("earliest_created_at")}}),n.__super__.fetch.call(this,e)},n}(Backbone.Model)}.call(this),function(){this.JST||(this.JST={}),this.JST["notifications/templates/notification_spinner"]=function(){var e=[];return e.push('<div class="js-notifications-spinner"><div class="text-center padding-bottom-4x padding-top-2x"><i class="fa fa-2x fa-spin fa-spinner text-base-color"></i></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["notifications/templates/notifications_container"]=function(e){var t=[],n=e||{};return function(e){t.push('<div id="notifications"><div class="notification-popover"><div class="js-notification-list-location"></div></div><a'+jade.attr("href",e.notifications_url(),!0,!1)+' class="view_all_notifications text-primary">View All Notifications</a></div>')}.call(this,"$r"in n?n.$r:"undefined"!=typeof $r?$r:void 0),t.join("")}}.call(this),$a.trackClickSource(".js-work-added-notification-work-link","notification"),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;Aedu.Notifications.Container=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.template="notifications/templates/notifications_container",n.prototype.initialize=function(){return this.render()},n.prototype.render=function(){var e;return e=new Aedu.Notifications.ListView,this.$el.html(JST[this.template]()),this.ui={$listLocation:this.$(".js-notification-list-location")},this.ui.$listLocation.html(e.$el)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;Aedu.Notifications.ListView=function(n){function i(){return this.maybeFetchNotifications=e(this.maybeFetchNotifications,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.className="js-notification-list notification-list",i.prototype.initialize=function(){return this.mostRecentNotifications=new Aedu.Notifications.MostRecentNotifications,this.notifications=this.mostRecentNotifications.get("notifications"),this.listenTo(this.notifications,"add",this.addNotification),this.enableScrollScope(),this.$el.scroll(this.maybeFetchNotifications),this.fetchNotifications()},i.prototype.enableScrollScope=function(){return Aedu.Behaviors.ScrollScope.enable(this.$el)},i.prototype.fetchNotifications=function(){return this.appendSpinner(),this.mostRecentNotifications.fetch().success(function(e){return function(){return e.resetScroll(),e.infiniteScrollActive=!e.mostRecentNotifications.get("depleted"),e.removeSpinner(),e.markRead(),e.maybeFetchNotifications()}}(this))},i.prototype.appendSpinner=function(){var e;return e=$(JST["notifications/templates/notification_spinner"]()),this.$el.append(e)},i.prototype.resetScroll=function(){return this.isScrollReset?void 0:(this.el.scrollTop=0,this.isScrollReset=!0)},i.prototype.removeSpinner=function(){return this.$(".js-notifications-spinner").remove()},i.prototype.markRead=function(){var e;return e=this.mostRecentNotifications.get("notification_ids"),$.post($r.mark_read_api_v0_notifications_path({subdomain_param:"api",data:JSON.stringify({ids:e})}))},i.prototype.addNotification=function(e){return this.$el.append(e.view().el)},i.prototype.maybeFetchNotifications=function(){return this.infiniteScrollActive&&this.isNearBottom()?(this.infiniteScrollActive=!1,this.fetchNotifications()):void 0},i.prototype.isNearBottom=function(){var e;return e=20,this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight-e},i}(Backbone.View)}.call(this),function(){this.Works||(this.Works={})}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTag=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.fromUserSearch=function(e,t){return null==t&&(t={}),new Works.CoauthorTag({name:e.get("name"),email:e.get("email"),encrypted_email:e.get("encrypted_email"),affiliation:e.get("university"),tagged_user_id:e.get("id"),source:e.get("source")||(null!=t?t.source:void 0),source_details:e.get("source_details")||{name:"search",email:"search"}},t)},n.prototype.initialize=function(e){return e?(n.__super__.initialize.call(this,_.omit(e,"display_name","coauthor_email")),e.display_name&&this.set("name",e.display_name),e.coauthor_email&&this.set("email",e.coauthor_email),this.set("orig_email",this.get("email"))):void 0},n.prototype.validate=function(e){var t;return t={},this._validateNamePresence(e)||(t.name="You must provide your co-author's name."),this._validateNameLength(e)||t.name||(t.name="Your co-author's name can't be longer than 240 characters."),this._validateEmailPresence(e)||(t.email="To tag your co-author, you must provide their email."),this._validateEmailFormat(e)||t.email||(t.email="Your co-author's email appears to be invalid."),_.size(t)>0?t:void 0},n.prototype._validateNamePresence=function(e){return e.name&&e.name.length>0},n.prototype._validateNameLength=function(e){return e.name&&e.name.length<240},n.prototype._validateEmailPresence=function(e){return e.email&&e.email.length>0},n.prototype._validateEmailFormat=function(e){return e.email===this.get("orig_email")?!0:e.email&&$h.validEmail(e.email,{strict:!0})},n.prototype.save=function(e,t){var i;return null==t&&(t={}),t.url||(t.url=null!=(i=this.collection)?i.url():void 0),this.has("work_id")&&(t.url||(t.url=$r.api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.get("work_id")}))),n.__super__.save.call(this,e,t)},n.prototype.rejectAsSuggestion=function(){return this.has("work_id")?$.post(this.suggestionUrl(),{work_id:this.get("work_id"),tagged_user_id:this.get("tagged_user_id"),name:this.get("name"),email:this.get("email"),encrypted_email:this.get("encrypted_email"),source:this.get("source"),source_details:this.get("source_details"),accepted:!1}):void 0
},n.prototype.url=function(){return $r.api_v0_work_co_author_tag_path({id:this.get("id"),work_id:this.get("work_id"),subdomain_param:"api"})},n.prototype.suggestionUrl=function(){return $r.api_v0_suggestions_coauthors_path({subdomain_param:"api"})},n.prototype.uniqueEmail=function(){return this.get("encrypted_email")||this.get("email")},n}(Backbone.Model)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTags=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Works.CoauthorTag,n.prototype.initialize=function(e,t){var n,i;return null==e&&(e=[]),null==t&&(t={}),this.workId=t.work_id,this.source=t.source,this.on("remove",function(){return function(e){return e.rejectAsSuggestion()}}(this)),this.comparator=function(e){return e.has("display_order")?e.get("display_order"):1/0},(this.owner=t.includeOwner)&&(e.push(this._dummyOwnerAuthorTag()),this.on("sync",function(e){return function(){return e._addDummyOwnerAuthorTag()}}(this))),e=_.map(e,function(e){return function(t){return e._prepareModel(t)}}(this)),(null!=(n=this.owner)?n.id:void 0)!==(null!=(i=Aedu.User.current)?i.id:void 0)?(this._lockNonEditableTags(e),this.on("sync",function(e){return function(){return e._lockNonEditableTags()}}(this))):void 0},n.prototype._prepareModel=function(e){return(e=n.__super__._prepareModel.apply(this,arguments))?(null==this.source||e.has("source")||e.set("source",this.source),null==this.workId||e.has("work_id")||e.set("work_id",this.workId),e.has("display_order")||e.set("display_order",this.length),e):void 0},n.prototype._addDummyOwnerAuthorTag=function(){return this.add(this._dummyOwnerAuthorTag(),{silent:!0}),this.sort()},n.prototype._dummyOwnerAuthorTag=function(e){return null==e&&(e=this.owner),new Works.CoauthorTag({id:e.id,name:e.display_name,email:e.email,display_order:0,locked:!0})},n.prototype._lockNonEditableTags=function(e){return null==e&&(e=this.models),_.each(e,function(e){return e.has("tagging_user_id")&&e.get("tagging_user_id")!==$current_user.id?e.set("locked",!0):void 0})},n.prototype.url=function(){return $r.api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.workId})},n.prototype.parse=function(e){return e.co_author_tags},n.prototype.saveOrdering=function(){return $.ajax({type:"PUT",url:$r.set_order_api_v0_work_co_author_tags_path({subdomain_param:"api",work_id:this.workId}),data:{ordered_emails:this.invoke("uniqueEmail")}})},n}(Backbone.Collection)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.SuggestableTagView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="li",n.prototype.className="bg-white",n.prototype.template="work_tags/templates/suggestable_tag",n.prototype.events={"click .close":"removeModel"},n.prototype.attributes=function(){return{"data-tag-id":this.model.id,"data-last-dragged":!!this.model.get("last_dragged")}},n.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render)},n.prototype.render=function(){return this.$el.html(JST[this.template]({model:this.model.toJSON()})),this},n.prototype.removeModel=function(){return this.model.collection.remove(this.model)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.SuggestableTagsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null==e&&(e={}),this.tagOptions=e.tag_options,this.sortable=e.sortable,n.__super__.initialize.apply(this,arguments),this.listenTo(this.collection,"add remove sort",this.render,this)},n.prototype.render=function(){return this.setupTagViews(),this.initSortable(),this},n.prototype.setupTagViews=function(){return _.invoke(this.tagViews,"remove"),this.tagViews=this.collection.map(function(e){return function(t){return e.viewForModel(t)}}(this)),_.each(this.tagViews,function(e){return function(t){return e.$el.append(t.render().el)}}(this))},n.prototype.initSortable=function(){return this.sortable?(this.$("li").each(function(e){return function(t,n){return $(n).data("sort-index-of-model",e.collection.at(t))}}(this)),this.$el.sortable({containment:"document",items:"li",placeholder:"list-pill-placeholder bg-white",start:function(e){return function(){return e.closePopovers()}}(this),update:function(e){return function(t,n){return e.handleSortingUpdate(t,n)}}(this)})):void 0},n.prototype.handleSortingUpdate=function(e,t){return this.$("li").each(function(e,t){var n;return n=$(t).data("sort-index-of-model"),n.set("display_order",e),n.set("last_dragged",!1)}),t.item.data("sort-index-of-model").set("last_dragged",!0),this.collection.sort()},n.prototype.closePopovers=function(){return this.$(".popover").each(function(e,t){return $(t).data("bs.popover").$element.popover("hide")})},n.prototype.viewForModel=function(e){return new Works.SuggestableTagView(_({model:e}).extend(this.tagOptions))},n.prototype.remove=function(){return _.invoke(this.tagViews,"remove"),n.__super__.remove.apply(this,arguments)},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null!=e.template&&(this.template=e.template),n.__super__.initialize.apply(this,arguments)},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.model.get("locked")||this.addEditView(),this},n.prototype.addEditView=function(){return this.editView||(this.editView=new Works.CoauthorTagEdit({el:this.$el,model:this.model}))},n.prototype.remove=function(){var e;return null!=(e=this.editView)&&e.remove(),n.__super__.remove.apply(this,arguments)},n}(Works.SuggestableTagView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorPicker=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.searchInput=e.searchInput,this.searchView=new Search.CoauthorSearch(_.extend(e.searchOptions||{},{el:this.searchInput,collection:this.collection})),this.inviteModalView=new Works.InviteCoauthorModal({collection:this.collection}).render(),e.instantSave&&this.saveOnAnyChanges(),this.searchView.$el.on("select2-footer-clicked",function(e){return function(){return e.footerClicked()}}(this))},n.prototype.footerClicked=function(){return this.searchInput.select2("close"),this.inviteModalView.show()},n.prototype.saveOnAnyChanges=function(){return this.listenTo(this.collection,"sort",_.debounce(function(e){return function(){return e.collection.saveOrdering()}}(this),500)),this.listenTo(this.collection,"add",function(){return function(e){return e.has("id")?void 0:e.save()}}(this)),this.listenTo(this.collection,"remove",function(){return function(e){return e.has("id")?e.destroy():void 0}}(this))},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagEdit=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(){return n.__super__.initialize.call(this,{html:!0,placement:"top",show_delay:50,hide_delay:200,content:function(e){return function(){return e.content()}}(this),on_shown:function(e){return function(){return e.initUi(e._popover_el())}}(this)})},n.prototype.initUi=function(e){return this.ui={name:e.find(".js-works-coauthor-edit-name"),email:e.find(".js-works-coauthor-edit-email"),buttons:e.find(".js-works-coauthor-save-or-cancel"),save:e.find(".js-works-coauthor-save"),cancel:e.find(".js-works-coauthor-cancel"),errors:e.find(".js-works-coauthor-errors")},this._allowEdit()?this._initListeners():void 0},n.prototype._initListeners=function(){return this.ui.name.click(function(e){return function(){return e._editName()}}(this)),this.ui.name.hover(function(e){return function(){return e._editName()}}(this)),this.ui.email.click(function(e){return function(){return e._editEmail()}}(this)),this.ui.email.hover(function(e){return function(){return e._editEmail()}}(this)),this.ui.save.click(function(e){return function(){return e._save()}}(this)),this.ui.cancel.click(function(e){return function(){return e._hide()}}(this))},n.prototype._allowEdit=function(){return!this.model.has("tagged_user_id")},n.prototype.content=function(){return JST["work_tags/templates/coauthor_tag_edit"]({tag:this.model})},n.prototype._editName=function(){return this._switchToButtons(),this.ui.name.attr("readonly",!1)},n.prototype._editEmail=function(){return this._switchToButtons(),this.ui.email.attr("readonly",!1)},n.prototype._switchToButtons=function(){return this.freeze(),this.ui.buttons.removeClass("hidden")},n.prototype._save=function(){var e,t,n;return e={},this.ui.name.is("readonly")||this.ui.name.val()===this.model.get("name")||(e.name=this.ui.name.val()),this.ui.email.is("readonly")||this.ui.email.val()===this.model.get("email")||(e.email=this.ui.email.val()),n=this.model.clone(),this.model.set(e,{validate:!0})?(n.rejectAsSuggestion(),this._hide()):(t=this.model.validationError)?this._showError(t):void 0},n.prototype._showError=function(e){return e.email?this.ui.email.parent().addClass("has-error"):this.ui.email.parent().removeClass("has-error"),e.name?this.ui.name.parent().addClass("has-error"):this.ui.name.parent().removeClass("has-error"),this.ui.errors.html(""),_(e).each(function(e){return function(t){return e.ui.errors.append($("<div/>")).addClass("alert alert-danger").attr("role","alert").text(t)}}(this))},n}(HoverPopover)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.CoauthorTagsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return null==e&&(e={}),_.defaults(e,{sortable:!0}),n.__super__.initialize.apply(this,arguments)},n.prototype.viewForModel=function(e){return new Works.CoauthorTagView(_({model:e}).extend(this.tagOptions))},n}(Works.SuggestableTagsView)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.InviteCoauthorModal=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="bootstrap",n.prototype.template="work_tags/templates/invite_coauthor_modal",n.prototype.events={"click .js-invite-coauthor-link":"addExternalCoauthor","keydown input":"handleKeydown"},n.prototype.initialize=function(){return this.model=new Works.CoauthorTag({source_details:{name:"manual",email:"manual"}})},n.prototype.render=function(){return this.$el.html(JST[this.template]()),this.setupSelectors(),$("body").append(this.$el),this},n.prototype.setupSelectors=function(){return this.ui={$modal:this.$("#coauthor-search-invite-coauthor-modal"),$coauthorNameInput:this.$("#add-coauthor-name"),$coauthorEmailInput:this.$("#add-coauthor-email"),$alertRow:this.$(".alert-box"),$alertList:this.$(".alert-list"),$formItems:this.$(".form-group")}},n.prototype.show=function(){return this.ui.$modal.modal("show"),this.ui.$coauthorNameInput.focus()},n.prototype.handleKeydown=function(e){return 13===e.keyCode?this.addExternalCoauthor():void 0},n.prototype.addExternalCoauthor=function(){return this.model.set("name",this.getName()),this.model.set("email",this.getEmail()),this.model.isValid()?(this.collection.add(this.model),this.ui.$modal.modal("hide"),this.resetModel()):this.alertValidationErrors()},n.prototype.resetModel=function(){return this.model=new Works.CoauthorTag({source_details:{name:"manual",email:"manual"}}),this.ui.$coauthorNameInput.val(""),this.ui.$coauthorEmailInput.val("")},n.prototype.alertValidationErrors=function(){return this.resetAlerts(),this.insertValidationAlerts(),this.ui.$alertRow.fadeIn()},n.prototype.resetAlerts=function(){return this.ui.$alertRow.hide(),this.ui.$formItems.removeClass("has-error"),this.ui.$alertList.html("")},n.prototype.insertValidationAlerts=function(){return _.each(this.model.validationError,function(e){return function(t,n){var i,r;return"email"===n?e.ui.$coauthorEmailInput.parent().addClass("has-error"):"name"===n&&e.ui.$coauthorNameInput.parent().addClass("has-error"),r=$("<span/>").html(t),i=$("<div/>").addClass("alert").addClass("alert-danger").attr("role","alert").html(r),e.ui.$alertList.append(i)}}(this)),this.model.unset("validationError")},n.prototype.getName=function(){var e,t;return t=this.ui.$coauthorNameInput.attr("placeholder"),e=this.ui.$coauthorNameInput.val(),t===e?"":e},n.prototype.getEmail=function(){var e,t;return t=this.ui.$coauthorEmailInput.attr("placeholder"),e=this.ui.$coauthorEmailInput.val(),t===e?"":e},n}(Backbone.View)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;this.Works.PaperRankView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.workId=e.workId,this.container=e.container,this.setElement($(".js-paper-rank-view[data-paper-rank-work-id="+this.workId+"]")),this.postRender(),this.fetch(function(e){return function(t){return e.handleData(t)}}(this))},n.prototype.render=function(){},n.prototype.postRender=function(){return this.ui={$rankValue:this.$el.find(".js-paper-rank"),$container:$(this.container)}},n.prototype.fetch=function(e){return window.Academia.paperRanksFetcher.queue(this.workId,e)},n.prototype.handleData=function(e){var t;return t=JSON.parse(e),this.handlePaperRank(t)},n.prototype.handlePaperRank=function(e){return e.bragworthy?(this.insertValue(e.value),this.show()):void 0},n.prototype.insertValue=function(e){return this.ui.$rankValue.text(e.toFixed(1))},n.prototype.show=function(){return this.ui.$container.removeClass("hidden"),this.$el.removeClass("hidden")},n}(Backbone.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["work_tags/templates/coauthor_tag_edit"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<div class="container-fluid works-coauthor-edit-popover"><div class="row js-works-coauthor-errors"></div><div class="row"><input readonly="readonly"'+jade.attr("value",e.get("name"),!0,!1)+' class="form-control input-sm input-unstyled-while-readonly text-bold js-works-coauthor-edit-name"/></div><div class="row">'),n.push(e.has("tagged_user_id")&&e.has("affiliation")?'<span class="form-control input-sm input-unstyled-while-readonly text-slim">'+jade.escape(null==(t=e.get("affiliation"))?"":t)+"</span>":e.has("tagged_user_id")?'<span class="form-control input-sm input-unstyled-while-readonly text-slim">'+jade.escape(null==(t=e.get("email"))?"":t)+'&nbsp; &nbsp;<i class="fa fa-check"></i></span>':'<input readonly="readonly"'+jade.attr("value",e.get("email"),!0,!1)+' class="form-control input-sm input-unstyled-while-readonly text-slim js-works-coauthor-edit-email"/>'),n.push('</div><div class="row padding-top-1x hidden js-works-coauthor-save-or-cancel"><div class="col-xs-6 text-left"><div class="row"><a class="btn btn-sm btn-none text-gray-light js-works-coauthor-cancel">Cancel</a></div></div><div class="col-xs-6 text-right"><div class="row"><button class="btn btn-sm btn-success js-works-coauthor-save">Save</button></div></div></div></div>')}.call(this,"tag"in i?i.tag:"undefined"!=typeof tag?tag:void 0),n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_tags/templates/invite_coauthor_modal"]=function(){var e=[];return e.push('<div id="coauthor-search-invite-coauthor-modal" tabindex="-1" role="dialog" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-md"><div class="modal-content"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" type="button" class="close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center"><strong>Invite Co-Authors</strong></h4></div><div class="modal-body"><div class="row alert-box text-center"><div class="col-xs-12 alert-list"></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label for="add-coauthor-name">Name</label><input type="text" id="add-coauthor-name" placeholder="add co-author name..." class="form-control"/></div></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label for="add-coauthor-email">Email</label><input type="text" id="add-coauthor-email" placeholder="add co-author email..." class="form-control"/></div></div></div><div class="row text-center"><div class="col-xs-12"><button type="button" class="btn btn-lg btn-none js-invite-coauthor-link"><i class="fa-plus fa text-gray-dark"></i><span class="h5 text-bold text-gray-dark">&nbsp;&nbsp;ADD CO-AUTHOR</span></button></div></div></div></div></div></div>'),e.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["work_tags/templates/suggestable_tag"]=function(e){var t,n=[],i=e||{};return function(e){n.push('<span class="text-bold text-gray-dark">'+jade.escape(null==(t=e.name)?"":t)+"&nbsp;&nbsp;"),e.locked||n.push('<a type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Remove</span></a>'),n.push("</span>")}.call(this,"model"in i?i.model:"undefined"!=typeof model?model:void 0),n.join("")}}.call(this),function(){var e="undefined"!=typeof FS;if(e&&$a.is_logged_in()){var t={id_int:Aedu.User.current.id,displayName:Aedu.User.current.display_name,email:Aedu.User.current.email,"application.js":AcademiaRequire.assetManifest.assets["application.js"]};_.each(Aedu.User.current.active_rollout_features,function(e){var n="rollout_"+e,i=n.replace(/_([a-zA-Z0-9])/g,function(e){return e[1].toUpperCase()}),r=i+"_bool";t[r]=!0}),FS.identify(Aedu.User.current.id,t)}}(),window.Aedu=window.Aedu||{},window.Aedu.Ajax={},window.Aedu.Reducers={},window.Aedu.ActionCreators={},function(){var e=function(e){return e?_.reduce(_.keys(e).sort(),function(t,n){return t+n+JSON.stringify(e[n])},""):"{}"};Aedu.Ajax.cachePromise=function(t){var n={};return function(i){var r=e(i);if(n[r])return n[r];var o=t(i);return n[r]=o,o.fail(function(){delete n[r]}),o}}}(),function(){function e(e){return Aedu.Ajax.cachePromise(function(t){var n=_.extend(e.defaultParams,t);return $.getJSON(e.pathHelper(n))})}Aedu.Ajax.AllTimeHitsByCountryService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.all_time_hits_by_country_api_v0_user_stats_path(t))}),Aedu.Ajax.HitsService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.hits_api_v0_user_stats_path(t))}),Aedu.Ajax.DownloadsService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.downloads_api_v0_user_stats_path(t))}),Aedu.Ajax.WorksService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.works_api_v0_user_stats_path(t))}),Aedu.Ajax.AllTimeHitsByRefererService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.all_time_referer_hit_counts_api_v0_user_stats_path(t))}),Aedu.Ajax.PercentilesService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({user_id:Aedu.User.viewed.id,subdomain_param:"api"},e);return $.getJSON($r.thirty_day_percentiles_api_v0_user_stats_path(t))}),Aedu.Ajax.ImpactAggregationsService=Aedu.Ajax.cachePromise(function(e){var t=_.extend({subdomain_param:"api",user_id:Aedu.User.current.id},e);return $.getJSON($r.twelve_month_impact_api_v0_user_stats_path(t))}),Aedu.Ajax.FreebieForTypeService=Aedu.Ajax.cachePromise(function(e){var t={subdomain_param:"api"},n=_.extend({user_id:Aedu.User.current.id},e);return $.ajax({url:$r.fetch_freebie_for_type_api_v0_read_event_freebies_path(t),type:"GET",data:n,dataType:"json"})}),Aedu.Ajax.UnreadReadEventCountService=e({defaultParams:{user_id:Aedu.User.current&&Aedu.User.current.id,subdomain_param:"api"},pathHelper:$r.unread_read_event_count_api_v0_user_stats_path}),Aedu.Ajax.SearchAdvancedSampleNameMentionService=e({defaultParams:{subdomain_param:"api"},pathHelper:$r.sample_name_mention_api_v0_mentions_path}),Aedu.Ajax.UniversityHitCountsService=e({defaultParams:{user_id:Aedu.User.current&&Aedu.User.current.id,subdomain_param:"api"},pathHelper:$r.university_hit_counts_api_v0_user_stats_path}),Aedu.Ajax.PercentileDataService=e({defaultParams:{user_id:Aedu.User.current&&Aedu.User.current.id,subdomain_param:"api"},pathHelper:$r.percentile_data_api_v0_user_stats_path}),Aedu.Ajax.YearlyImpactDataService=e({defaultParams:{user_id:Aedu.User.current&&Aedu.User.current.id,subdomain_param:"api"},pathHelper:$r.yearly_impact_report_freebie_api_v0_user_stats_path})}(),window.Aedu.ActionTypes={FETCH_READ_EVENTS_SUCCESS:"FETCH_READ_EVENTS_SUCCESS",FETCH_READ_EVENTS_REQUEST:"FETCH_READ_EVENTS_REQUEST",UPDATE_READ_EVENT:"UPDATE_READ_EVENT",AnalyticsDashboard:{FETCH_HITS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_HITS_REQUEST",FETCH_HITS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_HITS_SUCCESS",FETCH_HITS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_HITS_FAILURE",FETCH_OLD_HITS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_OLD_HITS_REQUEST",FETCH_OLD_HITS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_OLD_HITS_SUCCESS",FETCH_OLD_HITS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_OLD_HITS_FAILURE",FETCH_COUNTRIES_REQUEST:"ANALYTICS_DASHBOARD__FETCH_COUNTRIES_REQUEST",FETCH_COUNTRIES_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_COUNTRIES_SUCCESS",FETCH_COUNTRIES_FAILURE:"ANALYTICS_DASHBOARD__FETCH_COUNTRIES_FAILURE",FETCH_DOWNLOADS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_DOWNLOADS_REQUEST",FETCH_DOWNLOADS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_DOWNLOADS_SUCCESS",FETCH_DOWNLOADS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_DOWNLOADS_FAILURE",FETCH_OLD_DOWNLOADS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_OLD_DOWNLOADS_REQUEST",FETCH_OLD_DOWNLOADS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_OLD_DOWNLOADS_SUCCESS",FETCH_OLD_DOWNLOADS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_OLD_DOWNLOADS_FAILURE",FETCH_REFERER_PAIRS_REQUEST:"ANALYTICS_DASHBOARD__REFERER_PAIRS_REQUEST",FETCH_REFERER_PAIRS_SUCCESS:"ANALYTICS_DASHBOARD__REFERER_PAIRS_SUCCESS",FETCH_REFERER_PAIRS_FAILURE:"ANALYTICS_DASHBOARD__REFERER_PAIRS_FAILURE",SET_DISPLAYED_DATES:"ANALYTICS_DASHBOARD__SET_DISPLAYED_DATES",FETCH_WORKS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_WORKS_REQUEST",FETCH_WORKS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_WORKS_SUCCESS",FETCH_WORKS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_WORKS_FAILURE",FETCH_DOCS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_DOCS_REQUEST",FETCH_DOCS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_DOCS_SUCCESS",FETCH_DOCS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_DOCS_FAILURE",FETCH_READER_RESEARCH_INTERESTS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_READER_RESEARCH_INTERESTS_REQUEST",FETCH_READER_RESEARCH_INTERESTS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_READER_RESEARCH_INTERESTS_SUCCESS",FETCH_READER_RESEARCH_INTERESTS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_READER_RESEARCH_INTERESTS_FAILURE",FETCH_PERCENTILES_REQUEST:"ANALYTICS_DASHBOARD__FETCH_PERCENTILES_REQUEST",FETCH_PERCENTILES_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_PERCENTILES_SUCCESS",FETCH_PERCENTILES_FAILURE:"ANALYTICS_DASHBOARD__FETCH_PERCENTILES_FAILURE",FETCH_RESEARCH_INTEREST_PERCENTILES_REQUEST:"ANALYTICS_DASHBOARD__FETCH_RESEARCH_INTEREST_PERCENTILES_REQUEST",FETCH_RESEARCH_INTEREST_PERCENTILES_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_RESEARCH_INTEREST_PERCENTILES_SUCCESS",FETCH_RESEARCH_INTEREST_PERCENTILES_FAILURE:"ANALYTICS_DASHBOARD__FETCH_RESEARCH_INTEREST_PERCENTILES_FAILURE",FETCH_IMPACT_AGGREGATIONS_REQUEST:"ANALYTICS_DASHBOARD__FETCH_IMPACT_AGGREGATIONS_REQUEST",FETCH_IMPACT_AGGREGATIONS_SUCCESS:"ANALYTICS_DASHBOARD__FETCH_IMPACT_AGGREGATIONS_SUCCESS",FETCH_IMPACT_AGGREGATIONS_FAILURE:"ANALYTICS_DASHBOARD__FETCH_IMPACT_AGGREGATIONS_FAILURE"}},window.Aedu.WorkConstants={CV_WORK_ID:-1},window.Aedu.ActionCreators.AnalyticsDashboard={},function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Countries.meta.exhausted&&!t().AnalyticsDashboard.Countries.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);$.when(Aedu.Ajax.HitsService(n),Aedu.Ajax.AllTimeHitsByCountryService()).done(function(t,n){var i=Aedu.ModelCreators.Countries(t[0].hits,n[0].countries.totals);e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_SUCCESS,countries:i})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.Countries={fetch:e}}(),function(){var e={start:moment().subtract(30,"days").format(),finish:moment().format()},t=function(){var t=_.chain($a.decompose_url(location.href)[1]).object().pick("start","finish").value(),n=_.every(t,function(e){return moment(e).isValid()});return n?_.chain(t).defaults(e).map(function(e,t){return[t,new Date(e)]}).object().value():($a.log("Analytics Dashboard: invalid date range"),e)},n=function(){return function(e,n){var i=t(),r=n().AnalyticsDashboard.DisplayedDates;_.isEqual(i,r)||e({type:Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES,start:i.start,finish:i.finish})}};Aedu.ActionCreators.AnalyticsDashboard.DisplayedDates={initialize:n}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Docs.meta.exhausted&&!t().AnalyticsDashboard.Docs.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.ModelFetchers.Docs(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_SUCCESS,docs:t})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.Docs={fetch:e}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Downloads.meta.exhausted&&!t().AnalyticsDashboard.Downloads.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.Ajax.DownloadsService(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_SUCCESS,downloads:t.downloads})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.Downloads={fetch:e}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Hits.meta.exhausted&&!t().AnalyticsDashboard.Hits.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.Ajax.HitsService(n).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_SUCCESS,hits:t.hits})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.Hits={fetch:e}}(),function(){var e=function(){return function(e,t){t().AnalyticsDashboard.ImpactAggregations.meta.exhausted||t().AnalyticsDashboard.ImpactAggregations.meta.fetching||(e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_REQUEST}),$.when(Aedu.Ajax.ImpactAggregationsService()).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_SUCCESS,aggregations:t})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_FAILURE})}))}};Aedu.ActionCreators.AnalyticsDashboard.ImpactAggregations={fetch:e}}(),function(){var e=function(){return function(e,t){t().AnalyticsDashboard.Percentiles.meta.exhausted||t().AnalyticsDashboard.Percentiles.meta.fetching||(e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_REQUEST}),$.when(Aedu.Ajax.PercentilesService()).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_SUCCESS,percentiles:t.percentiles})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_FAILURE})}))}};Aedu.ActionCreators.AnalyticsDashboard.Percentiles={fetch:e}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.PreviousDateRangeDownloads.meta.exhausted&&!t().AnalyticsDashboard.PreviousDateRangeDownloads.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_DOWNLOADS_REQUEST});var n=t().AnalyticsDashboard.DisplayedDates,i=Analytics.Utilities.dateParams({start:moment(n.start).subtract(n.dayCount,"days").toDate(),finish:moment(n.finish).subtract(n.dayCount,"days").toDate()});Aedu.Ajax.DownloadsService(i).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_DOWNLOADS_SUCCESS,downloads:t.downloads})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.PreviousDateRangeDownloads={fetch:e}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.PreviousDateRangeHits.meta.exhausted&&!t().AnalyticsDashboard.PreviousDateRangeHits.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_REQUEST});var n=t().AnalyticsDashboard.DisplayedDates,i=Analytics.Utilities.dateParams({start:moment(n.start).subtract(n.dayCount,"days").toDate(),finish:moment(n.finish).subtract(n.dayCount,"days").toDate()});Aedu.Ajax.HitsService(i).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_SUCCESS,hits:t.hits})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.PreviousDateRangeHits={fetch:e}}(),function(){var e=5e3,t=function(){return function(t,n){if(!n().AnalyticsDashboard.ReaderResearchInterests.meta.exhausted&&!n().AnalyticsDashboard.ReaderResearchInterests.meta.fetching){t({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_REQUEST});var i=Analytics.Utilities.dateParams(n().AnalyticsDashboard.DisplayedDates);!function r(){var n=_.extend({subdomain_param:"api",user_id:Aedu.User.viewed.id},i);$.getJSON($r.reader_research_interests_api_v0_user_stats_path(n)).done(function(n){return"processing"===n.status?void setTimeout(r,e):void t({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_SUCCESS,readerResearchInterests:n.reader_research_interests})}).fail(function(){t({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_FAILURE})})}()}}};Aedu.ActionCreators.AnalyticsDashboard.ReaderResearchInterests={fetch:t}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.RefererPairs.meta.exhausted&&!t().AnalyticsDashboard.RefererPairs.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);$.when(Aedu.Ajax.AllTimeHitsByRefererService(),Aedu.Ajax.HitsService(n),Aedu.Ajax.WorksService(n)).done(function(t,n,i){var r=Aedu.ModelCreators.RefererPairs(t[0].referer_hit_counts,n[0].hits,i[0].works);e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_SUCCESS,refererPairs:r})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.RefererPairs={fetch:e}}(),function(){var e=function(){return function(e,t){t().AnalyticsDashboard.ResearchInterestPercentiles.meta.exhausted||t().AnalyticsDashboard.ResearchInterestPercentiles.meta.fetching||(e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_REQUEST}),$.when(Aedu.Ajax.PercentilesService()).done(function(t){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_SUCCESS,researchInterestPercentiles:t.research_interest_percentiles})
}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_FAILURE})}))}};Aedu.ActionCreators.AnalyticsDashboard.ResearchInterestPercentiles={fetch:e}}(),function(){var e=function(){return function(e,t){if(!t().AnalyticsDashboard.Works.meta.exhausted&&!t().AnalyticsDashboard.Works.meta.fetching){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_WORKS_REQUEST});var n=Analytics.Utilities.dateParams(t().AnalyticsDashboard.DisplayedDates);Aedu.ModelFetchers.Docs(n).done(function(t){var n=_.find(t,function(e){return e.id===Aedu.WorkConstants.CV_WORK_ID});e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_WORKS_SUCCESS,works:_.without(t,n)})}).fail(function(){e({type:Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_FAILURE})})}}};Aedu.ActionCreators.AnalyticsDashboard.Works={fetch:e}}(),function(){var e=function(e){return function(t,n){var i=_.findWhere(n().ReadEvents.models,{id:e});t({type:Aedu.ActionTypes.UPDATE_READ_EVENT,readEvent:{id:i.id,likeToggleRequestFired:!0}}),$.ajax({type:"POST",url:$r.api_v0_reader_message_like_message_path({subdomain_param:"api",reader_message_id:i.reader_message.id})}).success(function(){t({type:Aedu.ActionTypes.UPDATE_READ_EVENT,readEvent:{id:i.id,reader_message:_.extend({},i.reader_message,{liked:!i.reader_message.liked}),likeToggleRequestFired:!1}})}).fail(function(){t({type:Aedu.ActionTypes.ADD_READ_EVENT,readEvent:{id:i.id,likeToggleRequestFired:!1}})})}},t=function(e,t){var n={user_id:$current_user.id,subdomain_param:"api",event_types:t};return e&&(n.cursor=e),$r.read_events_api_v0_user_stats_path(n)},n=function(){return function(e,n){if(!n().ReadEvents.meta.exhausted&&!n().ReadEvents.meta.fetching){e({type:Aedu.ActionTypes.FETCH_READ_EVENTS_REQUEST});var i=t(n().ReadEvents.meta.cursor,"DISPLAYED_TYPES");$.getJSON(i).done(function(t){e({type:Aedu.ActionTypes.FETCH_READ_EVENTS_SUCCESS,readEvents:t.read_events.models,cursor:t.read_events.cursor,exhausted:t.read_events.exhausted,fetching:!1})})}}};window.Aedu.ActionCreators.ReadEvents={toggleLiked:e,fetchReadEvents:n}}(),window.Aedu.Reducers.AnalyticsDashboard={},function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Countries=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_SUCCESS:return _.extend({},t,{models:t.models.concat(n.countries),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_COUNTRIES_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={start:null,finish:null,dayCount:null},t=function(e,t){var n=moment(t).diff(moment(e));return Math.round(n/1e3/60/60/24)};Aedu.Reducers.AnalyticsDashboard.DisplayedDates=function(n,i){switch(n=n||e,i.type){case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return _.extend({},n,{start:i.start,finish:i.finish,dayCount:t(i.start,i.finish)});default:return n}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Docs=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.docs),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOCS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Downloads=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.downloads),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_DOWNLOADS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Hits=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.hits),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_HITS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={aggregations:{counts:{},collections:{},startsOn:null,finishesOn:null},meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.ImpactAggregations=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_SUCCESS:return _.extend({},t,{aggregations:_.extend({},t.aggregations,{counts:n.aggregations.counts,collections:n.aggregations.collections,startsOn:n.aggregations.starts_on,finishesOn:n.aggregations.finishes_on}),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_IMPACT_AGGREGATIONS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.Percentiles=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_SUCCESS:return _.extend({},t,{models:t.models.concat(n.percentiles),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_PERCENTILES_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeDownloads=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_DOWNLOADS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_DOWNLOADS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.downloads),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_DOWNLOADS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeHits=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.hits),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_OLD_HITS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={perPageCounts:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.ReaderResearchInterests=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_SUCCESS:return _.extend({},t,{perPageCounts:t.perPageCounts.concat(n.readerResearchInterests),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_READER_RESEARCH_INTERESTS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.RefererPairs=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.refererPairs),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_REFERER_PAIRS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.AnalyticsDashboard.ResearchInterestPercentiles=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_SUCCESS:return _.extend({},t,{models:t.models.concat(n.researchInterestPercentiles),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_RESEARCH_INTEREST_PERCENTILES_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});default:return t}}}(),function(){var e={models:[],meta:{exhausted:!1,fetching:!1}};Aedu.Reducers.AnalyticsDashboard.Works=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.AnalyticsDashboard.FETCH_WORKS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_WORKS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.works),meta:_.extend({},t.meta,{fetching:!1,exhausted:!0,errorFetching:!1})});case Aedu.ActionTypes.AnalyticsDashboard.FETCH_WORKS_FAILURE:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!1,errorFetching:!0})});case Aedu.ActionTypes.AnalyticsDashboard.SET_DISPLAYED_DATES:return e;default:return t}}}(),function(){var e={models:[],meta:{cursor:null,exhausted:!1,fetching:!1,errorFetching:!1}};Aedu.Reducers.ReadEvents=function(t,n){switch(t=t||e,n.type){case Aedu.ActionTypes.FETCH_READ_EVENTS_REQUEST:return _.extend({},t,{meta:_.extend({},t.meta,{fetching:!0})});case Aedu.ActionTypes.FETCH_READ_EVENTS_SUCCESS:return _.extend({},t,{models:t.models.concat(n.readEvents),meta:_.extend({},t.meta,{exhausted:n.exhausted,cursor:n.cursor,fetching:n.fetching,errorFetching:!1})});case Aedu.ActionTypes.UPDATE_READ_EVENT:var i=_.map(t.models,function(e){return e.id===n.readEvent.id?_.extend({},e,n.readEvent):e});return _.extend({},t,{models:i});case Aedu.ActionTypes.UPDATE_READ_EVENTS_META:return _.extend({},t,{meta:_.extend({},t.meta,n.meta)});default:return t}}}(),function(){window.Aedu=window.Aedu||{},window.Aedu.ReduxStore=Redux.createStore(Redux.combineReducers({ReadEvents:Aedu.Reducers.ReadEvents,AnalyticsDashboard:Redux.combineReducers({Countries:Aedu.Reducers.AnalyticsDashboard.Countries,Hits:Aedu.Reducers.AnalyticsDashboard.Hits,PreviousDateRangeHits:Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeHits,DisplayedDates:Aedu.Reducers.AnalyticsDashboard.DisplayedDates,Works:Aedu.Reducers.AnalyticsDashboard.Works,Docs:Aedu.Reducers.AnalyticsDashboard.Docs,Downloads:Aedu.Reducers.AnalyticsDashboard.Downloads,PreviousDateRangeDownloads:Aedu.Reducers.AnalyticsDashboard.PreviousDateRangeDownloads,ReaderResearchInterests:Aedu.Reducers.AnalyticsDashboard.ReaderResearchInterests,RefererPairs:Aedu.Reducers.AnalyticsDashboard.RefererPairs,Percentiles:Aedu.Reducers.AnalyticsDashboard.Percentiles,ResearchInterestPercentiles:Aedu.Reducers.AnalyticsDashboard.ResearchInterestPercentiles,ImpactAggregations:Aedu.Reducers.AnalyticsDashboard.ImpactAggregations})}),Redux.compose(Redux.applyMiddleware(ReduxThunk),window.devToolsExtension?window.devToolsExtension():_.identity))}(),function(){var e=function(e,t){e=_.filter(e,function(e){return e.visitor&&e.visitor.country});var n=function(e){return e?e.toLowerCase():"Unknown"},i=_.uniq(_.flatten([_.map(e,function(e){return n(e.visitor.country.code)}),_.map(t,function(e){return n(e.country_code)})],!0)),r=_.map(i,function(e){return{countryCode:e,thirtyDayViews:0,cities:[],uniqueVisitors:{}}});return _.each(e,function(e){var t=e.visitor.city,i=_.findWhere(r,{countryCode:n(e.visitor.country.code)});if(t&&i){var o=_.findWhere(i.cities,{name:t});o||(o={name:t,thirtyDayViews:0,uniqueVisitors:{}},i.cities.push(o))}}),_.each(e,function(e){var t=_.findWhere(r,{countryCode:n(e.visitor.country.code)});if(t){t.thirtyDayViews+=1,t.uniqueVisitors[e.visitor.id]=!0;var i=e.visitor.city;if(i){var o=_.findWhere(t.cities,{name:i});o.thirtyDayViews+=1,o.uniqueVisitors[e.visitor.id]=!0}}}),_.each(t,function(e){var t=_.findWhere(r,{countryCode:n(e.country_code)});t.allTimeViews=parseInt(e.all_time_hit_count,10)}),_.each(r,function(e){e.uniqueVisitors=_.size(e.uniqueVisitors),_.each(e.cities,function(e){e.uniqueVisitors=_.size(e.uniqueVisitors)})}),r},t=function(e,t,n){function i(e,t){var n=_.findWhere(o,{workId:e,refererUrl:t});return n||(n={workId:e,refererUrl:t},o.push(n)),n}function r(e,t){var r=_.filter(e,function(e){return e.referer&&e.referer.url?"ExternalPage"==e.source.type||"ExternalSocial"==e.source.type:void 0});return _.each(r,function(e){var t=e.page.work_id||-1,n=e.referer.url,r=i(t,n);r.thirtyDayViews=r.thirtyDayViews?r.thirtyDayViews+1:1}),_.each(t,function(e,t){var n="Profile"==t?-1:parseInt(t);_.each(e,function(e,t){var r=i(n,t);r.allTimeViews=e.all_time_views})}),_.each(o,function(e){if(-1===e.workId)e.targetPageTitle="Profile",e.targetPageUrl=Aedu.User.current.url;else{var t=_.find(n,function(t){return parseInt(t.id,10)==parseInt(e.workId,10)});e.targetPageTitle=t&&t.title,e.targetPageUrl=t&&t.internal_url}}),o}var o=[];return r(t,e)},n=function(e,t,n,i,r){var o=_.map(e,function(e){return _.clone(e)}),a={allTimeDownloads:void 0,allTimeViews:void 0,id:Aedu.WorkConstants.CV_WORK_ID,internal_url:$viewed_user.url+"/CurriculumVitae",title:"Curriculum Vitae"};o.push(a);var s=_.groupBy(i,"work_id"),l=_.groupBy(t,function(e){return e.page&&e.page.work_id}),u=_.groupBy(n,"work_id");return _.each(o,function(e){var t=s[e.id]||[],n=l[e.id]||[],i=u[e.id]||[],o=r[e.id];e.thirtyDayDownloads=t.length,e.thirtyDayViews=n.length,e.thirtyDayUniques=_.size(_.groupBy(n,function(e){return e.visitor.id})),e.countries=Aedu.ModelCreators.Countries(n,i),e.thirtyDayPercentile=o,e.allTimeDownloads=e.all_time_downloads,delete e.all_time_downloads,e.allTimeViews=e.all_time_views,delete e.all_time_views}),o};Aedu.ModelCreators={Countries:e,RefererPairs:t,Docs:n}}(),function(){var e=function(e){var t=$.Deferred();return $.when(Aedu.Ajax.WorksService(),Aedu.Ajax.HitsService(e),Aedu.Ajax.AllTimeHitsByCountryService(),Aedu.Ajax.DownloadsService(e),Aedu.Ajax.PercentilesService()).done(function(e,n,i,r,o){t.resolve(Aedu.ModelCreators.Docs(e[0].works,n[0].hits,i[0].countries.by_work,r[0].downloads,o[0].percentiles))}).fail(t.reject),t};Aedu.ModelFetchers={Docs:e}}(),function(){var e,t,n,i,r,o,a;this.Components||(this.Components={}),(e=this.Components).Modals||(e.Modals={}),(t=this.Components).Basic||(t.Basic={}),(n=this.Components).Compound||(n.Compound={}),(i=this.Components).Buttons||(i.Buttons={}),(r=this.Components).Application||(r.Application={}),(o=this.Components.Application).Ads||(o.Ads={}),(a=this.Components.Application).User||(a.User={}),window.define=null}.call(this),ReactUtils={showModal:function(e,t,n){var i=_.uniqueId("js-bootstrap-modal-"),r=_.extend({},t,{modalId:i}),o=React.createElement(e,r),a=document.createElement("div"),s=$("body")[0],l=function(){s.removeChild(a)},u=_.extend({},n,{modalId:i,modalView:o,onClose:l}),c=React.createElement(Components.Modals.ModalBase,u);return s.appendChild(a),ReactDOM.render(c,a)},prepareMoar:function(e){$(e).each(function(e,t){var n=React.createElement(Components.Application.Ads.Google,{width:$(t).data("width"),height:$(t).data("height"),slot:$(t).data("slot").toString()});ReactDOM.render(n,t)})}},this.Components.Utils=ReactUtils,this.Components.Application.Ads.Google=React.createClass({displayName:"Google",propTypes:{height:React.PropTypes.string,width:React.PropTypes.string,client:React.PropTypes.string.isRequired,slot:React.PropTypes.string.isRequired},getDefaultProps:function(){return{height:"100%",width:"100%",client:"ca-pub-5676204214023051"}},getKey:function(){return this.props.client+"-"+this.props.slot},render:function(){var e={display:"inline-block",height:this.props.height,width:this.props.width};return React.createElement("ins",{className:"adsbygoogle",key:this.getKey(),style:e,"data-ad-client":this.props.client,"data-ad-slot":this.props.slot})},loadScript:function(){if(!window.moarGoogleLoaded){var e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";var t=document.getElementsByTagName("head")[0];t.appendChild(e),window.moarGoogleLoaded=!0}},componentDidMount:function(){this.loadScript(),(window.adsbygoogle=window.adsbygoogle||[]).push({})}}),function(){this.Components.Application.User.ProfilePreviewAffiliation=React.createClass({displayName:"ProfilePreviewAffiliation",propTypes:function(){return{profile:React.propTypes.object.isRequired}},render:function(){var e,t,n;return e=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr2x"}),t=this.props.profile.display_name,n=React.createElement("div",null," ",this.props.profile.university," "),React.createElement(Components.Compound.ImageHeaderSubtext,{image:e,header:t,subtext:n,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Application.User.ProfilePreviewLabel=React.createClass({displayName:"ProfilePreviewLabel",propTypes:function(){return{profile:React.propTypes.object.isRequired,label:React.propTypes.string.isRequired}},render:function(){var e;return e=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr2x"}),React.createElement(Components.Compound.ImageLabel,{image:e,label:this.props.label,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Application.User.ProfilePreviewTimestamp=React.createClass({displayName:"ProfilePreviewTimestamp",propTypes:function(){return{profile:React.propTypes.object.isRequired,timestamp:React.propTypes.number.isRequired}},render:function(){var e,t,n,i,r,o;return n=React.createElement(Components.Basic.Avatar,{profile:this.props.profile,className:"u-mr3x"}),i=React.createElement("div",{className:"u-fs16 u-tcGrayDarkest u-fw700"},this.props.profile.display_name),e=this.props.profile.author_rank,o=$h.timeAgoInWords(new Date(this.props.timestamp),{shortened:!0}),t=e?React.createElement("li",{className:"InlineList-item InlineList-item--bordered"},React.createElement("i",{className:"fa fa-bar-chart"})," ",e.value.toFixed(1)):"",r=React.createElement("ul",{className:"InlineList InlineList--bordered u-fs14 u-tcGrayDark u-fw400"},t,React.createElement("li",{className:"InlineList-item InlineList-item--bordered"},o," ago")),React.createElement(Components.Compound.ImageHeaderSubtext,{image:n,header:i,subtext:r,url:this.props.profile.url,className:"u-m0x"})}})}.call(this),function(){this.Components.Basic.Avatar=React.createClass({displayName:"Avatar",statics:{SIZE:{smallest:"Avatar--xxs",smaller:"Avatar--xs",small:"Avatar--sm",medium:"Avatar--md",large:"Avatar--lg",larger:"Avatar--xl"}},propTypes:function(){return{profile:React.propTypes.object.isRequired,size:React.propTypes.string}},getDefaultProps:function(){return{size:"Avatar--md"}},render:function(){var e;return e="Avatar "+this.props.size,React.createElement("img",{src:this.props.profile.photo,className:e})}})}.call(this),function(){this.Components.Basic.Spinner=React.createClass({displayName:"Spinner",statics:{SIZE:{smallest:"",smaller:"fa-lg",small:"fa-2x",medium:"fa-3x",large:"fa-4x",larger:"fa-5x"}},propTypes:function(){return{size:React.propTypes.string}},getDefaultProps:function(){return{size:""}},render:function(){var e;return e="fa fa-spinner fa-spin "+this.props.size,React.createElement("div",{className:e})}})}.call(this),function(){this.Components.Buttons.Cancel=React.createClass({displayName:"Cancel",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func,text:React.propTypes.string}},getDefaultProps:function(){return{text:"Cancel"}},render:function(){return React.createElement("button",{className:"Button Button--inverseGray",onClick:this.onClick},this.props.text)}})}.call(this),function(){this.Components.Buttons.Close=React.createClass({displayName:"Close",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("span",{className:"u-clickable u-fs22 u-fw400",onClick:this.onClick},"\xd7")}})}.call(this),function(){this.Components.Buttons.Confirm=React.createClass({displayName:"Confirm",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func,text:React.propTypes.string}},getDefaultProps:function(){return{text:"Confirm"}},render:function(){return React.createElement("button",{className:"Button Button--green",onClick:this.onClick},this.props.text)}})}.call(this),function(){this.Components.Buttons.Delete=React.createClass({displayName:"Delete",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("i",{className:"fa fa-times u-clickable",onClick:this.onClick})}})}.call(this),function(){this.Components.Buttons.Edit=React.createClass({displayName:"Edit",onClick:function(){return this.props.handler?this.props.handler():void 0},propTypes:function(){return{handler:React.propTypes.func}},render:function(){return React.createElement("i",{className:"fa fa-pencil u-clickable",onClick:this.onClick})}})}.call(this),function(){this.Components.Compound.CheckboxLabel=React.createClass({displayName:"CheckboxLabel",propTypes:function(){return{label:React.propTypes.string.isRequired,labelClasses:React.propTypes.string.isRequired,onChange:React.propTypes.func,initChecked:React.propType.bool,disabled:React.propType.bool}},getDefaultProps:function(){return{initChecked:!1}},getInitialState:function(){return{checked:this.props.initChecked}},checkboxClicked:function(e){return this.props.disabled?void 0:(this.setState({checked:e.target.checked}),this.props.onChange?this.props.onChange(e.target.checked):void 0)},render:function(){var e;return e="clickable "+this.props.labelClasses,React.createElement("label",{className:e},React.createElement("input",{type:"checkbox",className:"Checkbox u-mr2x",onChange:this.checkboxClicked,checked:this.state.checked,disabled:this.props.disabled,ref:"checkbox"}),this.props.label)}})}.call(this),function(){this.Components.Compound.EditDelete=React.createClass({displayName:"EditDelete",propTypes:function(){return{onEdit:React.propTypes.func,onDelete:React.propTypes.func}},render:function(){return React.createElement("ul",{className:"InlineList u-fs18 u-tcGray u-displayInlineBlock u-whiteSpaceNowrap"},React.createElement("li",{className:"InlineList-item u-ph0x u-mr3x u-onHover-tcBlue"},React.createElement(Components.Buttons.Edit,{handler:this.props.onEdit})),React.createElement("li",{className:"InlineList-item u-pl0x u-onHover-tcRed"},React.createElement(Components.Buttons.Delete,{handler:this.props.onDelete})))}})}.call(this),function(){this.Components.Compound.Facepile=React.createClass({displayName:"Facepile",propTypes:function(){return{profiles:React.propTypes.array.isRequired,maxProfiles:React.propTypes.number}},getDefaultProps:function(){return{maxProfiles:4}},render:function(){var e,t,n,i,r,o,a;for(o=Components.Basic.Avatar.SIZE.smallest,i=0,a=[],r=this.props.profiles,e=0,t=r.length;t>e;e++)if(n=r[e],a.push(React.createElement("span",{className:"u-mr1x"},React.createElement(Components.Basic.Avatar,{profile:n,key:"fp_"+n.id,size:o}))),++i>=this.props.maxProfiles){i!==this.props.profiles.length&&a.push(" ...");break}return React.createElement("span",null,a)}})}.call(this),function(){this.Components.Compound.ImageHeaderSubtext=React.createClass({displayName:"ImageHeaderSubtext",propTypes:function(){return{image:React.propTypes.element.isRequired,header:React.propTypes.string,subtext:React.propTypes.string,url:React.propTypes.string}},getDefaultProps:function(){return{header:"Hello, world!",subtext:"Hello, world!"}},render:function(){var e,t;return e=null,t=null,this.props.url?(e=React.createElement("a",{href:this.props.url,className:"h4 Media-heading"}," ",this.props.header," "),t=React.createElement("a",{href:this.props.url,className:"pull-left"}," ",this.props.image," ")):(e=React.createElement("span",{className:"h4 media-heading"}," ",this.props.header," "),t=this.props.image),React.createElement("div",{className:"Media"},React.createElement("div",{className:"Media--left Media--middle"},t),React.createElement("div",{className:"Media-body Media--middle u-taLeft"},e,React.createElement("span",{className:"u-tcGray"}," ",this.props.subtext)))}})}.call(this),function(){this.Components.Compound.ImageLabel=React.createClass({displayName:"ImageLabel",propTypes:function(){return{image:React.propTypes.element.isRequired,label:React.propTypes.string,url:React.propTypes.string}},getDefaultProps:function(){return{label:"Hello, world! Test."}},render:function(){var e;return e=null,e=this.props.url?React.createElement("a",{href:this.props.url,className:"pull-left"}," ",this.props.image," "):this.props.image,React.createElement("div",{className:"Media"},React.createElement("div",{className:"Media--left Media--middle"},e),React.createElement("div",{className:"Media-body Media--middle u-taLeft"},this.props.label))}})}.call(this),function(){this.Components.Compound.TextInputWithConfirm=React.createClass({displayName:"TextInputWithConfirm",propTypes:function(){return{initialText:React.propTypes.string.isRequired,onCancel:React.propTypes.func,onConfirm:React.propTypes.func}},getInitialState:function(){return{text:this.props.initialText}},cancelHandler:function(){return this.props.onCancel?this.props.onCancel(this.state.text):void 0},confirmHandler:function(){return this.props.onConfirm?this.props.onConfirm(this.state.text):void 0},valueChange:function(e){return this.setState({text:e.target.value})},render:function(){return React.createElement("div",{className:"clearfix"},React.createElement("textarea",{className:"TextArea",defaultValue:this.props.initialText,value:this.state.text,onChange:this.valueChange}),React.createElement("br",null),React.createElement("div",{className:"u-floatRight"},React.createElement(Components.Buttons.Cancel,{handler:this.cancelHandler}),"\xa0",React.createElement(Components.Buttons.Confirm,{handler:this.confirmHandler})))}})}.call(this),function(){this.Components.Modals.BodyClose=React.createClass({displayName:"BodyClose",propTypes:function(){},getDefaultProps:function(){},render:function(){return React.createElement("div",null,React.createElement("div",{className:"u-p2x"},this.closeButton()),this.props.children)},closeButton:function(){return React.createElement("button",{className:"close","aria-label":"Close","data-dismiss":"modal",type:"button"},React.createElement("span",{className:"u-clickable u-fs24"},"\xd7"))}})}.call(this),function(){this.Components.Modals.BodyOnly=React.createClass({displayName:"BodyOnly",render:function(){return React.createElement("div",null,React.createElement("div",{className:"modal-body u-p0x"},this.props.children))}})}.call(this),function(){this.Components.Modals.ConfirmOrCancel=React.createClass({displayName:"ConfirmOrCancel",propTypes:function(){return{message:React.propTypes.element,onConfirm:React.propTypes.func.isRequired,onCancel:React.propTypes.func}},getDefaultProps:function(){return{message:React.createElement("label",null," Are you sure? ")}},render:function(){return React.createElement(Components.Modals.HeaderBodyClose,{header:this.props.message})},buttons:function(){return React.createElement("div",{className:"clearfix"},React.createElement("div",{className:"u-floatRight"},React.createElement(Components.Buttons.Cancel,{handler:this.props.onCancel}),"\xa0",React.createElement(Components.Buttons.Confirm,{handler:this.props.onConfirm})))}})}.call(this),function(){this.Components.Modals.HeaderBodyClose=React.createClass({displayName:"HeaderBodyClose",propTypes:function(){return{header:React.propTypes.element,body:React.propTypes.element}},getDefaultProps:function(){return{header:React.createElement("label",null," Header "),body:React.createElement("label",null," Body ")}},render:function(){return React.createElement("div",null,React.createElement("div",{className:"modal-header u-border0 u-pv6x"},React.createElement("button",{className:"close","aria-label":"Close","data-dismiss":"modal",type:"button"},React.createElement(Components.Buttons.Close,{"aria-hidden":"true"})),this.props.header),React.createElement("div",{className:"modal-body u-p0x"},this.props.body))}})}.call(this),function(){Components.Modals.ModalBase=React.createClass({displayName:"ModalBase",propTypes:{modalView:React.PropTypes.element.isRequired,onClose:React.PropTypes.func,modalId:React.PropTypes.string,disableBgClick:React.PropTypes.bool,width:React.PropTypes.number},componentDidMount:function(){return this.element=$("#"+this.props.modalId),this.element.modal("show"),this.element.on("hidden.bs.modal",this.props.onClose)},close:function(){return this.element.modal("hide")},render:function(){var e=this.props.disableBgClick?"static":!0;return React.createElement("div",{className:"ds-Modal modal",id:this.props.modalId,tabIndex:"-1","data-backdrop":e},React.createElement("div",{className:"modal-dialog"},React.createElement("div",{className:"modal-content",style:{width:this.props.width}},this.props.modalView)))}})}(),function(e){if("undefined"!=typeof module&&module.exports)module.exports=e(this);else if("function"==typeof define&&define.amd){var t=this;define("i18n",function(){return e(t)})}else this.I18n=e(this)}(function(e){"use strict";var t=e&&e.I18n||{},n=Array.prototype.slice,i=function(e){return("0"+e.toString()).substr(-2)},r=function(e,t){return s("round",e,-t).toFixed(t)},o=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},a=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},s=function(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?0/0:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))},l={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},u={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},c={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},d={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},p=[null,"kb","mb","gb","tb"],h={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};
return t.reset=function(){this.defaultLocale=h.defaultLocale,this.locale=h.locale,this.defaultSeparator=h.defaultSeparator,this.placeholder=h.placeholder,this.fallbacks=h.fallbacks,this.translations=h.translations,this.missingBehaviour=h.missingBehaviour,this.missingTranslationPrefix=h.missingTranslationPrefix},t.initializeOptions=function(){"undefined"==typeof this.defaultLocale&&null!==this.defaultLocale&&(this.defaultLocale=h.defaultLocale),"undefined"==typeof this.locale&&null!==this.locale&&(this.locale=h.locale),"undefined"==typeof this.defaultSeparator&&null!==this.defaultSeparator&&(this.defaultSeparator=h.defaultSeparator),"undefined"==typeof this.placeholder&&null!==this.placeholder&&(this.placeholder=h.placeholder),"undefined"==typeof this.fallbacks&&null!==this.fallbacks&&(this.fallbacks=h.fallbacks),"undefined"==typeof this.translations&&null!==this.translations&&(this.translations=h.translations)},t.initializeOptions(),t.locales={},t.locales.get=function(e){var n=this[e]||this[t.locale]||this["default"];return"function"==typeof n&&(n=n(e)),a(n)===!1&&(n=[n]),n},t.locales["default"]=function(e){var n,i=[],r=[];return e&&i.push(e),!e&&t.locale&&i.push(t.locale),t.fallbacks&&t.defaultLocale&&i.push(t.defaultLocale),i.forEach(function(e){n=e.split("-")[0],~r.indexOf(e)||r.push(e),t.fallbacks&&n&&n!==e&&!~r.indexOf(n)&&r.push(n)}),i.length||i.push("en"),r},t.pluralization={},t.pluralization.get=function(e){return this[e]||this[t.locale]||this["default"]},t.pluralization["default"]=function(e){switch(e){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},t.currentLocale=function(){return this.locale||this.defaultLocale},t.isSet=function(e){return void 0!==e&&null!==e},t.lookup=function(e,t){t=this.prepareOptions(t);{var n,i,r,o=this.locales.get(t.locale).slice();o[0]}for(e=this.getFullScope(e,t);o.length;)if(n=o.shift(),i=e.split(this.defaultSeparator),r=this.translations[n]){for(;i.length&&(r=r[i.shift()],void 0!==r&&null!==r););if(void 0!==r&&null!==r)return r}return this.isSet(t.defaultValue)?t.defaultValue:void 0},t.meridian=function(){var e=this.lookup("time"),t=this.lookup("date");return e&&e.am&&e.pm?[e.am,e.pm]:t&&t.meridian?t.meridian:l.meridian},t.prepareOptions=function(){for(var e,t=n.call(arguments),i={};t.length;)if(e=t.shift(),"object"==typeof e)for(var r in e)e.hasOwnProperty(r)&&(this.isSet(i[r])||(i[r]=e[r]));return i},t.createTranslationOptions=function(e,t){var n=[{scope:e}];return this.isSet(t.defaults)&&(n=n.concat(t.defaults)),this.isSet(t.defaultValue)&&(n.push({message:t.defaultValue}),delete t.defaultValue),n},t.translate=function(e,t){t=this.prepareOptions(t);var n,i=this.createTranslationOptions(e,t),r=i.some(function(e){return this.isSet(e.scope)?n=this.lookup(e.scope,t):this.isSet(e.message)&&(n=e.message),void 0!==n&&null!==n?!0:void 0},this);return r?("string"==typeof n?n=this.interpolate(n,t):o(n)&&this.isSet(t.count)&&(n=this.pluralize(t.count,n,t)),n):this.missingTranslation(e,t)},t.interpolate=function(e,t){t=this.prepareOptions(t);var n,i,r,o,a=e.match(this.placeholder);if(!a)return e;for(var i;a.length;)n=a.shift(),r=n.replace(this.placeholder,"$1"),i=this.isSet(t[r])?t[r].toString().replace(/\$/gm,"_#$#_"):r in t?this.nullPlaceholder(n,e,t):this.missingPlaceholder(n,e,t),o=new RegExp(n.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),e=e.replace(o,i);return e.replace(/_#\$#_/g,"$")},t.pluralize=function(e,t,n){n=this.prepareOptions(n);var i,r,a,s,l;if(i=o(t)?t:this.lookup(t,n),!i)return this.missingTranslation(t,n);for(r=this.pluralization.get(n.locale),a=r(e);a.length;)if(s=a.shift(),this.isSet(i[s])){l=i[s];break}return n.count=String(e),this.interpolate(l,n)},t.missingTranslation=function(e,t){if("guess"==this.missingBehaviour){var n=e.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+n.replace("_"," ").replace(/([a-z])([A-Z])/g,function(e,t,n){return t+" "+n.toLowerCase()})}var i=this.getFullScope(e,t),r=[this.currentLocale(),i].join(this.defaultSeparator);return'[missing "'+r+'" translation]'},t.missingPlaceholder=function(e){return"[missing "+e+" value]"},t.nullPlaceholder=function(){return t.missingPlaceholder.apply(t,arguments)},t.toNumber=function(e,t){t=this.prepareOptions(t,this.lookup("number.format"),u);var n,i,o=0>e,a=r(Math.abs(e),t.precision).toString(),s=a.split("."),l=[],c=t.format||"%n",d=o?"-":"";for(e=s[0],n=s[1];e.length>0;)l.unshift(e.substr(Math.max(0,e.length-3),3)),e=e.substr(0,e.length-3);return i=l.join(t.delimiter),t.strip_insignificant_zeros&&n&&(n=n.replace(/0+$/,"")),t.precision>0&&n&&(i+=t.separator+n),c=t.sign_first?"%s"+c:c.replace("%n","%s%n"),i=c.replace("%u",t.unit).replace("%n",i).replace("%s",d)},t.toCurrency=function(e,t){return t=this.prepareOptions(t,this.lookup("number.currency.format"),this.lookup("number.format"),c),this.toNumber(e,t)},t.localize=function(e,t,n){switch(n||(n={}),e){case"currency":return this.toCurrency(t);case"number":return e=this.lookup("number.format"),this.toNumber(t,e);case"percentage":return this.toPercentage(t);default:var i;return i=e.match(/^(date|time)/)?this.toTime(e,t):t.toString(),this.interpolate(i,n)}},t.parseDate=function(e){var t,n,i;if("object"==typeof e)return e;if(t=e.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var r=1;6>=r;r++)t[r]=parseInt(t[r],10)||0;t[2]-=1,i=t[7]?1e3*("0"+t[7]):null,n=t[8]?new Date(Date.UTC(t[1],t[2],t[3],t[4],t[5],t[6],i)):new Date(t[1],t[2],t[3],t[4],t[5],t[6],i)}else"number"==typeof e?(n=new Date,n.setTime(e)):e.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(n=new Date,n.setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" ")))):e.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/)?(n=new Date,n.setTime(Date.parse(e))):(n=new Date,n.setTime(Date.parse(e)));return n},t.strftime=function(e,n){var r=this.lookup("date"),o=t.meridian();r||(r={}),r=this.prepareOptions(r,l);var a=e.getDay(),s=e.getDate(),u=e.getFullYear(),c=e.getMonth()+1,d=e.getHours(),p=d,h=d>11?1:0,f=e.getSeconds(),m=e.getMinutes(),g=e.getTimezoneOffset(),v=Math.floor(Math.abs(g/60)),y=Math.abs(g)-60*v,_=(g>0?"-":"+")+(v.toString().length<2?"0"+v:v)+(y.toString().length<2?"0"+y:y);return p>12?p-=12:0===p&&(p=12),n=n.replace("%a",r.abbr_day_names[a]),n=n.replace("%A",r.day_names[a]),n=n.replace("%b",r.abbr_month_names[c]),n=n.replace("%B",r.month_names[c]),n=n.replace("%d",i(s)),n=n.replace("%e",s),n=n.replace("%-d",s),n=n.replace("%H",i(d)),n=n.replace("%-H",d),n=n.replace("%I",i(p)),n=n.replace("%-I",p),n=n.replace("%m",i(c)),n=n.replace("%-m",c),n=n.replace("%M",i(m)),n=n.replace("%-M",m),n=n.replace("%p",o[h]),n=n.replace("%S",i(f)),n=n.replace("%-S",f),n=n.replace("%w",a),n=n.replace("%y",i(u)),n=n.replace("%-y",i(u).replace(/^0+/,"")),n=n.replace("%Y",u),n=n.replace("%z",_)},t.toTime=function(e,t){var n=this.parseDate(t),i=this.lookup(e);return n.toString().match(/invalid/i)?n.toString():i?this.strftime(n,i):n.toString()},t.toPercentage=function(e,t){return t=this.prepareOptions(t,this.lookup("number.percentage.format"),this.lookup("number.format"),d),this.toNumber(e,t)},t.toHumanSize=function(e,t){for(var n,i,r=1024,o=e,a=0;o>=r&&4>a;)o/=r,a+=1;return 0===a?(n=this.t("number.human.storage_units.units.byte",{count:o}),i=0):(n=this.t("number.human.storage_units.units."+p[a]),i=o-Math.floor(o)===0?0:1),t=this.prepareOptions(t,{unit:n,precision:i,format:"%n%u",delimiter:""}),this.toNumber(o,t)},t.getFullScope=function(e,t){return t=this.prepareOptions(t),e.constructor===Array&&(e=e.join(this.defaultSeparator)),t.scope&&(e=[t.scope,e].join(this.defaultSeparator)),e},t.extend=function(e,t){var n,i={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);return i},t.t=t.translate,t.l=t.localize,t.p=t.pluralize,t});var I18n=I18n||{};I18n.translations||(I18n.translations={}),I18n.translations.en=I18n.extend(I18n.translations.en||{},{date:{formats:{"default":"%Y-%m-%d","short":"%b %d","long":"%B %d, %Y"},day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],order:["year","month","day"]},time:{},support:{},number:{},errors:{},activerecord:{},datetime:{},helpers:{},views:{},mailers:{},reg_path:{},registration_path:{},affiliation_editor:{},department_search:{create_new:"Or create a new department..."},uploaded_by:"Uploaded by",added_by:"Added by",aca:{marketing_claim:{text:"A study recently published in PLOS ONE found that papers uploaded to Academia.edu receive a 69% boost in citations over 5 years.",html:"A study recently published in <i>PLOS ONE</i> found that papers uploaded to Academia.edu receive a 69% boost in citations over 5 years."},marketing_claim_with_link:{html:'A <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">study</a> recently published in <i>PLOS ONE</i> found that papers uploaded to Academia receive a 69% boost in citations over 5 years.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},premium_upgrade_page:{},analytics_dashboard:{},premium_upgrade_modal:{header:{free_trial:"Try Academia Premium",no_free_trial:"Upgrade to Academia Premium"},premium_feature_list:{readers:"Readers",expanded_analytics:"Expanded Analytics",advanced_search:"Advanced Search",impact_report:"Impact Report"},free_trial_info_text:"Your credit card will only be billed after your 7-day free trial ends.",no_free_trial_info_text:"Get a refund anytime within 30 days - no questions asked.",payment_form:{unexpected_error:"An unexpected error occurred. Please contact premium-support@academia.edu.",card_number_placeholder:"Card Number",security_code:"Security Code (CVV/CVC)",exp_date_placeholder:"Expiration Date (MM/YY)",upgrade:"Upgrade",start_free_trial:"Start 7-Day Free Trial",invalid_expiration_date:"Invalid Expiration Date",invalid_cvc_format:"Invalid CVC format - expected 3 or 4 digits, e.g. 765",invalid_card_number:"Invalid card number",save:"Save {{percentage}}",per_time_interval:"Per",month:"month",year:"year"}}}),I18n.translations.es=I18n.extend(I18n.translations.es||{},{errors:{},number:{},reg_path:{},affiliation_editor:{},mailers:{},registration_path:{},department_search:{create_new:"O crea un nuevo departamento..."},uploaded_by:"Subido por",added_by:"A\xf1adido por",aca:{marketing_claim:{text:"Un estudio recientemente publicado en PLOS ONE ha concluido que las publicaciones subidas a Academia.edu reciben un 69% de aumento de sus citas en un periodo de 5 a\xf1os.",html:"Un estudio recientemente publicado en <i>PLOS ONE</i> ha concluido que las publicaciones subidas a Academia.edu reciben un 69% de aumento de sus citas en un periodo de 5 a\xf1os."},marketing_claim_with_link:{html:'Un <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">estudio</a> recientemente publicado en <i>PLOS ONE</i> ha concluido que las publicaciones subidas a Academia.edu reciben un 69% de aumento de sus citas en un periodo de 5 a\xf1os.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},multi_upload:{drag_and_drop:"Arrastra y suelta varios archivos, o...",drop_anywhere:"Suelta archivos en cualquier parte para subirlos",choose_files:"Elegir archivos","continue":"Continuar",paper_title:"T\xedtulo de la publicaci\xf3n","abstract":"Resumen",authors:"Autores",title_not_found:"T\xedtulo de la publicaci\xf3n no encontrado",research_interests:"Intereses de investigaci\xf3n",section:"Secci\xf3n",validation_error:{too_big:"El archivo tiene un tama\xf1o mayor de 100 MB",bad_type:"Este tipo de archivo no es compatible",too_long:"Este nombre de archivo es demasiado largo","":{one:"Se ha producido un problema",other:"Se ha producido un problema"},other:"Se ha producido un problema"},add_paper_details:"A\xf1adir informaci\xf3n de la publicaci\xf3n",paper_n_of_m:"Publicaci\xf3n %{current_paper} de %{paper_count}"},premium_upgrade_modal:{header:{free_trial:"Prueba Academia Premium",no_free_trial:"Actualiza a Academia Premium"},premium_feature_list:{readers:"Lectores",expanded_analytics:"An\xe1lisis ampliados",advanced_search:"B\xfasqueda avanzada",impact_report:"Informe de impacto"},free_trial_info_text:"Solo realizaremos el cargo a tu tarjeta de cr\xe9dito una vez finalizado el periodo de prueba de 7 d\xedas.",no_free_trial_info_text:"Te devolvemos el dinero en un plazo de 30 d\xedas, sin explicaciones.",payment_form:{unexpected_error:"Se ha producido un error inesperado. Ponte en contacto con premium-support@academia.edu.",card_number_placeholder:"N\xfamero de tarjeta ",security_code:"C\xf3digo de seguridad (CVV/CVC)",exp_date_placeholder:"Fecha de caducidad (MM/AA)",upgrade:"Actualizar",start_free_trial:"Inicia tu prueba gratuita de 7 d\xedas",invalid_expiration_date:"Fecha de caducidad no v\xe1lida",invalid_cvc_format:"Formado de CVC no v\xe1lido: se esperan 3 o 4 d\xedgitos, p. ej. 765",invalid_card_number:"N\xfamero de tarjeta no v\xe1lido",save:"Guardar {{percentage}}",per_time_interval:"al",month:"mes",year:"a\xf1o"}},premium_upgrade_page:{},analytics_dashboard:{}}),I18n.translations["zh-HK"]=I18n.extend(I18n.translations["zh-HK"]||{},{errors:{},number:{}}),I18n.translations["pt-BR"]=I18n.extend(I18n.translations["pt-BR"]||{},{errors:{},number:{}}),I18n.translations.ja=I18n.extend(I18n.translations.ja||{},{errors:{},number:{}}),I18n.translations["zh-TW"]=I18n.extend(I18n.translations["zh-TW"]||{},{errors:{},number:{}}),I18n.translations.de=I18n.extend(I18n.translations.de||{},{errors:{},number:{}}),I18n.translations["zh-CN"]=I18n.extend(I18n.translations["zh-CN"]||{},{errors:{},number:{}}),I18n.translations.fr=I18n.extend(I18n.translations.fr||{},{reg_path:{},affiliation_editor:{},mailers:{},registration_path:{},department_search:{create_new:"Ou cr\xe9ez un nouveau d\xe9partement"},uploaded_by:"T\xe9l\xe9charg\xe9 par",added_by:"Ajout\xe9 par",aca:{marketing_claim:{text:"D'apr\xe8s une \xe9tude r\xe9cemment publi\xe9e sur PLOS ONE, les \xe9loges \xe0 l'\xe9gard des articles t\xe9l\xe9charg\xe9s sur academia.edu subissent une augmentation de 69 % sur 5 ans.",html:"D'apr\xe8s une \xe9tude r\xe9cemment publi\xe9e sur <i>PLOS ONE</i>, les \xe9loges \xe0 l'\xe9gard des articles t\xe9l\xe9charg\xe9s sur academia.edu subissent une augmentation de 69 % sur 5 ans."},marketing_claim_with_link:{html:'D\'apr\xe8s une <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">\xe9tude </a>r\xe9cemment publi\xe9e sur <i>PLOS ONE</i>, les \xe9loges \xe0 l\'\xe9gard des articles t\xe9l\xe9charg\xe9s sur academia.edu subissent une augmentation de 69 % sur 5 ans.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},multi_upload:{drag_and_drop:"Glissez-d\xe9posez plusieurs fichiers ou...",drop_anywhere:"Glissez-d\xe9posez des fichiers \xe0 l'endroit souhait\xe9 pour les t\xe9l\xe9charger",choose_files:"Choisir les fichiers","continue":"Continuer",paper_title:"Titre de l'article","abstract":"Abstrait",authors:"Auteurs",title_not_found:"Titre de l'article introuvable",research_interests:"Int\xe9r\xeats de recherche",section:"Section",validation_error:{too_big:"Ce fichier d\xe9passe les 100 Mo",bad_type:"Ce type de fichier n'est pas pris en charge",too_long:"Ce nom de fichier est trop long","":{one:"Une erreur s'est produite",other:"Plusieurs erreurs se sont produites"},other:"Plusieurs erreurs se sont produites"},add_paper_details:"Ajouter les d\xe9tails de l'article",paper_n_of_m:"Article %{article_courant} sur %{nombre_darticles}"},premium_upgrade_modal:{header:{free_trial:"Essayez Academia Premium",no_free_trial:"Mettre \xe0 niveau vers Academia Premium"},premium_feature_list:{readers:"Lecteurs",expanded_analytics:"Analyses suppl\xe9mentaires",advanced_search:"Recherche avanc\xe9e",impact_report:"Rapport sur l'incidence"},free_trial_info_text:"Votre carte de cr\xe9dit ne sera d\xe9bit\xe9e qu'apr\xe8s la fin de votre p\xe9riode d'essai de 7 jours.",no_free_trial_info_text:"Obtenez un remboursement \xe0 tout moment dans les 30 jours - sans restriction.",payment_form:{unexpected_error:"Une erreur inattendue s'est produite. Veuillez contacter premium-support@academia.edu.",card_number_placeholder:"Num\xe9ro de carte",security_code:"Code de v\xe9rificatin de carte (CVV/CVC)",exp_date_placeholder:"Date d'expiration (MM/AA)",upgrade:"Mettre \xe0 niveau",start_free_trial:"Commencer l'essai gratuit de 7 jours",invalid_expiration_date:"Date d'expiration non valide",invalid_cvc_format:"Format de code CVC non valide. Il doit se composer de 3 ou 4 chiffres, par ex. 765.",invalid_card_number:"Num\xe9ro de carte non valide",save:"Enregistrer {{percentage}}",per_time_interval:"Par",month:"mois",year:"an"}},premium_upgrade_page:{},analytics_dashboard:{}}),I18n.translations.id=I18n.extend(I18n.translations.id||{},{mailers:{},reg_path:{},registration_path:{},affiliation_editor:{},department_search:{create_new:"Atau buat departemen baru..."},uploaded_by:"Diunggah oleh",added_by:"Ditambahkan oleh",aca:{marketing_claim:{text:"Suatu penelitian yang baru-baru ini dipublikasikan di PLOS ONE menunjukkan bahwa makalah yang diunggah ke Academia.edu menerima tambahan 69% kutipan dalam waktu 5 tahun.",html:"Suatu penelitian yang baru-baru ini dipublikasikan di <i>PLOS ONE</i> menunjukkan bahwa makalah yang diunggah ke Academia.edu menerima tambahan 69% kutipan dalam waktu 5 tahun."},marketing_claim_with_link:{html:"Suatu <a class=\u201d%{link_classes}\u201d href=\u201dhttp://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu\u201d>penelitian</a> yang baru-baru ini dipublikasikan di <i>PLOS ONE</i> menunjukkan bahwa makalah yang diunggah ke Academia.edu menerima tambahan 69% kutipan dalam waktu 5 tahun."},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},premium_upgrade_modal:{header:{free_trial:"Cobalah Academia Premium",no_free_trial:"Tingkatkan ke Academia Premium"},premium_feature_list:{readers:"Pembaca",expanded_analytics:"Analitika Diperluas",advanced_search:"Pencarian Lanjut",impact_report:"Laporan Dampak"},free_trial_info_text:"Kartu kredit Anda hanya akan ditagih setelah percobaan gratis 7-hari Anda berakhir.",no_free_trial_info_text:"Dapatkan pengembalian dana kapan pun dalam 30 hari - tanpa pertanyaan.",payment_form:{unexpected_error:"Terjadi galat tidak diharapkan. Silakan hubungi premium-support@academia.edu.",card_number_placeholder:"Nomor Kartu",security_code:"Kode Keamanan (CVV/CVC)",exp_date_placeholder:"Tanggal Kedaluwarsa (BB/TT)",upgrade:"Tingkatkan",start_free_trial:"Awali Percobaan Gratis 7-Hari",invalid_expiration_date:"Tanggal Kedaluwarsa Tidak Valid",invalid_cvc_format:"Format CVC tidak valid - seharusnya 3 atau 4 angka, misalnya, 765",invalid_card_number:"Nomor kartu tidak valid",save:"Hemat {{percentage}}",per_time_interval:"Per",month:"bulan",year:"tahun"}},multi_upload:{drag_and_drop:"Seret dan letakkan beberapa berkas, atau...",drop_anywhere:"Letakkan berkas di mana pun untuk mengunggah",choose_files:"Pilih Berkas","continue":"Lanjutkan",paper_title:"Judul Makalah","abstract":"Abstrak",authors:"Penulis",title_not_found:"Judul Makalah Tidak Ditemukan",research_interests:"Minat Penelitian",section:"Bagian",validation_error:{too_big:"Berkas ini lebih besar dari 100MB",bad_type:"Jenis berkas ini tidak didukung",too_long:"Nama berkas ini terlalu panjang","":{other:"Terjadi kesalahan"}},add_paper_details:"Tambahkan Informasi Makalah",paper_n_of_m:"Makalah %{current_paper} dari %{paper_count}"},premium_upgrade_page:{},analytics_dashboard:{}}),I18n.translations.it=I18n.extend(I18n.translations.it||{},{reg_path:{},affiliation_editor:{},mailers:{},registration_path:{},department_search:{create_new:"O crea un nuovo dipartimento..."},uploaded_by:"Caricato da",added_by:"Aggiunto da",aca:{marketing_claim:{text:"Secondo uno studio recentemente pubblicato su PLOS ONE, i documenti caricati su Academia.edu ricevono il 69% in pi\xf9 di citazioni in un periodo di 5 anni.",html:"Secondo uno studio recentemente pubblicato su <i>PLOS ONE</i>, i documenti caricati su Academia.edu ricevono il 69% in pi\xf9 di citazioni in un periodo di 5 anni."},marketing_claim_with_link:{html:'Secondo uno <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">studio</a> recentemente pubblicato su <i>PLOS ONE,</i> i documenti caricati su Academia.edu ricevono il 69% in pi\xf9 di citazioni in un periodo di 5 anni.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},multi_upload:{drag_and_drop:"Trascina e rilascia pi\xf9 file o...",drop_anywhere:"Rilascia file ovunque per caricarli",choose_files:"Scegli file","continue":"Continua",paper_title:"Titolo del documento","abstract":"Sommario",authors:"Autori",title_not_found:"Titolo del documento non trovato",research_interests:"Interessi di ricerca",section:"Sezione",validation_error:{too_big:"Questo file eccede 100MB",bad_type:"Questo tipo di file non \xe8 supportato",too_long:"Il nome del file \xe8 troppo lungo","":{one:"Qualcosa \xe8 andato storto",other:"Qualcosa \xe8 andato storto"},other:"Qualcosa \xe8 andato storto"},add_paper_details:"Aggiungi dettagli del documento",paper_n_of_m:"Documento %{current_paper} di %{paper_count}"},premium_upgrade_modal:{header:{free_trial:"Prova Academia Premium",no_free_trial:"Aggiorna ad Academia Premium"},premium_feature_list:{readers:"Lettori",expanded_analytics:"Analisi dettagliata",advanced_search:"Ricerca avanzata",impact_report:"Report dell'impatto"},free_trial_info_text:"Riceverai l'addebito sulla carta di credito solo alla fine del periodo di prova di 7 giorni.",no_free_trial_info_text:"Puoi ottenere un rimborso entro 30 giorni senza dover dare alcuna spiegazione.",payment_form:{unexpected_error:"Si \xe8 verificato un errore inaspettato. Ti preghiamo di contattare premium-support@academia.edu.",card_number_placeholder:"Numero della carta",security_code:"Codice di sicurezza (CVV/CVC)",exp_date_placeholder:"Data di scadenza (MM/YY)",upgrade:"Aggiorna",start_free_trial:"Inizia il tuo periodo di prova di 7 giorni",invalid_expiration_date:"Data di scadenza non valida",invalid_cvc_format:"Formato CVC non valido - 3 o 4 numeri, es. 765",invalid_card_number:"Numero di carta non valido",save:"Risparmio del {{percentage}}",per_time_interval:"Al",month:"mese",year:"anno"}},premium_upgrade_page:{},analytics_dashboard:{}}),I18n.translations.pt=I18n.extend(I18n.translations.pt||{},{reg_path:{},affiliation_editor:{},mailers:{},registration_path:{},department_search:{create_new:"Ou crie um novo departamento..."},uploaded_by:"Carregado por",added_by:"Adicionado por",aca:{marketing_claim:{text:"Um estudo publicado recentemente na PLOS ONE constatou que os artigos carregados no site Academia apresentam um aumento de 69% nas cita\xe7\xf5es ao longo de 5 anos.",html:"Um estudo publicado recentemente na <i>PLOS ONE</i> constatou que os artigos carregados no site Academia.edu apresentam um aumento de 69% em cita\xe7\xf5es ao longo de 5 anos."},marketing_claim_with_link:{html:'cita\xe7\xf5es ao longo de 5 anos.\nUm <a class="%{link_classes}" href="http://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu">estudo</a> publicado recentemente na <i>PLOS ONE</i> constatou que os artigos carregados no site Academia.edu apresentam um aumento de 69% em cita\xe7\xf5es ao longo de 5 anos.'},work_url:"https://www.academia.edu/12297791/Open_Access_Meets_Discoverability_Citations_to_Articles_Posted_to_Academia.edu"},multi_upload:{drag_and_drop:"Arraste e solte v\xe1rios arquivos, ou...",drop_anywhere:"Solte os arquivos em qualquer lugar para carregar",choose_files:"Escolher arquivos","continue":"Continuar",paper_title:"T\xedtulo do artigo","abstract":"Resumo",authors:"Autores",title_not_found:"T\xedtulo do artigo n\xe3o encontrado",research_interests:"Interesses de pesquisa",section:"Se\xe7\xe3o",validation_error:{too_big:"Este arquivo \xe9 maior que 100MB",bad_type:"N\xe3o h\xe1 suporte para este tipo de arquivo",too_long:"Este nome de arquivo \xe9 muito grande",other:"Ocorreram alguns erros","":{one:"Ocorreu um erro",other:"Ocorreram alguns erros"}},add_paper_details:"Adicionar detalhes do artigo",paper_n_of_m:"Artigo %{current_paper} de %{paper_count}"},premium_upgrade_modal:{header:{free_trial:"Experimente Academia Premium",no_free_trial:"Fa\xe7a upgrade para Academia Premium"},premium_feature_list:{readers:"Leitores",expanded_analytics:"An\xe1lise expandida",advanced_search:"Pesquisa avan\xe7ada",impact_report:"Relat\xf3rio de impactos"},free_trial_info_text:"S\xf3 haver\xe1 cobran\xe7a em seu cart\xe3o de cr\xe9dito ap\xf3s o final dos 7 dias do per\xedodo da avalia\xe7\xe3o gratuita.",no_free_trial_info_text:"Receba seu dinheiro de volta a qualquer momento em at\xe9 30 dias - sem perguntas.",payment_form:{unexpected_error:"Ocorreu um erro inesperado. Por favor, entre em contato com premium-support@academia.edu",card_number_placeholder:"N\xfamero do cart\xe3o",security_code:"C\xf3digo de seguran\xe7a (CVV/CVC)",exp_date_placeholder:"Data de validade (MM/AA)",upgrade:"Fazer upgrade",start_free_trial:"Iniciar avalia\xe7\xe3o gratuita por 7 dias",invalid_expiration_date:"Data de validade inv\xe1lida",invalid_cvc_format:"Formato do CVC inv\xe1lido - devem ser 3 ou 4 d\xedgitos (ex. 765)",invalid_card_number:"N\xfamero de cart\xe3o inv\xe1lido",save:"Economize {{percentage}}",per_time_interval:"Por",month:"m\xeas",year:"ano"}},premium_upgrade_page:{},analytics_dashboard:{}}),function(){"use strict";var e=function(e){var t=this;t.mainContainer=null,t.selector=null,t.settings=$.extend({elements:"[data-scroll-scope]",forcedElements:'[data-scroll-scope="force"]',events:"DOMMouseScroll mousewheel scroll touchstart touchmove"},e&&(e.elements||e.forcedElements||e.events)?e:{}),t.getTargetedElements=function(){return t.mainContainer.find(t.selector)},t.getSelector=function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&e[n].length&&t.push(e[n]);return t.length?t.join(", "):null},t.normalizeJqueryObject=function(e){return e?e instanceof jQuery?e:$(e):null},t.killScrolling=function(e,t){return t||"touchmove"!==e.type&&"touchstart"!==e.type?(e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1):void 0},t.onScroll=function(e){if(e.isLegitScroll)return!0;var n=$(this),i=t.settings.forcedElements&&n.is(t.settings.forcedElements),r=this.scrollHeight,o=n.outerHeight(),a=r-o-this.scrollTop;if(o>=r)return i&&"touchstart"!==e.type?t.killScrolling(e,i):!0;var s=e.originalEvent.wheelDelta;i&&"undefined"==typeof s&&"touchstart"===e.type&&(this.scrollTop<=0?n.scrollTop(1):0>=a&&n.scrollTop(r-o-1));var l=s>0;return!l&&-s>a?(n.scrollTop(this.scrollHeight),t.killScrolling(e,i)):l&&s>this.scrollTop?(n.scrollTop(0),t.killScrolling(e,i)):(e.isLegitScroll=!0,!0)},t.unbind=function(){return t.mainContainer&&t.mainContainer.off(t.settings.events,t.selector,t.onScroll),t},t.bind=function(e){return e=t.normalizeJqueryObject(e),e&&t.unbind(),t.mainContainer=e,t.mainContainer.on(t.settings.events,t.selector,t.onScroll),t},t.settings.elements=t.getSelector([t.settings.elements]),t.settings.forcedElements=t.getSelector([t.settings.forcedElements]),t.selector=t.getSelector([t.settings.elements,t.settings.forcedElements])};"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:(window.ScrollScope=e,jQuery&&!function(t){t.fn.scrollScope=function(t){var n=new e(t);return n.bind(this),n.mainContainer}}(jQuery))}();